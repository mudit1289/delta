Listening for transport dt_socket at address: 38835
23/11/30 18:40:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:40:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:40:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:40:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:40:53 INFO SignalUtils: Registering signal handler for INT
23/11/30 18:40:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:40:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:40:57 INFO HiveConf: Found configuration file file:/var/lib/fk-pf-spark3/conf/hive-site.xml
23/11/30 18:40:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:40:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:40:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:40:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:40:57 INFO SparkContext: Running Spark version 3.1.2
23/11/30 18:40:57 INFO ResourceUtils: ==============================================================
23/11/30 18:40:57 INFO ResourceUtils: No custom resources configured for spark.driver.
23/11/30 18:40:57 INFO ResourceUtils: ==============================================================
23/11/30 18:40:57 INFO SparkContext: Submitted application: Spark shell
23/11/30 18:40:57 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(memoryOverhead -> name: memoryOverhead, amount: 4096, script: , vendor: , cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 10240, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/11/30 18:40:57 INFO ResourceProfile: Limiting resource is cpus at 1 tasks per executor
23/11/30 18:40:57 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/11/30 18:40:57 INFO SecurityManager: Changing view acls to: vanshika.yadav
23/11/30 18:40:57 INFO SecurityManager: Changing modify acls to: vanshika.yadav
23/11/30 18:40:57 INFO SecurityManager: Changing view acls groups to: 
23/11/30 18:40:57 INFO SecurityManager: Changing modify acls groups to: 
23/11/30 18:40:57 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(vanshika.yadav); groups with view permissions: Set(); users  with modify permissions: Set(vanshika.yadav); groups with modify permissions: Set()
23/11/30 18:40:58 INFO Utils: Successfully started service 'sparkDriver' on port 44775.
23/11/30 18:40:58 INFO SparkEnv: Registering MapOutputTracker
23/11/30 18:40:58 INFO SparkEnv: Registering BlockManagerMaster
23/11/30 18:40:58 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/11/30 18:40:58 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/11/30 18:40:58 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/11/30 18:40:58 INFO DiskBlockManager: Created local directory at /grid/1/spark3/tmp/blockmgr-797cbbe7-0685-4585-a51e-e6859d92a233
23/11/30 18:40:58 INFO MemoryStore: MemoryStore started with capacity 2.5 GiB
23/11/30 18:40:58 INFO SparkEnv: Registering OutputCommitCoordinator
23/11/30 18:40:58 INFO log: Logging initialized @6306ms to org.sparkproject.jetty.util.log.Slf4jLog
23/11/30 18:40:58 INFO Server: jetty-9.4.40.v20210413; built: 2021-04-13T20:42:42.668Z; git: b881a572662e1943a14ae12e7e1207989f218b74; jvm 1.8.0_172-b11
23/11/30 18:40:58 INFO Server: Started @6397ms
23/11/30 18:40:58 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
23/11/30 18:40:58 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
23/11/30 18:40:58 WARN Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
23/11/30 18:40:58 WARN Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
23/11/30 18:40:58 WARN Utils: Service 'SparkUI' could not bind on port 4044. Attempting port 4045.
23/11/30 18:40:58 WARN Utils: Service 'SparkUI' could not bind on port 4045. Attempting port 4046.
23/11/30 18:40:58 INFO AbstractConnector: Started ServerConnector@3a36da5e{HTTP/1.1, (http/1.1)}{0.0.0.0:4046}
23/11/30 18:40:58 INFO Utils: Successfully started service 'SparkUI' on port 4046.
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@260fffec{/jobs,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@47cf922d{/jobs/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@439d649c{/jobs/job,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@32084a01{/jobs/job/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@2433bcd4{/stages,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@5f1a3c4{/stages/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@63e40188{/stages/stage,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3f919230{/stages/stage/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@21251e43{/stages/pool,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@54c17a2b{/stages/pool/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@1f7949dc{/storage,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3497ecea{/storage/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@4b2af0eb{/storage/rdd,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@6d387e9b{/storage/rdd/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@2c7607e5{/environment,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@7dd847a2{/environment/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@69e736bf{/executors,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@543a7605{/executors/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@639bf405{/executors/threadDump,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@9d7a853{/executors/threadDump/json,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@4dc16fc9{/static,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@267e0ca0{/,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3f3a529f{/api,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@1002f859{/jobs/job/kill,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@34525143{/stages/stage/kill,null,AVAILABLE,@Spark}
23/11/30 18:40:58 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:4046
23/11/30 18:40:58 INFO Utils: Using initial executors = 0, max of spark.dynamicAllocation.initialExecutors, spark.dynamicAllocation.minExecutors and spark.executor.instances
23/11/30 18:40:58 INFO AHSProxy: Connecting to Application History server at fks-fdp-galaxy-pluto-hs-0001-m.c.fks-fdp-galaxy.internal/10.116.4.108:10200
23/11/30 18:40:58 INFO ConfiguredRMFailoverProxyProvider: Failing over to rm2
23/11/30 18:40:58 INFO Client: Requesting a new application from cluster with 30 NodeManagers
23/11/30 18:40:59 INFO Configuration: resource-types.xml not found
23/11/30 18:40:59 INFO ResourceUtils: Unable to find 'resource-types.xml'.
23/11/30 18:40:59 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (163840 MB per container)
23/11/30 18:40:59 INFO Client: Will allocate AM container, with 896 MB memory including 384 MB overhead
23/11/30 18:40:59 INFO Client: Setting up container launch context for our AM
23/11/30 18:40:59 INFO Client: Setting up the launch environment for our AM container
23/11/30 18:40:59 INFO Client: Preparing resources for our AM container
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/HikariCP-2.5.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/HikariCP-2.5.1.jar
23/11/30 18:41:00 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/JLargeArrays-1.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/JLargeArrays-1.5.jar
23/11/30 18:41:00 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/JTransforms-3.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/JTransforms-3.1.jar
23/11/30 18:41:00 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/RoaringBitmap-0.9.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/RoaringBitmap-0.9.0.jar
23/11/30 18:41:00 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/ST4-4.0.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/ST4-4.0.4.jar
23/11/30 18:41:00 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/accessors-smart-1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/accessors-smart-1.2.jar
23/11/30 18:41:00 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:00 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/activation-1.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/activation-1.1.1.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/aircompressor-0.10.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/aircompressor-0.10.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/algebra_2.12-2.0.0-M2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/algebra_2.12-2.0.0-M2.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/antlr-runtime-3.5.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/antlr-runtime-3.5.2.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/antlr4-runtime-4.8-1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/antlr4-runtime-4.8-1.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/aopalliance-1.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/aopalliance-1.0.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/aopalliance-repackaged-2.6.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/aopalliance-repackaged-2.6.1.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/arpack_combined_all-0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/arpack_combined_all-0.1.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/arrow-format-2.0.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/arrow-format-2.0.0.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/arrow-memory-core-2.0.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/arrow-memory-core-2.0.0.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/arrow-memory-netty-2.0.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/arrow-memory-netty-2.0.0.jar
23/11/30 18:41:01 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:01 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/arrow-vector-2.0.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/arrow-vector-2.0.0.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/audience-annotations-0.5.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/audience-annotations-0.5.0.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/avro-1.8.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/avro-1.8.2.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/avro-ipc-1.8.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/avro-ipc-1.8.2.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/avro-mapred-1.8.2-hadoop2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/avro-mapred-1.8.2-hadoop2.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/bcpkix-jdk15on-1.60.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/bcpkix-jdk15on-1.60.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/bcprov-jdk15on-1.60.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/bcprov-jdk15on-1.60.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:02 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/bigquery-connector-hadoop3-latest.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/bigquery-connector-hadoop3-latest.jar
23/11/30 18:41:02 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/bonecp-0.8.0.RELEASE.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/bonecp-0.8.0.RELEASE.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/breeze-macros_2.12-1.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/breeze-macros_2.12-1.0.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/breeze_2.12-1.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/breeze_2.12-1.0.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/cats-kernel_2.12-2.0.0-M4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/cats-kernel_2.12-2.0.0-M4.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/chill-java-0.9.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/chill-java-0.9.5.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/chill_2.12-0.9.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/chill_2.12-0.9.5.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-beanutils-1.9.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-beanutils-1.9.4.jar
23/11/30 18:41:03 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:03 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-cli-1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-cli-1.2.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-codec-1.10.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-codec-1.10.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-collections-3.2.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-collections-3.2.2.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-compiler-3.0.16.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-compiler-3.0.16.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-compress-1.20.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-compress-1.20.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-configuration2-2.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-configuration2-2.1.1.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-crypto-1.1.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-crypto-1.1.0.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-daemon-1.0.13.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-daemon-1.0.13.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-dbcp-1.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-dbcp-1.4.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-httpclient-3.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-httpclient-3.1.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-io-2.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-io-2.5.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-lang-2.6.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-lang-2.6.jar
23/11/30 18:41:04 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:04 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-lang3-3.10.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-lang3-3.10.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-logging-1.1.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-logging-1.1.3.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-math3-3.4.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-math3-3.4.1.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-net-3.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-net-3.1.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-pool-1.5.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-pool-1.5.4.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/commons-text-1.6.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/commons-text-1.6.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/compress-lzf-1.0.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/compress-lzf-1.0.3.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/core-1.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/core-1.1.2.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/curator-client-2.13.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/curator-client-2.13.0.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/curator-framework-2.13.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/curator-framework-2.13.0.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/curator-recipes-2.13.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/curator-recipes-2.13.0.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:05 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/datanucleus-api-jdo-4.2.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/datanucleus-api-jdo-4.2.4.jar
23/11/30 18:41:05 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/datanucleus-core-4.1.17.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/datanucleus-core-4.1.17.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/datanucleus-rdbms-4.1.19.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/datanucleus-rdbms-4.1.19.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/derby-10.12.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/derby-10.12.1.1.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/dnsjava-2.1.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/dnsjava-2.1.7.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/ehcache-3.3.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/ehcache-3.3.1.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/fdp-deps-3.1.2.fdp.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/fdp-deps-3.1.2.fdp.1.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/flatbuffers-java-1.9.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/flatbuffers-java-1.9.0.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:06 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/gcs-connector-hadoop3-2.2.7-shaded.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/gcs-connector-hadoop3-2.2.7-shaded.jar
23/11/30 18:41:06 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/geronimo-jcache_1.0_spec-1.0-alpha-1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/geronimo-jcache_1.0_spec-1.0-alpha-1.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/gson-2.2.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/gson-2.2.4.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/guava-27.0-jre.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/guava-27.0-jre.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/guice-4.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/guice-4.0.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/guice-servlet-4.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/guice-servlet-4.0.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-annotations-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-annotations-3.2.1.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-auth-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-auth-3.2.1.jar
23/11/30 18:41:07 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:07 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-client-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-client-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-common-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-common-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-hdfs-client-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-hdfs-client-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-mapreduce-client-common-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-mapreduce-client-common-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-mapreduce-client-core-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-mapreduce-client-core-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-mapreduce-client-jobclient-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-mapreduce-client-jobclient-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-yarn-api-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-yarn-api-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-yarn-client-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-yarn-client-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-yarn-common-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-yarn-common-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:08 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-yarn-registry-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-yarn-registry-3.2.1.jar
23/11/30 18:41:08 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:09 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-yarn-server-common-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-yarn-server-common-3.2.1.jar
23/11/30 18:41:09 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:09 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hadoop-yarn-server-web-proxy-3.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-yarn-server-web-proxy-3.2.1.jar
23/11/30 18:41:09 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:09 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-beeline-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-beeline-2.3.7.jar
23/11/30 18:41:09 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:09 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-bigquery-connector-2.0.0-SNAPSHOT-with-dependencies.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-bigquery-connector-2.0.0-SNAPSHOT-with-dependencies.jar
23/11/30 18:41:09 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:10 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-cli-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-cli-2.3.7.jar
23/11/30 18:41:10 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:10 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-common-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-common-2.3.7.jar
23/11/30 18:41:10 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:10 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-exec-2.3.7-core.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-exec-2.3.7-core.jar
23/11/30 18:41:10 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:10 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-jdbc-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-jdbc-2.3.7.jar
23/11/30 18:41:10 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:10 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-llap-common-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-llap-common-2.3.7.jar
23/11/30 18:41:10 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:10 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-metastore-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-metastore-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-serde-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-serde-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-service-rpc-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-service-rpc-3.1.2.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-shims-0.23-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-shims-0.23-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-shims-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-shims-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-shims-common-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-shims-common-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-shims-scheduler-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-shims-scheduler-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-storage-api-2.7.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-storage-api-2.7.2.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hive-vector-code-gen-2.3.7.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hive-vector-code-gen-2.3.7.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hk2-api-2.6.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hk2-api-2.6.1.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hk2-locator-2.6.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hk2-locator-2.6.1.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:11 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/hk2-utils-2.6.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hk2-utils-2.6.1.jar
23/11/30 18:41:11 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/htrace-core4-4.1.0-incubating.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/htrace-core4-4.1.0-incubating.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/httpclient-4.4.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/httpclient-4.4.1.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/httpcore-4.4.12.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/httpcore-4.4.12.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/istack-commons-runtime-3.0.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/istack-commons-runtime-3.0.8.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/ivy-2.4.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/ivy-2.4.0.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-annotations-2.10.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-annotations-2.10.0.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-core-2.10.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-core-2.10.0.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-core-asl-1.9.13.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-core-asl-1.9.13.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-databind-2.10.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-databind-2.10.0.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-jaxrs-base-2.9.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-jaxrs-base-2.9.8.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-jaxrs-json-provider-2.9.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-jaxrs-json-provider-2.9.8.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-mapper-asl-1.9.13.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-mapper-asl-1.9.13.jar
23/11/30 18:41:12 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:12 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-module-jaxb-annotations-2.10.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-module-jaxb-annotations-2.10.0.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-module-paranamer-2.10.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-module-paranamer-2.10.0.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jackson-module-scala_2.12-2.10.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jackson-module-scala_2.12-2.10.0.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.activation-api-1.2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.activation-api-1.2.1.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.annotation-api-1.3.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.annotation-api-1.3.5.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.inject-2.6.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.inject-2.6.1.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.servlet-api-4.0.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.servlet-api-4.0.3.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.validation-api-2.0.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.validation-api-2.0.2.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.ws.rs-api-2.1.6.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.ws.rs-api-2.1.6.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jakarta.xml.bind-api-2.3.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jakarta.xml.bind-api-2.3.2.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/janino-3.0.16.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/janino-3.0.16.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/javassist-3.25.0-GA.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/javassist-3.25.0-GA.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/javax.inject-1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/javax.inject-1.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/javax.jdo-3.2.0-m3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/javax.jdo-3.2.0-m3.jar
23/11/30 18:41:13 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:13 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/javolution-5.5.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/javolution-5.5.1.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jaxb-api-2.2.11.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jaxb-api-2.2.11.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jaxb-runtime-2.3.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jaxb-runtime-2.3.2.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jcip-annotations-1.0-1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jcip-annotations-1.0-1.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jcl-over-slf4j-1.7.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jcl-over-slf4j-1.7.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jdo-api-3.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jdo-api-3.0.1.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-client-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-client-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-common-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-common-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-container-servlet-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-container-servlet-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-container-servlet-core-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-container-servlet-core-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-hk2-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-hk2-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-media-jaxb-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-media-jaxb-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jersey-server-2.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jersey-server-2.30.jar
23/11/30 18:41:14 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:14 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jline-2.14.6.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jline-2.14.6.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/joda-time-2.10.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/joda-time-2.10.5.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jodd-core-3.5.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jodd-core-3.5.2.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jpam-1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jpam-1.1.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/json-1.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json-1.8.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/json-smart-2.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json-smart-2.3.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/json4s-ast_2.12-3.7.0-M5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json4s-ast_2.12-3.7.0-M5.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/json4s-core_2.12-3.7.0-M5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json4s-core_2.12-3.7.0-M5.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/json4s-jackson_2.12-3.7.0-M5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json4s-jackson_2.12-3.7.0-M5.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/json4s-scalap_2.12-3.7.0-M5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json4s-scalap_2.12-3.7.0-M5.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jsp-api-2.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jsp-api-2.1.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jsr305-3.0.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jsr305-3.0.0.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jta-1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jta-1.1.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/jul-to-slf4j-1.7.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/jul-to-slf4j-1.7.30.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-admin-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-admin-1.0.1.jar
23/11/30 18:41:15 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:15 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-client-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-client-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-common-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-common-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-core-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-core-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-crypto-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-crypto-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-identity-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-identity-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-server-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-server-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-simplekdc-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-simplekdc-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerb-util-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerb-util-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerby-asn1-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerby-asn1-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerby-config-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerby-config-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerby-pkix-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerby-pkix-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerby-util-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerby-util-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kerby-xdr-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kerby-xdr-1.0.1.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/kryo-shaded-4.0.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/kryo-shaded-4.0.2.jar
23/11/30 18:41:16 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:16 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/leveldbjni-all-1.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/leveldbjni-all-1.8.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/libfb303-0.9.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/libfb303-0.9.3.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/libthrift-0.12.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/libthrift-0.12.0.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/log4j-1.2.17.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/log4j-1.2.17.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/lz4-java-1.7.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/lz4-java-1.7.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/machinist_2.12-0.6.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/machinist_2.12-0.6.8.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/macro-compat_2.12-1.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/macro-compat_2.12-1.1.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/metrics-core-4.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/metrics-core-4.1.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/metrics-graphite-4.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/metrics-graphite-4.1.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/metrics-jmx-4.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/metrics-jmx-4.1.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/metrics-json-4.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/metrics-json-4.1.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/metrics-jvm-4.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/metrics-jvm-4.1.1.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/minlog-1.3.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/minlog-1.3.0.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/netty-all-4.1.51.Final.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/netty-all-4.1.51.Final.jar
23/11/30 18:41:17 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:17 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/nimbus-jose-jwt-4.41.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/nimbus-jose-jwt-4.41.1.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/objenesis-2.6.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/objenesis-2.6.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/okhttp-2.7.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/okhttp-2.7.5.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/okio-1.14.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/okio-1.14.0.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/opencsv-2.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/opencsv-2.3.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/orc-core-1.5.12.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/orc-core-1.5.12.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/orc-mapreduce-1.5.12.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/orc-mapreduce-1.5.12.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/orc-shims-1.5.12.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/orc-shims-1.5.12.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/oro-2.0.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/oro-2.0.8.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/osgi-resource-locator-1.0.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/osgi-resource-locator-1.0.3.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/paranamer-2.8.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/paranamer-2.8.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/parquet-column-1.10.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/parquet-column-1.10.1.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/parquet-common-1.10.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/parquet-common-1.10.1.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/parquet-encoding-1.10.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/parquet-encoding-1.10.1.jar
23/11/30 18:41:18 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:18 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/parquet-format-2.4.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/parquet-format-2.4.0.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/parquet-hadoop-1.10.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/parquet-hadoop-1.10.1.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/parquet-jackson-1.10.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/parquet-jackson-1.10.1.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/protobuf-java-2.5.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/protobuf-java-2.5.0.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/py4j-0.10.9.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/py4j-0.10.9.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/pyrolite-4.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/pyrolite-4.30.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/re2j-1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/re2j-1.1.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/scala-collection-compat_2.12-2.1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/scala-collection-compat_2.12-2.1.1.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/scala-compiler-2.12.10.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/scala-compiler-2.12.10.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/scala-library-2.12.10.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/scala-library-2.12.10.jar
23/11/30 18:41:19 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:19 WARN DataStreamer: Caught exception
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Thread.join(Thread.java:1252)
	at java.lang.Thread.join(Thread.java:1326)
	at org.apache.hadoop.hdfs.DataStreamer.closeResponder(DataStreamer.java:986)
	at org.apache.hadoop.hdfs.DataStreamer.endBlock(DataStreamer.java:640)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:810)
23/11/30 18:41:19 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/scala-parser-combinators_2.12-1.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/scala-parser-combinators_2.12-1.1.2.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/scala-reflect-2.12.10.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/scala-reflect-2.12.10.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/scala-xml_2.12-1.2.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/scala-xml_2.12-1.2.0.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/shapeless_2.12-2.3.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/shapeless_2.12-2.3.3.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/shims-0.9.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/shims-0.9.0.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/slf4j-api-1.7.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/slf4j-api-1.7.30.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/slf4j-log4j12-1.7.30.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/slf4j-log4j12-1.7.30.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/snappy-java-1.1.8.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/snappy-java-1.1.8.2.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-catalyst_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-catalyst_2.12-3.1.2.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:20 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-core_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-core_2.12-3.1.2.jar
23/11/30 18:41:20 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-graphx_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-graphx_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-hive-thriftserver_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-hive-thriftserver_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-hive_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-hive_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-kvstore_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-kvstore_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-launcher_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-launcher_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-mllib-local_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-mllib-local_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-mllib_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-mllib_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-network-common_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-network-common_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-network-shuffle_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-network-shuffle_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-repl_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-repl_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:21 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-sketch_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-sketch_2.12-3.1.2.jar
23/11/30 18:41:21 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-sql_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-sql_2.12-3.1.2.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-streaming_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-streaming_2.12-3.1.2.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-tags_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-tags_2.12-3.1.2.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-unsafe_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-unsafe_2.12-3.1.2.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spark-yarn_2.12-3.1.2.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spark-yarn_2.12-3.1.2.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spire-macros_2.12-0.17.0-M1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spire-macros_2.12-0.17.0-M1.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spire-platform_2.12-0.17.0-M1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spire-platform_2.12-0.17.0-M1.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spire-util_2.12-0.17.0-M1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spire-util_2.12-0.17.0-M1.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/spire_2.12-0.17.0-M1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/spire_2.12-0.17.0-M1.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/stax-api-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/stax-api-1.0.1.jar
23/11/30 18:41:22 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:22 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/stax2-api-3.1.4.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/stax2-api-3.1.4.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/stream-2.9.6.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/stream-2.9.6.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/super-csv-2.2.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/super-csv-2.2.0.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/threeten-extra-1.5.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/threeten-extra-1.5.0.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/token-provider-1.0.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/token-provider-1.0.1.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/transaction-api-1.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/transaction-api-1.1.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/univocity-parsers-2.9.1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/univocity-parsers-2.9.1.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/velocity-1.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/velocity-1.5.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/woodstox-core-5.0.3.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/woodstox-core-5.0.3.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/xbean-asm7-shaded-4.15.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/xbean-asm7-shaded-4.15.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/xz-1.5.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/xz-1.5.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/zookeeper-3.4.14.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/zookeeper-3.4.14.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:23 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/zstd-jni-1.4.8-1.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/zstd-jni-1.4.8-1.jar
23/11/30 18:41:23 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-lzo-0.6.0.2.4.0.0-169.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource file:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/hadoop-4mc-1.1.0.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource file:/home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource file:/var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/iceberg-hive-runtime-1.2.0.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 WARN DataStreamer: Caught exception
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Thread.join(Thread.java:1252)
	at java.lang.Thread.join(Thread.java:1326)
	at org.apache.hadoop.hdfs.DataStreamer.closeResponder(DataStreamer.java:986)
	at org.apache.hadoop.hdfs.DataStreamer.endBlock(DataStreamer.java:640)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:810)
23/11/30 18:41:24 INFO Client: Uploading resource file:/var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/iceberg-spark-runtime-3.1_2.12-1.2.0.jar
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO Client: Uploading resource file:/grid/1/spark3/tmp/spark-54770f5f-78fc-47ed-a01f-1122505d941d/__spark_conf__6744782199119495436.zip -> hdfs://pluto/user/vanshika.yadav/.sparkStaging/application_1699449121496_0386/__spark_conf__.zip
23/11/30 18:41:24 INFO SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
23/11/30 18:41:24 INFO SecurityManager: Changing view acls to: vanshika.yadav
23/11/30 18:41:24 INFO SecurityManager: Changing modify acls to: vanshika.yadav
23/11/30 18:41:24 INFO SecurityManager: Changing view acls groups to: 
23/11/30 18:41:24 INFO SecurityManager: Changing modify acls groups to: 
23/11/30 18:41:24 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(vanshika.yadav); groups with view permissions: Set(); users  with modify permissions: Set(vanshika.yadav); groups with modify permissions: Set()
23/11/30 18:41:24 INFO Client: Submitting application application_1699449121496_0386 to ResourceManager
23/11/30 18:41:25 INFO YarnClientImpl: Submitted application application_1699449121496_0386
23/11/30 18:41:26 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:26 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: de_adhoc
	 start time: 1701349884952
	 final status: UNDEFINED
	 tracking URL: http://fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386/
	 user: vanshika.yadav
23/11/30 18:41:27 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:28 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:29 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:30 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:31 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:32 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:33 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:34 INFO Client: Application report for application_1699449121496_0386 (state: ACCEPTED)
23/11/30 18:41:34 INFO YarnClientSchedulerBackend: Add WebUI Filter. org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter, Map(PROXY_HOSTS -> fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal, PROXY_URI_BASES -> http://fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386,http://fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386, RM_HA_URLS -> fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088), /proxy/application_1699449121496_0386
23/11/30 18:41:35 INFO Client: Application report for application_1699449121496_0386 (state: RUNNING)
23/11/30 18:41:35 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: 10.116.12.138
	 ApplicationMaster RPC port: -1
	 queue: de_adhoc
	 start time: 1701349884952
	 final status: UNDEFINED
	 tracking URL: http://fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386/
	 user: vanshika.yadav
23/11/30 18:41:35 INFO YarnClientSchedulerBackend: Application application_1699449121496_0386 has started running.
23/11/30 18:41:35 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 39859.
23/11/30 18:41:35 INFO NettyBlockTransferService: Server created on fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:39859
23/11/30 18:41:35 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/11/30 18:41:35 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal, 39859, None)
23/11/30 18:41:35 INFO BlockManagerMasterEndpoint: Registering block manager fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:39859 with 2.5 GiB RAM, BlockManagerId(driver, fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal, 39859, None)
23/11/30 18:41:35 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal, 39859, None)
23/11/30 18:41:35 INFO BlockManager: external shuffle service port = 7337
23/11/30 18:41:35 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal, 39859, None)
23/11/30 18:41:35 INFO YarnSchedulerBackend$YarnSchedulerEndpoint: ApplicationMaster registered as NettyRpcEndpointRef(spark-client://YarnAM)
23/11/30 18:41:35 INFO ServerInfo: Adding filter to /metrics/json: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
23/11/30 18:41:35 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@71ea9a0d{/metrics/json,null,AVAILABLE,@Spark}
23/11/30 18:41:35 INFO GoogleCloudStorageImpl: Ignoring exception of type GoogleJsonResponseException; verified object already exists with desired state.
23/11/30 18:41:35 INFO SingleEventLogFileWriter: Logging events to gs://fks-fdp-infra-job-history/pluto/spark-job-history/application_1699449121496_0386.inprogress
23/11/30 18:41:35 INFO Utils: Using initial executors = 0, max of spark.dynamicAllocation.initialExecutors, spark.dynamicAllocation.minExecutors and spark.executor.instances
23/11/30 18:41:35 INFO YarnClientSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
23/11/30 18:41:35 INFO Main: Created Spark session with Hive support
Spark context Web UI available at http://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:4046
Spark context available as 'sc' (master = yarn, app id = application_1699449121496_0386).
Spark session available as 'spark'.
20231130-184001-tpcds-1gb-iceberg_shell_init.scala:23: warning: This catches all Throwables. If this is really intended, use `case t : Throwable` to clear this warning.
try { benchmark.TPCDSBenchmark.main(Array[String]("--format", "ICEBERG", "--scale-in-gb", "1", "--benchmark-path", "gs://fksdp-mhora-zrwe-0f09-discoverycontentimpression/benchmarking/iceberg-benchmarking")) } catch { case t => println(t); println("FAILED"); System.exit(1) } ;;
                                                                                                                                                                                                                              ^
2023-11-30T18:41:37.920 ================================================================================
2023-11-30T18:41:37.920 ================================================================================
23/11/30 18:41:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:41:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:41:37 INFO SharedState: spark.sql.warehouse.dir is not set, but hive.metastore.warehouse.dir is set. Setting spark.sql.warehouse.dir to the value of hive.metastore.warehouse.dir ('gs://stage-hive-metastore-pluto/apps/hive/warehouse').
23/11/30 18:41:37 INFO SharedState: Warehouse path is 'gs://stage-hive-metastore-pluto/apps/hive/warehouse'.
23/11/30 18:41:37 INFO ServerInfo: Adding filter to /SQL: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
23/11/30 18:41:37 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@5de898de{/SQL,null,AVAILABLE,@Spark}
23/11/30 18:41:37 INFO ServerInfo: Adding filter to /SQL/json: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
23/11/30 18:41:37 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@4c18545{/SQL/json,null,AVAILABLE,@Spark}
23/11/30 18:41:37 INFO ServerInfo: Adding filter to /SQL/execution: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
23/11/30 18:41:37 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@62f15023{/SQL/execution,null,AVAILABLE,@Spark}
23/11/30 18:41:37 INFO ServerInfo: Adding filter to /SQL/execution/json: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
23/11/30 18:41:37 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@20834041{/SQL/execution/json,null,AVAILABLE,@Spark}
23/11/30 18:41:37 INFO ServerInfo: Adding filter to /static/sql: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
23/11/30 18:41:37 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@b3730d5{/static/sql,null,AVAILABLE,@Spark}
23/11/30 18:41:38 WARN SparkSession$Builder: Using an existing SparkSession; some spark core configurations may not take effect.
2023-11-30T18:41:38.620 Spark started with configuration:
	spark.app.id: application_1699449121496_0386
	spark.app.name: Spark shell
	spark.app.startTime: 1701349857803
	spark.benchmarkId: 20231130-184001-tpcds-1gb-iceberg
	spark.cleaner.ttl: 86400
	spark.delta.logStore.gs.impl: io.delta.storage.GCSLogStore
	spark.driver.appUIAddress: http://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:4046
	spark.driver.cores: 1
	spark.driver.extraClassPath: gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar
	spark.driver.extraJavaOptions: -Denv=prod -Dcom.sun.management.jmxremote.port=0 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=0 -XX:MaxDirectMemorySize=800M -XX:MaxMetaspaceSize=256M -XX:CompressedClassSpaceSize=100M -XX:+UnlockDiagnosticVMOptions -Djob.numOfRePartitions=30
	spark.driver.extraLibraryPath: /usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu
	spark.driver.host: fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal
	spark.driver.memory: 5120m
	spark.driver.port: 44775
	spark.dynamicAllocation.enabled: true
	spark.dynamicAllocation.executorIdleTimeout: 60s
	spark.dynamicAllocation.maxExecutors: 200
	spark.eventLog.dir: gs://fks-fdp-infra-job-history/pluto/spark-job-history
	spark.eventLog.enabled: true
	spark.executor.cores: 1
	spark.executor.extraClassPath: gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar
	spark.executor.extraJavaOptions: -XX:MaxDirectMemorySize=8096m -Dio.netty.maxDirectMemory=8096m -XX:+UseG1GC -XX:ConcGCThreads=2
	spark.executor.extraLibraryPath: /usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu
	spark.executor.id: driver
	spark.executor.memory: 10240m
	spark.fdp.orgqueue.cache.expire: 300
	spark.fdp.orgqueue.cache.size: 100
	spark.fdp.orgqueue.defaultQueue: adhoc
	spark.fdp.orgqueue.gringotts.clientId: QAAS
	spark.fdp.orgqueue.gringotts.clientSecret: 423de2b0-cc97-439d-a3f9-673e76d7bbea
	spark.fdp.orgqueue.gringotts.url: http://10.47.6.66/billingOrg/user
	spark.fdp.orgqueue.ironbank.url: http://10.47.4.16:/queue/
	spark.fdp.orgqueue.queueNotFound.errorMessage: Queue mapping not found
	spark.fdp.orgqueue.validInitiators: BADGER,QAAS
	spark.hadoop.yarn.timeline-service.enabled: false
	spark.history.fs.cleaner.interval: 1d
	spark.history.fs.cleaner.maxAge: 60d
	spark.history.fs.logDirectory: gs://fks-fdp-infra-job-history/pluto/spark-job-history
	spark.history.provider: org.apache.spark.deploy.history.FsHistoryProvider
	spark.home: /var/lib/fk-pf-spark3
	spark.jars: 
	spark.master: yarn
	spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS: fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal
	spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES: http://fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386,http://fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386
	spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.RM_HA_URLS: fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088
	spark.queue.enforcer.class: com.flipkart.fdp.orgqueue.OrgQueueEnforcerForInitiator
	spark.repl.class.outputDir: /grid/1/spark3/tmp/spark-54770f5f-78fc-47ed-a01f-1122505d941d/repl-e80e9371-8e44-432e-9c6c-c2bec67290cf
	spark.repl.class.uri: spark://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:44775/classes
	spark.repl.local.jars: file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar
	spark.shuffle.service.enabled: true
	spark.shuffle.useOldFetchProtocol: true
	spark.sql.catalog.hive_pluto: org.apache.iceberg.spark.SparkCatalog
	spark.sql.catalog.hive_pluto.type: hive
	spark.sql.catalog.hive_pluto.uri: thrift://10.116.17.2:9083
	spark.sql.catalogImplementation: hive
	spark.sql.extensions: org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
	spark.sql.sources.partitionOverwriteMode: dynamic
	spark.sql.warehouse.dir: gs://stage-hive-metastore-pluto/apps/hive/warehouse
	spark.streaming.concurrentJobs: 4
	spark.submit.deployMode: client
	spark.submit.pyFiles: 
	spark.ui.filters: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
	spark.ui.proxyBase: 
	spark.ui.showConsoleProgress: true
	spark.yarn.dist.jars: gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar,file:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar
	spark.yarn.driver.memoryOverhead: 4096
	spark.yarn.executor.memoryOverhead: 4096
	spark.yarn.historyServer.address: http://fks-fdp-galaxy-pluto-hs-0001-m.c.fks-fdp-galaxy.internal:18080
	spark.yarn.jars: gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/*
	spark.yarn.queue: de_adhoc
	spark.yarn.report.interval: 60s
	spark.yarn.secondary.jars: hadoop-lzo-0.6.0.2.4.0.0-169.jar,hadoop-4mc-1.1.0.jar,json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,iceberg-hive-runtime-1.2.0.jar,iceberg-spark-runtime-3.1_2.12-1.2.0.jar

2023-11-30T18:41:38.623 All configs:
	(spark.app.id,application_1699449121496_0386)
	(spark.app.name,Spark shell)
	(spark.app.startTime,1701349857803)
	(spark.benchmarkId,20231130-184001-tpcds-1gb-iceberg)
	(spark.cleaner.ttl,86400)
	(spark.delta.logStore.gs.impl,io.delta.storage.GCSLogStore)
	(spark.driver.appUIAddress,http://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:4046)
	(spark.driver.cores,1)
	(spark.driver.extraClassPath,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar)
	(spark.driver.extraJavaOptions,-Denv=prod -Dcom.sun.management.jmxremote.port=0 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=0 -XX:MaxDirectMemorySize=800M -XX:MaxMetaspaceSize=256M -XX:CompressedClassSpaceSize=100M -XX:+UnlockDiagnosticVMOptions -Djob.numOfRePartitions=30)
	(spark.driver.extraLibraryPath,/usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu)
	(spark.driver.host,fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal)
	(spark.driver.memory,5120m)
	(spark.driver.port,44775)
	(spark.dynamicAllocation.enabled,true)
	(spark.dynamicAllocation.executorIdleTimeout,60s)
	(spark.dynamicAllocation.maxExecutors,200)
	(spark.eventLog.dir,gs://fks-fdp-infra-job-history/pluto/spark-job-history)
	(spark.eventLog.enabled,true)
	(spark.executor.cores,1)
	(spark.executor.extraClassPath,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar)
	(spark.executor.extraJavaOptions,-XX:MaxDirectMemorySize=8096m -Dio.netty.maxDirectMemory=8096m -XX:+UseG1GC -XX:ConcGCThreads=2)
	(spark.executor.extraLibraryPath,/usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu)
	(spark.executor.id,driver)
	(spark.executor.memory,10240m)
	(spark.fdp.orgqueue.cache.expire,300)
	(spark.fdp.orgqueue.cache.size,100)
	(spark.fdp.orgqueue.defaultQueue,adhoc)
	(spark.fdp.orgqueue.gringotts.clientId,QAAS)
	(spark.fdp.orgqueue.gringotts.clientSecret,423de2b0-cc97-439d-a3f9-673e76d7bbea)
	(spark.fdp.orgqueue.gringotts.url,http://10.47.6.66/billingOrg/user)
	(spark.fdp.orgqueue.ironbank.url,http://10.47.4.16:/queue/)
	(spark.fdp.orgqueue.queueNotFound.errorMessage,Queue mapping not found)
	(spark.fdp.orgqueue.validInitiators,BADGER,QAAS)
	(spark.hadoop.yarn.timeline-service.enabled,false)
	(spark.history.fs.cleaner.interval,1d)
	(spark.history.fs.cleaner.maxAge,60d)
	(spark.history.fs.logDirectory,gs://fks-fdp-infra-job-history/pluto/spark-job-history)
	(spark.history.provider,org.apache.spark.deploy.history.FsHistoryProvider)
	(spark.home,/var/lib/fk-pf-spark3)
	(spark.jars,)
	(spark.master,yarn)
	(spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS,fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal)
	(spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES,http://fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386,http://fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386)
	(spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.RM_HA_URLS,fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088)
	(spark.queue.enforcer.class,com.flipkart.fdp.orgqueue.OrgQueueEnforcerForInitiator)
	(spark.repl.class.outputDir,/grid/1/spark3/tmp/spark-54770f5f-78fc-47ed-a01f-1122505d941d/repl-e80e9371-8e44-432e-9c6c-c2bec67290cf)
	(spark.repl.class.uri,spark://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:44775/classes)
	(spark.repl.local.jars,file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar)
	(spark.shuffle.service.enabled,true)
	(spark.shuffle.useOldFetchProtocol,true)
	(spark.sql.broadcastTimeout,7200)
	(spark.sql.catalog.hive_pluto,org.apache.iceberg.spark.SparkCatalog)
	(spark.sql.catalog.hive_pluto.type,hive)
	(spark.sql.catalog.hive_pluto.uri,thrift://10.116.17.2:9083)
	(spark.sql.catalogImplementation,hive)
	(spark.sql.crossJoin.enabled,true)
	(spark.sql.extensions,org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions)
	(spark.sql.sources.partitionOverwriteMode,dynamic)
	(spark.sql.warehouse.dir,gs://stage-hive-metastore-pluto/apps/hive/warehouse)
	(spark.streaming.concurrentJobs,4)
	(spark.submit.deployMode,client)
	(spark.submit.pyFiles,)
	(spark.ui.filters,org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter)
	(spark.ui.proxyBase,)
	(spark.ui.showConsoleProgress,true)
	(spark.yarn.dist.jars,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar,file:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar)
	(spark.yarn.driver.memoryOverhead,4096)
	(spark.yarn.executor.memoryOverhead,4096)
	(spark.yarn.historyServer.address,http://fks-fdp-galaxy-pluto-hs-0001-m.c.fks-fdp-galaxy.internal:18080)
	(spark.yarn.jars,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/spark3/jars/*)
	(spark.yarn.queue,de_adhoc)
	(spark.yarn.report.interval,60s)
	(spark.yarn.secondary.jars,hadoop-lzo-0.6.0.2.4.0.0-169.jar,hadoop-4mc-1.1.0.jar,json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,iceberg-hive-runtime-1.2.0.jar,iceberg-spark-runtime-3.1_2.12-1.2.0.jar)
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.exec.orc.default.compress does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.vectorized.complex.types.enabled does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.exec.orc.compression.strategy does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.enforce.sorting does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.metastore.client.scheme.handlers does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.vectorized.execution.ptf.enabled does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.support.sql11.reserved.keywords does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.vectorized.groupby.complex.types.enabled does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.heapsize does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.enforce.bucketing does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.fileformat.managed does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.exec.orc.default.stripe.size does not exist
23/11/30 18:41:39 WARN HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
23/11/30 18:41:39 WARN HiveClientImpl: Detected HiveConf hive.execution.engine is 'tez' and will be reset to 'mr' to disable useless hive logic
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.exec.orc.default.compress does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.vectorized.complex.types.enabled does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.exec.orc.compression.strategy does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.enforce.sorting does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.metastore.client.scheme.handlers does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.vectorized.execution.ptf.enabled does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.support.sql11.reserved.keywords does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.vectorized.groupby.complex.types.enabled does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.heapsize does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.enforce.bucketing does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.fileformat.managed does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.exec.orc.default.stripe.size does not exist
23/11/30 18:41:41 WARN HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
2023-11-30T18:41:41.927 ================================================================================
2023-11-30T18:41:41.927 START: q1 - iteration 1
2023-11-30T18:41:41.927 SQL:  with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 group by sr_customer_sk ,sr_store_sk) select  c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'MO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id limit 100
[Stage 0:>                                                          (0 + 0) / 1][Stage 0:>    (0 + 0) / 1][Stage 1:>    (0 + 0) / 1][Stage 2:>    (0 + 0) / 1][Stage 0:>    (0 + 1) / 1][Stage 1:>    (0 + 0) / 1][Stage 2:>    (0 + 1) / 1][Stage 0:>    (0 + 1) / 1][Stage 1:>    (0 + 1) / 1][Stage 2:>    (0 + 1) / 1]                                                                                23/11/30 18:41:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:41:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:41:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:41:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1:>                                                          (0 + 1) / 1]                                                                                23/11/30 18:42:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3:>                 (0 + 3) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:>                 (1 + 3) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:>                 (3 + 3) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:>                 (3 + 4) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:=>                (4 + 5) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:=>                (6 + 5) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:=>                (6 + 6) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:=>                (6 + 7) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>               (7 + 7) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>               (9 + 7) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>               (9 + 9) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>              (9 + 11) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>              (9 + 13) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>              (9 + 18) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:==>             (10 + 18) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:===>            (13 + 18) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:===>            (13 + 22) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:===>            (13 + 25) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:===>            (14 + 29) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:===>            (14 + 33) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:====>           (19 + 33) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:=====>          (20 + 33) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:=====>          (21 + 33) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:======>         (24 + 33) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:======>         (25 + 34) / 63][Stage 5:>                 (0 + 0) / 63][Stage 3:======>         (27 + 36) / 63][Stage 5:>                 (0 + 8) / 63][Stage 3:========>       (33 + 30) / 63][Stage 5:>                (0 + 17) / 63][Stage 3:=========>      (36 + 27) / 63][Stage 5:>                (0 + 27) / 63][Stage 3:=========>      (38 + 25) / 63][Stage 5:>                (0 + 29) / 63][Stage 3:=========>      (38 + 25) / 63][Stage 5:>                (0 + 30) / 63][Stage 3:=========>      (39 + 24) / 63][Stage 5:>                (0 + 33) / 63][Stage 3:=========>      (39 + 24) / 63][Stage 5:>                (0 + 47) / 63][Stage 3:==========>     (43 + 20) / 63][Stage 5:>                (0 + 56) / 63][Stage 3:==========>     (43 + 20) / 63][Stage 5:>                (2 + 61) / 63][Stage 3:==========>     (43 + 20) / 63][Stage 5:>                (3 + 60) / 63][Stage 3:==========>     (43 + 20) / 63][Stage 5:==>              (8 + 55) / 63][Stage 3:===========>    (44 + 19) / 63][Stage 5:===>            (12 + 51) / 63][Stage 3:===========>    (46 + 17) / 63][Stage 5:===>            (13 + 50) / 63][Stage 3:===========>    (47 + 16) / 63][Stage 5:===>            (14 + 49) / 63][Stage 3:============>   (48 + 15) / 63][Stage 5:====>           (16 + 47) / 63][Stage 3:============>   (50 + 13) / 63][Stage 5:====>           (19 + 44) / 63][Stage 3:===============> (58 + 5) / 63][Stage 5:====>           (19 + 44) / 63][Stage 3:===============> (58 + 5) / 63][Stage 5:=====>          (20 + 43) / 63][Stage 3:===============> (59 + 4) / 63][Stage 5:=====>          (20 + 43) / 63][Stage 3:================>(61 + 2) / 63][Stage 5:=======>        (28 + 35) / 63][Stage 5:============================>                           (32 + 31) / 63][Stage 5:===============================>                        (35 + 28) / 63][Stage 5:=================================>                      (38 + 25) / 63][Stage 4:===========>  (164 + 36) / 200][Stage 5:==========>     (40 + 23) / 63][Stage 4:===========>  (165 + 35) / 200][Stage 5:==========>     (41 + 22) / 63][Stage 4:===========>  (166 + 34) / 200][Stage 5:==========>     (42 + 21) / 63][Stage 4:===========>  (167 + 33) / 200][Stage 5:============>   (51 + 12) / 63][Stage 4:===========>  (167 + 33) / 200][Stage 5:==============>  (55 + 8) / 63][Stage 4:==============>(195 + 5) / 200][Stage 5:===============> (58 + 5) / 63][Stage 7:==============================================>       (171 + 29) / 200]                                                                                2023-11-30T18:42:25.612 END took 43682 ms: q1 - iteration 1
2023-11-30T18:42:25.612 ================================================================================
2023-11-30T18:42:25.612 ================================================================================
2023-11-30T18:42:25.612 START: q10 - iteration 1
2023-11-30T18:42:25.612 SQL:  select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Grady County','Marion County','Decatur County','Lyman County','Beaver County') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 and 2+3) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 ANd 2+3) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 and 2+3)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100
23/11/30 18:42:28 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
23/11/30 18:42:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 8:>                                                          (0 + 1) / 1]                                                                                23/11/30 18:42:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 10:> (0 + 58) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:> (0 + 56) / 57][Stage 10:> (1 + 57) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:> (0 + 57) / 57][Stage 10:> (1 + 57) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:> (1 + 56) / 57][Stage 10:> (7 + 51) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:>(10 + 47) / 57][Stage 10:>(37 + 21) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:>(38 + 19) / 57][Stage 10:>(41 + 17) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:>(40 + 17) / 57][Stage 10:>(41 + 17) / 58][Stage 11:>   (0 + 1) / 1][Stage 12:>(41 + 16) / 57][Stage 10:>(41 + 17) / 58][Stage 12:>(41 + 16) / 57][Stage 13:>(0 + 83) / 114][Stage 10:>(41 + 17) / 58][Stage 12:>(41 + 16) / 57][Stage 13:>(1 + 83) / 114][Stage 10:>(41 + 17) / 58][Stage 12:>(41 + 16) / 57][Stage 13:>(2 + 83) / 114][Stage 10:>(41 + 17) / 58][Stage 12:>(41 + 16) / 57][Stage 13:>(6 + 83) / 114][Stage 10:>(41 + 17) / 58][Stage 12:>(42 + 15) / 57][Stage 13:(30 + 84) / 114][Stage 10:>(41 + 17) / 58][Stage 12:>(42 + 15) / 57][Stage 13:(68 + 46) / 114][Stage 10:>(44 + 14) / 58][Stage 12:>(45 + 12) / 57][Stage 13:(81 + 33) / 114][Stage 10:=>(51 + 7) / 58][Stage 12:=>(51 + 6) / 57][Stage 13:(82 + 32) / 114][Stage 10:===============>(57 + 1) / 58][Stage 13:==========>   (82 + 32) / 114][Stage 13:=======================================>              (84 + 30) / 114][Stage 13:========================================>             (85 + 29) / 114][Stage 13:===========================================>          (91 + 23) / 114][Stage 13:===================================================>  (108 + 6) / 114][Stage 15:=======>                                              (26 + 11) / 200][Stage 15:=============>                                        (51 + 11) / 200][Stage 15:====================>                                 (75 + 11) / 200][Stage 15:==========================>                          (101 + 11) / 200][Stage 15:===================================>                 (133 + 11) / 200][Stage 15:===============================================>     (178 + 11) / 200][Stage 16:=====================>                                (78 + 11) / 200][Stage 16:===================================>                 (134 + 11) / 200][Stage 17:=====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:42:40.408 END took 14795 ms: q10 - iteration 1
2023-11-30T18:42:40.408 ================================================================================
2023-11-30T18:42:40.408 ================================================================================
2023-11-30T18:42:40.408 START: q11 - iteration 1
2023-11-30T18:42:40.408 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_preferred_cust_flag from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 2001 and t_s_secyear.dyear = 2001+1 and t_w_firstyear.dyear = 2001 and t_w_secyear.dyear = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_preferred_cust_flag limit 100
23/11/30 18:42:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:42:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 21:>             (0 + 114) / 114][Stage 24:>                (0 + 6) / 57][Stage 21:=>           (10 + 104) / 114][Stage 24:>               (0 + 16) / 57][Stage 21:==========>   (83 + 31) / 114][Stage 24:>               (3 + 54) / 57][Stage 21:=============>(111 + 3) / 114][Stage 24:=>              (4 + 53) / 57][Stage 21:=============>(111 + 3) / 114][Stage 24:=>              (5 + 52) / 57][Stage 21:=============>(111 + 3) / 114][Stage 24:=====>         (19 + 38) / 57][Stage 21:=============>(111 + 3) / 114][Stage 24:==============> (53 + 4) / 57][Stage 21:=============>(111 + 3) / 114][Stage 24:===============>(56 + 1) / 57][Stage 21:====================================================> (111 + 3) / 114][Stage 21:(111 + 3) / 114][Stage 25:(29 + 11) / 200][Stage 29:> (0 + 0) / 200][Stage 21:(111 + 3) / 114][Stage 25:(63 + 11) / 200][Stage 29:> (0 + 0) / 200][Stage 21:(111 + 3) / 114][Stage 25:(102 + 11) / 200][Stage 29:> (0 + 0) / 200][Stage 21:(111 + 3) / 114][Stage 25:(133 + 11) / 200][Stage 29:> (0 + 0) / 200][Stage 21:(111 + 3) / 114][Stage 25:(171 + 11) / 200][Stage 29:> (0 + 0) / 200][Stage 29:>                                                      (0 + 11) / 200][Stage 29:===>                                                   (11 + 0) / 200][Stage 22:(44 + 11) / 200][Stage 26:(187 + 0) / 200][Stage 27:> (0 + 0) / 200][Stage 22:(72 + 11) / 200][Stage 26:(187 + 0) / 200][Stage 27:> (0 + 0) / 200][Stage 22:(97 + 11) / 200][Stage 26:(187 + 0) / 200][Stage 27:> (0 + 0) / 200][Stage 22:(122 + 11) / 200][Stage 26:(187 + 0) / 200][Stage 27:> (0 + 0) / 200][Stage 22:(158 + 11) / 200][Stage 26:(187 + 0) / 200][Stage 27:> (0 + 0) / 200][Stage 26:(187 + 11) / 200][Stage 27:> (0 + 0) / 200][Stage 29:>(11 + 0) / 200][Stage 26:(199 + 1) / 200][Stage 27:>(0 + 10) / 200][Stage 29:(11 + 78) / 200][Stage 27:>             (14 + 11) / 200][Stage 29:>            (12 + 110) / 200][Stage 27:===>          (48 + 11) / 200][Stage 29:===>         (50 + 109) / 200][Stage 27:======>       (95 + 11) / 200][Stage 29:==========>  (166 + 34) / 200][Stage 27:====================================>                (136 + 11) / 200][Stage 27:=============================================>       (172 + 11) / 200]                                                                                2023-11-30T18:42:52.057 END took 11649 ms: q11 - iteration 1
2023-11-30T18:42:52.057 ================================================================================
2023-11-30T18:42:52.057 ================================================================================
2023-11-30T18:42:52.057 START: q12 - iteration 1
2023-11-30T18:42:52.058 SQL:  select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Children', 'Jewelry', 'Music') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-05-11' as date) and (cast('2001-05-11' as date) + INTERVAL 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100
23/11/30 18:42:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:42:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 34:>                                                       (0 + 57) / 57][Stage 34:==========================================>            (44 + 13) / 57]                                                                                2023-11-30T18:42:55.482 END took 3424 ms: q12 - iteration 1
2023-11-30T18:42:55.483 ================================================================================
2023-11-30T18:42:55.483 ================================================================================
2023-11-30T18:42:55.483 START: q13 - iteration 1
2023-11-30T18:42:55.483 SQL:  select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('SC', 'WY', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'NE', 'GA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'AR', 'MI') and ss_net_profit between 50 and 250 ))
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:42:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 41:>             (0 + 114) / 114][Stage 42:>                 (0 + 1) / 1][Stage 41:>                                                     (0 + 114) / 114][Stage 41:>                                                     (2 + 112) / 114][Stage 41:===================================>                  (75 + 39) / 114][Stage 41:===================================================>  (108 + 6) / 114][Stage 41:====================================================> (111 + 3) / 114]                                                                                2023-11-30T18:43:02.515 END took 7032 ms: q13 - iteration 1
2023-11-30T18:43:02.515 ================================================================================
2023-11-30T18:43:02.515 ================================================================================
2023-11-30T18:43:02.515 START: q14a - iteration 1
2023-11-30T18:43:02.516 SQL:  with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales) from( select 'store' channel, i_brand_id,i_class_id ,i_category_id,sum(ss_quantity*ss_list_price) sales , count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales) union all select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales from catalog_sales ,item ,date_dim where cs_item_sk in (select ss_item_sk from cross_items) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales) union all select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales from web_sales ,item ,date_dim where ws_item_sk in (select ss_item_sk from cross_items) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales) ) y group by rollup (channel, i_brand_id,i_class_id,i_category_id) order by channel,i_brand_id,i_class_id,i_category_id limit 100
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 50:(0 + 124) / 229][Stage 52:>   (0 + 0) / 1][Stage 53:>  (0 + 0) / 58][Stage 50:(20 + 124) / 229][Stage 52:>   (0 + 0) / 1][Stage 53:>  (0 + 0) / 58][Stage 50:(112 + 117) / 229][Stage 52:>   (0 + 1) / 1][Stage 53:>  (0 + 6) / 58][Stage 50:(120 + 109) / 229][Stage 53:> (0 + 15) / 58][Stage 54:>  (0 + 0) / 57][Stage 50:(124 + 105) / 229][Stage 53:> (0 + 19) / 58][Stage 54:>  (0 + 0) / 57][Stage 50:(130 + 99) / 229][Stage 53:> (0 + 25) / 58][Stage 54:>  (0 + 0) / 57][Stage 50:(189 + 40) / 229][Stage 53:> (4 + 54) / 58][Stage 54:> (0 + 30) / 57][Stage 50:(227 + 2) / 229][Stage 53:>(11 + 47) / 58][Stage 54:> (0 + 57) / 57][Stage 50:(228 + 1) / 229][Stage 53:>(19 + 39) / 58][Stage 54:> (0 + 57) / 57][Stage 50:(228 + 1) / 229][Stage 53:>(20 + 38) / 58][Stage 54:> (0 + 57) / 57][Stage 50:(228 + 1) / 229][Stage 53:>(25 + 33) / 58][Stage 54:> (2 + 55) / 57][Stage 50:(228 + 1) / 229][Stage 53:=>(53 + 5) / 58][Stage 54:>(38 + 19) / 57]                                                                                [Stage 55:===============>                                      (56 + 11) / 200][Stage 55:======================>                               (85 + 11) / 200][Stage 55:================================>                    (122 + 11) / 200][Stage 55:=========================================>           (158 + 11) / 200][Stage 55:=====================================================>(199 + 1) / 200]                                                                                23/11/30 18:43:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 56:>                                                     (0 + 114) / 114][Stage 56:==>                                                   (6 + 108) / 114][Stage 56:============================================>         (94 + 20) / 114][Stage 56:====================================================> (111 + 3) / 114][Stage 56:=====================================================>(112 + 2) / 114][Stage 56:=====================================================>(113 + 1) / 114][Stage 59:=============>                                         (50 + 1) / 200][Stage 59:===================>                                   (71 + 1) / 200][Stage 59:=========================>                             (91 + 1) / 200][Stage 59:=============================>                        (108 + 1) / 200][Stage 59:==================================>                   (129 + 1) / 200][Stage 59:==========================================>           (156 + 1) / 200][Stage 59:=================================================>    (183 + 1) / 200]                                                                                23/11/30 18:43:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 60:>(0 + 69) / 114][Stage 63:>  (0 + 0) / 58][Stage 64:> (0 + 57) / 57][Stage 60:(21 + 90) / 114][Stage 63:>  (0 + 0) / 58][Stage 64:>(20 + 37) / 57][Stage 60:(68 + 46) / 114][Stage 63:> (0 + 58) / 58][Stage 64:=>(55 + 2) / 57][Stage 60:========>     (69 + 45) / 114][Stage 63:>               (0 + 58) / 58][Stage 60:========>     (69 + 45) / 114][Stage 63:>               (1 + 57) / 58][Stage 60:========>     (71 + 43) / 114][Stage 63:>               (1 + 57) / 58][Stage 60:=============>(111 + 3) / 114][Stage 63:=>              (5 + 53) / 58][Stage 63:=============================================>         (48 + 10) / 58][Stage 67:=====================================================>(198 + 2) / 200]                                                                                2023-11-30T18:43:25.611 END took 23094 ms: q14a - iteration 1
2023-11-30T18:43:25.611 ================================================================================
2023-11-30T18:43:25.611 ================================================================================
2023-11-30T18:43:25.611 START: q14b - iteration 1
2023-11-30T18:43:25.611 SQL:  with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select  this_year.channel ty_channel ,this_year.i_brand_id ty_brand ,this_year.i_class_id ty_class ,this_year.i_category_id ty_category ,this_year.sales ty_sales ,this_year.number_sales ty_number_sales ,last_year.channel ly_channel ,last_year.i_brand_id ly_brand ,last_year.i_class_id ly_class ,last_year.i_category_id ly_category ,last_year.sales ly_sales ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 5) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 5) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 77:(0 + 126) / 229][Stage 79:>   (0 + 0) / 1][Stage 80:>  (0 + 0) / 58][Stage 77:(87 + 126) / 229][Stage 79:>   (0 + 0) / 1][Stage 80:>  (0 + 0) / 58]                                                                                23/11/30 18:43:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 77:(127 + 102) / 229][Stage 80:> (0 + 24) / 58][Stage 81:>   (0 + 0) / 1][Stage 77:(147 + 82) / 229][Stage 80:> (0 + 44) / 58][Stage 81:>   (0 + 0) / 1][Stage 77:(227 + 2) / 229][Stage 80:> (8 + 50) / 58][Stage 82:> (0 + 57) / 57]                                                                                [Stage 80:======>        (25 + 33) / 58][Stage 82:>               (0 + 57) / 57][Stage 80:=======>       (29 + 29) / 58][Stage 82:>               (1 + 56) / 57][Stage 80:===============>(56 + 2) / 58][Stage 82:=========>     (35 + 22) / 57][Stage 83:==================>                                    (66 + 9) / 200][Stage 83:=============================>                        (109 + 9) / 200][Stage 83:==========================================>           (157 + 9) / 200][Stage 83:=====================================================>(199 + 1) / 200]                                                                                23/11/30 18:43:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 84:>                                                     (0 + 114) / 114][Stage 84:===========>                                          (24 + 90) / 114][Stage 84:============================================>         (93 + 21) / 114][Stage 84:==================================================>   (107 + 7) / 114][Stage 84:===================================================>  (108 + 6) / 114][Stage 84:====================================================> (110 + 4) / 114][Stage 84:=====================================================>(112 + 2) / 114][Stage 84:=====================================================>(113 + 1) / 114]                                                                                23/11/30 18:43:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 89:>                                                     (0 + 114) / 114][Stage 89:==>                                                   (6 + 108) / 114][Stage 89:================================================>    (104 + 10) / 114][Stage 93:=====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:43:43.346 END took 17734 ms: q14b - iteration 1
2023-11-30T18:43:43.346 ================================================================================
2023-11-30T18:43:43.346 ================================================================================
2023-11-30T18:43:43.346 START: q15 - iteration 1
2023-11-30T18:43:43.346 SQL:  select  ca_zip ,sum(cs_sales_price) from catalog_sales ,customer ,customer_address ,date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip limit 100
23/11/30 18:43:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 97:>                                                       (1 + 57) / 58][Stage 97:==========================>                            (28 + 30) / 58][Stage 97:=======================================================>(57 + 1) / 58]                                                                                2023-11-30T18:43:48.298 END took 4951 ms: q15 - iteration 1
2023-11-30T18:43:48.298 ================================================================================
2023-11-30T18:43:48.298 ================================================================================
2023-11-30T18:43:48.298 START: q16 - iteration 1
2023-11-30T18:43:48.298 SQL:  select count(distinct cs_order_number) as `order count` ,sum(cs_ext_ship_cost) as `total shipping cost` ,sum(cs_net_profit) as `total net profit` from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2000-3-01' and (cast('2000-3-01' as date) + INTERVAL 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Luce County','Wadena County','Jefferson Davis Parish','Daviess County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100
23/11/30 18:43:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 99:>                                                       (1 + 64) / 65][Stage 99:============================================>          (52 + 13) / 65][Stage 99:======================================================> (63 + 2) / 65]                                                                                23/11/30 18:43:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 103:>              (1 + 57) / 58][Stage 104:>              (1 + 57) / 58][Stage 103:===========>  (46 + 12) / 58][Stage 104:===========>  (47 + 11) / 58][Stage 103:======================================================>(57 + 1) / 58]                                                                                2023-11-30T18:43:53.843 END took 5545 ms: q16 - iteration 1
2023-11-30T18:43:53.843 ================================================================================
2023-11-30T18:43:53.843 ================================================================================
2023-11-30T18:43:53.843 START: q17 - iteration 1
2023-11-30T18:43:53.843 SQL:  select  i_item_id ,i_item_desc ,s_state ,count(ss_quantity) as store_sales_quantitycount ,avg(ss_quantity) as store_sales_quantityave ,stddev_samp(ss_quantity) as store_sales_quantitystdev ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov ,count(sr_return_quantity) as store_returns_quantitycount ,avg(sr_return_quantity) as store_returns_quantityave ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_quarter_name = '1999Q1' and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_quarter_name in ('1999Q1','1999Q2','1999Q3') and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_quarter_name in ('1999Q1','1999Q2','1999Q3') group by i_item_id ,i_item_desc ,s_state order by i_item_id ,i_item_desc ,s_state limit 100
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 109:>                                                      (0 + 63) / 63][Stage 109:>                                                      (1 + 62) / 63][Stage 109:===>                                                   (4 + 59) / 63][Stage 109:===============================================>       (54 + 9) / 63]                                                                                23/11/30 18:43:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:43:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 112:>            (0 + 114) / 114][Stage 113:>              (0 + 14) / 58][Stage 112:>            (0 + 114) / 114][Stage 113:>              (3 + 14) / 58][Stage 112:======>      (56 + 58) / 114][Stage 113:===>          (14 + 44) / 58][Stage 112:============>(112 + 2) / 114][Stage 113:===>          (14 + 44) / 58][Stage 113:=============>                                        (15 + 43) / 58][Stage 113:===================>                                  (21 + 37) / 58][Stage 113:==============================================>        (49 + 9) / 58][Stage 114:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:44:00.506 END took 6662 ms: q17 - iteration 1
2023-11-30T18:44:00.506 ================================================================================
2023-11-30T18:44:00.506 ================================================================================
2023-11-30T18:44:00.506 START: q18 - iteration 1
2023-11-30T18:44:00.506 SQL:  select  i_item_id, ca_country, ca_state, ca_county, avg( cast(cs_quantity as decimal(12,2))) agg1, avg( cast(cs_list_price as decimal(12,2))) agg2, avg( cast(cs_coupon_amt as decimal(12,2))) agg3, avg( cast(cs_sales_price as decimal(12,2))) agg4, avg( cast(cs_net_profit as decimal(12,2))) agg5, avg( cast(c_birth_year as decimal(12,2))) agg6, avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7 from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd1.cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd1.cd_gender = 'F' and cd1.cd_education_status = 'Unknown' and c_current_cdemo_sk = cd2.cd_demo_sk and c_current_addr_sk = ca_address_sk and c_birth_month in (4,8,12,10,11,9) and d_year = 2001 and ca_state in ('AR','IA','TX' ,'KS','LA','NC','SD') group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country, ca_state, ca_county, i_item_id limit 100
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 122:>                                                      (1 + 57) / 58][Stage 122:===========>                                          (12 + 46) / 58][Stage 122:====================================================>  (55 + 3) / 58][Stage 123:=================>                                   (65 + 11) / 200][Stage 123:===================================>                (136 + 11) / 200][Stage 123:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:44:04.977 END took 4471 ms: q18 - iteration 1
2023-11-30T18:44:04.978 ================================================================================
2023-11-30T18:44:04.978 ================================================================================
2023-11-30T18:44:04.978 START: q19 - iteration 1
2023-11-30T18:44:04.978 SQL:  select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=63 and d_moy=11 and d_year=2002 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip,1,5) <> substr(s_zip,1,5) and ss_store_sk = s_store_sk group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100 
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 130:>                                                    (0 + 114) / 114][Stage 130:==============================>                      (65 + 49) / 114][Stage 130:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:44:07.515 END took 2537 ms: q19 - iteration 1
2023-11-30T18:44:07.515 ================================================================================
2023-11-30T18:44:07.516 ================================================================================
2023-11-30T18:44:07.516 START: q2 - iteration 1
2023-11-30T18:44:07.516 SQL:  with wscs as (select sold_date_sk ,sales_price from (select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales)), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1
23/11/30 18:44:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 135:>                                                    (1 + 114) / 115][Stage 135:=====>                                              (13 + 102) / 115][Stage 135:=================================================>   (108 + 7) / 115]                                                                                2023-11-30T18:44:10.983 END took 3467 ms: q2 - iteration 1
2023-11-30T18:44:10.983 ================================================================================
2023-11-30T18:44:10.983 ================================================================================
2023-11-30T18:44:10.983 START: q20 - iteration 1
2023-11-30T18:44:10.983 SQL:  select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from	catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Electronics', 'Children', 'Home') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-03-19' as date) and (cast('2002-03-19' as date) + INTERVAL 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100
23/11/30 18:44:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 144:>                                                      (1 + 57) / 58][Stage 144:====================================>                 (39 + 19) / 58]                                                                                2023-11-30T18:44:13.283 END took 2299 ms: q20 - iteration 1
2023-11-30T18:44:13.283 ================================================================================
2023-11-30T18:44:13.283 ================================================================================
2023-11-30T18:44:13.283 START: q21 - iteration 1
2023-11-30T18:44:13.283 SQL:  select  * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-04-12' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-04-12' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = inv_item_sk and inv_warehouse_sk   = w_warehouse_sk and inv_date_sk    = d_date_sk and d_date between (cast ('1999-04-12' as date) - INTERVAL 30 days) and (cast ('1999-04-12' as date) + INTERVAL 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id limit 100
23/11/30 18:44:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 150:======>                                                  (1 + 8) / 9][Stage 150:============>                                            (2 + 7) / 9][Stage 150:============================================>            (7 + 2) / 9]                                                                                2023-11-30T18:44:16.559 END took 3275 ms: q21 - iteration 1
2023-11-30T18:44:16.559 ================================================================================
2023-11-30T18:44:16.559 ================================================================================
2023-11-30T18:44:16.559 START: q22 - iteration 1
2023-11-30T18:44:16.559 SQL:  select  i_product_name ,i_brand ,i_class ,i_category ,avg(inv_quantity_on_hand) qoh from inventory ,date_dim ,item where inv_date_sk=d_date_sk and inv_item_sk=i_item_sk and d_month_seq between 1188 and 1188 + 11 group by rollup(i_product_name ,i_brand ,i_class ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category limit 100
23/11/30 18:44:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 154:======>                                                  (1 + 8) / 9][Stage 154:============>                                            (2 + 7) / 9][Stage 154:=========================>                               (4 + 5) / 9][Stage 154:======================================>                  (6 + 3) / 9]                                                                                2023-11-30T18:44:19.394 END took 2834 ms: q22 - iteration 1
2023-11-30T18:44:19.394 ================================================================================
2023-11-30T18:44:19.394 ================================================================================
2023-11-30T18:44:19.394 START: q23a - iteration 1
2023-11-30T18:44:19.394 SQL:  with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (1998,1998+1,1998+2,1998+3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1,1998+2,1998+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select  sum(sales) from (select cs_quantity*cs_list_price sales from catalog_sales ,date_dim where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) union all select ws_quantity*ws_list_price sales from web_sales ,date_dim where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) limit 100
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 162:>                                                    (0 + 114) / 114][Stage 162:=============================>                       (64 + 50) / 114][Stage 162:====================================================>(113 + 1) / 114]                                                                                [Stage 165:(0 + 14) / 114][Stage 167:> (0 + 0) / 57][Stage 168:> (0 + 0) / 58][Stage 165:(0 + 17) / 114][Stage 167:> (0 + 0) / 57][Stage 168:> (0 + 0) / 58][Stage 165:(4 + 110) / 114][Stage 167:> (0 + 5) / 57][Stage 168:> (0 + 0) / 58][Stage 165:(14 + 100) / 114][Stage 167:>(0 + 28) / 57][Stage 168:> (0 + 0) / 58][Stage 165:(63 + 51) / 114][Stage 167:>(0 + 57) / 57][Stage 168:>(0 + 20) / 58][Stage 165:(113 + 1) / 114][Stage 167:(17 + 40) / 57][Stage 168:>(0 + 58) / 58][Stage 167:======>       (28 + 29) / 57][Stage 168:>              (1 + 57) / 58][Stage 167:=========>    (39 + 18) / 57][Stage 168:==>            (9 + 49) / 58][Stage 167:==============>(56 + 1) / 57][Stage 168:==============>(56 + 2) / 58][Stage 170:====================================================>(199 + 1) / 200][Stage 172:====================================================>(399 + 1) / 400]                                                                                2023-11-30T18:44:30.310 END took 10915 ms: q23a - iteration 1
2023-11-30T18:44:30.310 ================================================================================
2023-11-30T18:44:30.310 ================================================================================
2023-11-30T18:44:30.310 START: q23b - iteration 1
2023-11-30T18:44:30.310 SQL:  with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (1998,1998 + 1,1998 + 2,1998 + 3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1,1998+2,1998+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select  c_last_name,c_first_name,sales from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales from catalog_sales ,customer ,date_dim where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name union all select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales from web_sales ,customer ,date_dim where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name) order by c_last_name,c_first_name,sales limit 100
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 180:>                                                    (0 + 114) / 114][Stage 180:>                                                    (1 + 113) / 114][Stage 180:==========================================>          (92 + 22) / 114][Stage 180:====================================================>(112 + 2) / 114][Stage 180:====================================================>(113 + 1) / 114]                                                                                [Stage 183:>                                                    (0 + 114) / 114][Stage 183:===========================================>         (93 + 21) / 114][Stage 185:===========>(188 + 11) / 200][Stage 186:>              (0 + 0) / 200]                                                                                23/11/30 18:44:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 187:(0 + 73) / 114][Stage 188:>(0 + 57) / 57][Stage 193:> (0 + 0) / 58][Stage 187:(12 + 81) / 114][Stage 188:>(7 + 50) / 57][Stage 193:> (0 + 0) / 58][Stage 187:(65 + 49) / 114][Stage 188:>(55 + 2) / 57][Stage 193:>(0 + 58) / 58][Stage 187:========>    (72 + 42) / 114][Stage 193:>              (0 + 58) / 58][Stage 187:========>    (73 + 41) / 114][Stage 193:>              (1 + 57) / 58][Stage 187:==========>  (92 + 22) / 114][Stage 193:>              (2 + 56) / 58][Stage 187:============>(113 + 1) / 114][Stage 193:===========>  (47 + 11) / 58]                                                                                2023-11-30T18:44:42.880 END took 12570 ms: q23b - iteration 1
2023-11-30T18:44:42.880 ================================================================================
2023-11-30T18:44:42.880 ================================================================================
2023-11-30T18:44:42.880 START: q24a - iteration 1
2023-11-30T18:44:42.880 SQL:  with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id=7 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'goldenrod' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 197:>              (1 + 62) / 63][Stage 198:>              (1 + 62) / 63][Stage 197:=>             (7 + 56) / 63][Stage 198:=>             (6 + 57) / 63][Stage 197:==============>(61 + 2) / 63][Stage 198:==============>(61 + 2) / 63]                                                                                23/11/30 18:44:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 207:>                                                    (0 + 114) / 114][Stage 207:==============================>                      (65 + 49) / 114]                                                                                [Stage 210:>                                                    (0 + 114) / 114][Stage 210:>                                                    (2 + 112) / 114][Stage 210:=========================================>           (90 + 24) / 114]                                                                                2023-11-30T18:44:50.327 END took 7446 ms: q24a - iteration 1
2023-11-30T18:44:50.328 ================================================================================
2023-11-30T18:44:50.328 ================================================================================
2023-11-30T18:44:50.328 START: q24b - iteration 1
2023-11-30T18:44:50.328 SQL:  with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id = 7 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'magenta' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 218:>              (0 + 63) / 63][Stage 226:>              (0 + 63) / 63][Stage 218:>              (1 + 62) / 63][Stage 226:>              (1 + 62) / 63][Stage 218:=>             (5 + 58) / 63][Stage 226:>              (2 + 61) / 63][Stage 218:==============>(61 + 2) / 63][Stage 226:==============>(60 + 3) / 63]                                                                                23/11/30 18:44:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 227:>                                                    (0 + 114) / 114][Stage 227:>                                                    (1 + 113) / 114][Stage 227:==========================================>          (91 + 23) / 114]                                                                                [Stage 230:>                                                    (0 + 114) / 114][Stage 230:==========>                                          (23 + 91) / 114][Stage 230:=============================================>       (98 + 16) / 114]                                                                                2023-11-30T18:44:56.997 END took 6669 ms: q24b - iteration 1
2023-11-30T18:44:56.997 ================================================================================
2023-11-30T18:44:56.997 ================================================================================
2023-11-30T18:44:56.997 START: q25 - iteration 1
2023-11-30T18:44:56.997 SQL:  select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy               between 4 and  10 and d2.d_year              = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy               between 4 and  10 and d3.d_year              = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 238:>                                                      (1 + 62) / 63][Stage 238:===============>                                      (18 + 45) / 63][Stage 238:======================================================>(62 + 1) / 63]                                                                                23/11/30 18:44:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:44:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 242:>            (0 + 114) / 114][Stage 243:>              (0 + 16) / 58][Stage 242:=====>       (52 + 62) / 114][Stage 243:===>          (14 + 44) / 58][Stage 242:============>(112 + 2) / 114][Stage 243:===>          (16 + 42) / 58][Stage 243:===============>                                      (17 + 41) / 58][Stage 243:========================================>             (43 + 15) / 58][Stage 243:======================================================>(57 + 1) / 58]                                                                                2023-11-30T18:45:03.032 END took 6035 ms: q25 - iteration 1
2023-11-30T18:45:03.032 ================================================================================
2023-11-30T18:45:03.033 ================================================================================
2023-11-30T18:45:03.033 START: q26 - iteration 1
2023-11-30T18:45:03.033 SQL:  select  i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from catalog_sales, customer_demographics, date_dim, item, promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id limit 100
23/11/30 18:45:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 250:>                                                      (1 + 57) / 58][Stage 250:==============================================>        (49 + 9) / 58][Stage 251:===================================================> (193 + 7) / 200]                                                                                2023-11-30T18:45:06.427 END took 3394 ms: q26 - iteration 1
2023-11-30T18:45:06.427 ================================================================================
2023-11-30T18:45:06.427 ================================================================================
2023-11-30T18:45:06.427 START: q27 - iteration 1
2023-11-30T18:45:06.427 SQL:  select  i_item_id, s_state, grouping(s_state) g_state, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Secondary' and d_year = 1999 and s_state in ('AL','FL', 'TX', 'NM', 'MI', 'GA') group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100
23/11/30 18:45:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 257:>                                                    (0 + 114) / 114][Stage 257:=======================================>             (85 + 29) / 114]                                                                                2023-11-30T18:45:09.373 END took 2946 ms: q27 - iteration 1
2023-11-30T18:45:09.373 ================================================================================
2023-11-30T18:45:09.373 ================================================================================
2023-11-30T18:45:09.373 START: q28 - iteration 1
2023-11-30T18:45:09.373 SQL:  select  * from (select avg(ss_list_price) B1_LP ,count(ss_list_price) B1_CNT ,count(distinct ss_list_price) B1_CNTD from store_sales where ss_quantity between 0 and 5 and (ss_list_price between 74 and 74+10 or ss_coupon_amt between 2949 and 2949+1000 or ss_wholesale_cost between 49 and 49+20)) B1, (select avg(ss_list_price) B2_LP ,count(ss_list_price) B2_CNT ,count(distinct ss_list_price) B2_CNTD from store_sales where ss_quantity between 6 and 10 and (ss_list_price between 136 and 136+10 or ss_coupon_amt between 10027 and 10027+1000 or ss_wholesale_cost between 53 and 53+20)) B2, (select avg(ss_list_price) B3_LP ,count(ss_list_price) B3_CNT ,count(distinct ss_list_price) B3_CNTD from store_sales where ss_quantity between 11 and 15 and (ss_list_price between 73 and 73+10 or ss_coupon_amt between 1451 and 1451+1000 or ss_wholesale_cost between 78 and 78+20)) B3, (select avg(ss_list_price) B4_LP ,count(ss_list_price) B4_CNT ,count(distinct ss_list_price) B4_CNTD from store_sales where ss_quantity between 16 and 20 and (ss_list_price between 87 and 87+10 or ss_coupon_amt between 17007 and 17007+1000 or ss_wholesale_cost between 55 and 55+20)) B4, (select avg(ss_list_price) B5_LP ,count(ss_list_price) B5_CNT ,count(distinct ss_list_price) B5_CNTD from store_sales where ss_quantity between 21 and 25 and (ss_list_price between 112 and 112+10 or ss_coupon_amt between 17243 and 17243+1000 or ss_wholesale_cost between 2 and 2+20)) B5, (select avg(ss_list_price) B6_LP ,count(ss_list_price) B6_CNT ,count(distinct ss_list_price) B6_CNTD from store_sales where ss_quantity between 26 and 30 and (ss_list_price between 119 and 119+10 or ss_coupon_amt between 4954 and 4954+1000 or ss_wholesale_cost between 22 and 22+20)) B6 limit 100
[Stage 260:(0 + 114) / 114][Stage 263:(0 + 16) / 114][Stage 266:>(0 + 0) / 114][Stage 260:(8 + 106) / 114][Stage 263:(0 + 24) / 114][Stage 266:>(0 + 0) / 114][Stage 260:(112 + 2) / 114][Stage 263:(16 + 98) / 114][Stage 266:(0 + 30) / 114][Stage 263:(16 + 98) / 114][Stage 266:(0 + 32) / 114][Stage 269:>(0 + 0) / 114][Stage 261:>(0 + 0) / 200][Stage 263:(16 + 98) / 114][Stage 266:(0 + 32) / 114][Stage 261:(7 + 10) / 200][Stage 263:(26 + 88) / 114][Stage 266:(0 + 32) / 114][Stage 261:(199 + 1) / 200][Stage 263:(105 + 9) / 114][Stage 266:(15 + 99) / 114]                                                                                [Stage 264:(24 + 1) / 200][Stage 266:(32 + 82) / 114][Stage 269:(0 + 47) / 114][Stage 264:(33 + 1) / 200][Stage 266:(32 + 82) / 114][Stage 269:(0 + 47) / 114][Stage 264:(49 + 1) / 200][Stage 266:(32 + 82) / 114][Stage 269:(0 + 47) / 114][Stage 264:(199 + 1) / 200][Stage 266:(107 + 7) / 114][Stage 269:(11 + 103) / 114]                                                                                [Stage 269:=====>       (47 + 67) / 114][Stage 272:>             (0 + 63) / 114]                                                                                [Stage 272:=========================>                           (54 + 60) / 114][Stage 270:============>(199 + 1) / 200][Stage 272:======>      (61 + 53) / 114][Stage 270:============>(199 + 1) / 200][Stage 272:=======>     (63 + 51) / 114][Stage 270:============>(199 + 1) / 200][Stage 272:=======>     (69 + 45) / 114][Stage 270:====================================================>(199 + 1) / 200]                                                                                [Stage 275:>                                                    (0 + 114) / 114][Stage 275:>                                                    (1 + 113) / 114][Stage 275:==================================================>  (109 + 5) / 114][Stage 275:====================================================>(113 + 1) / 114][Stage 276:===================================================> (193 + 7) / 200][Stage 276:===================================================> (195 + 5) / 200]                                                                                2023-11-30T18:45:22.057 END took 12684 ms: q28 - iteration 1
2023-11-30T18:45:22.058 ================================================================================
2023-11-30T18:45:22.058 ================================================================================
2023-11-30T18:45:22.058 START: q29 - iteration 1
2023-11-30T18:45:22.058 SQL:  select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_quantity)        as store_sales_quantity ,stddev_samp(sr_return_quantity) as store_returns_quantity ,stddev_samp(cs_quantity)        as catalog_sales_quantity from store_sales ,store_returns ,catalog_sales ,date_dim             d1 ,date_dim             d2 ,date_dim             d3 ,store ,item where d1.d_moy               = 4 and d1.d_year              = 2000 and d1.d_date_sk           = ss_sold_date_sk and i_item_sk              = ss_item_sk and s_store_sk             = ss_store_sk and ss_customer_sk         = sr_customer_sk and ss_item_sk             = sr_item_sk and ss_ticket_number       = sr_ticket_number and sr_returned_date_sk    = d2.d_date_sk and d2.d_moy               between 4 and  4 + 3 and d2.d_year              = 2000 and sr_customer_sk         = cs_bill_customer_sk and sr_item_sk             = cs_item_sk and cs_sold_date_sk        = d3.d_date_sk and d3.d_year              in (2000,2000+1,2000+2) group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 280:>                                                      (0 + 63) / 63][Stage 280:>                                                      (1 + 62) / 63][Stage 280:=====================>                                (25 + 38) / 63][Stage 280:================================================>      (55 + 8) / 63][Stage 280:===================================================>   (59 + 4) / 63][Stage 280:======================================================>(62 + 1) / 63]                                                                                23/11/30 18:45:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 284:>            (0 + 114) / 114][Stage 285:>              (0 + 24) / 58][Stage 284:=====>       (49 + 65) / 114][Stage 285:==>           (11 + 47) / 58][Stage 284:============>(106 + 8) / 114][Stage 285:=====>        (23 + 35) / 58][Stage 284:============>(109 + 5) / 114][Stage 285:======>       (25 + 33) / 58][Stage 284:============>(111 + 3) / 114][Stage 285:======>       (25 + 33) / 58][Stage 284:============>(111 + 3) / 114][Stage 285:======>       (26 + 32) / 58][Stage 284:============>(111 + 3) / 114][Stage 285:============>  (49 + 9) / 58][Stage 284:===================================================> (111 + 3) / 114][Stage 284:====================================================>(112 + 2) / 114][Stage 286:==================================================>  (192 + 8) / 200][Stage 286:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:45:32.616 END took 10558 ms: q29 - iteration 1
2023-11-30T18:45:32.616 ================================================================================
2023-11-30T18:45:32.616 ================================================================================
2023-11-30T18:45:32.616 START: q3 - iteration 1
2023-11-30T18:45:32.616 SQL:  select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_sales_price) sum_agg from  date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,sum_agg desc ,brand_id limit 100
23/11/30 18:45:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 290:>                                                    (0 + 114) / 114][Stage 290:===============================================>    (104 + 10) / 114][Stage 290:====================================================>(112 + 2) / 114][Stage 290:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:45:36.769 END took 4153 ms: q3 - iteration 1
2023-11-30T18:45:36.769 ================================================================================
2023-11-30T18:45:36.769 ================================================================================
2023-11-30T18:45:36.769 START: q30 - iteration 1
2023-11-30T18:45:36.769 SQL:  with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'MI' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return limit 100
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 296:>              (0 + 66) / 66][Stage 297:>              (0 + 66) / 66][Stage 296:=====>        (24 + 42) / 66][Stage 297:====>         (20 + 46) / 66][Stage 296:==============>(65 + 1) / 66][Stage 297:==============>(65 + 1) / 66]                                                                                2023-11-30T18:45:40.982 END took 4213 ms: q30 - iteration 1
2023-11-30T18:45:40.982 ================================================================================
2023-11-30T18:45:40.982 ================================================================================
2023-11-30T18:45:40.982 START: q31 - iteration 1
2023-11-30T18:45:40.982 SQL:  with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year) select ss1.ca_county ,ss1.d_year ,ws2.web_sales/ws1.web_sales web_q1_q2_increase ,ss2.store_sales/ss1.store_sales store_q1_q2_increase ,ws3.web_sales/ws2.web_sales web_q2_q3_increase ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from ss ss1 ,ss ss2 ,ss ss3 ,ws ws1 ,ws ws2 ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 307:(0 + 114) / 114][Stage 309:>(0 + 25) / 57][Stage 311:>(0 + 0) / 114][Stage 307:(1 + 113) / 114][Stage 309:>(0 + 26) / 57][Stage 311:>(0 + 0) / 114][Stage 307:(108 + 6) / 114][Stage 309:>(7 + 50) / 57][Stage 311:(0 + 83) / 114][Stage 309:(25 + 32) / 57][Stage 311:(0 + 102) / 114][Stage 313:>(0 + 0) / 114][Stage 309:(25 + 32) / 57][Stage 311:(0 + 107) / 114][Stage 313:>(0 + 0) / 114][Stage 308:(124 + 0) / 200][Stage 309:(25 + 32) / 57][Stage 311:(0 + 107) / 114][Stage 308:(124 + 3) / 200][Stage 309:(26 + 31) / 57][Stage 311:(3 + 105) / 114][Stage 309:>(52 + 5) / 57][Stage 311:(91 + 23) / 114][Stage 313:(0 + 111) / 114][Stage 311:(101 + 13) / 114][Stage 313:(0 + 114) / 114][Stage 315:>(0 + 12) / 57][Stage 311:(106 + 8) / 114][Stage 313:(0 + 114) / 114][Stage 315:>(0 + 16) / 57][Stage 310:(33 + 1) / 200][Stage 311:(107 + 7) / 114][Stage 313:(0 + 114) / 114][Stage 310:(62 + 2) / 200][Stage 311:(108 + 6) / 114][Stage 313:(0 + 114) / 114][Stage 310:(173 + 13) / 200][Stage 313:(26 + 88) / 114][Stage 315:>(0 + 28) / 57][Stage 313:(112 + 2) / 114][Stage 315:>(1 + 56) / 57][Stage 317:>(0 + 57) / 57][Stage 315:==>            (8 + 49) / 57][Stage 317:>              (0 + 57) / 57][Stage 315:===>          (13 + 44) / 57][Stage 317:>              (0 + 57) / 57][Stage 315:====>         (17 + 40) / 57][Stage 317:>              (0 + 57) / 57][Stage 315:======>       (27 + 30) / 57][Stage 317:=>             (5 + 52) / 57][Stage 317:====================================================>  (54 + 3) / 57]                                                                                [Stage 332:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:45:50.275 END took 9292 ms: q31 - iteration 1
2023-11-30T18:45:50.275 ================================================================================
2023-11-30T18:45:50.275 ================================================================================
2023-11-30T18:45:50.275 START: q32 - iteration 1
2023-11-30T18:45:50.275 SQL:  select  sum(cs_ext_discount_amt)  as `excess discount amount` from catalog_sales ,item ,date_dim where i_manufact_id = 490 and i_item_sk = cs_item_sk and d_date between '1999-01-27' and (cast('1999-01-27' as date) + INTERVAL 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '1999-01-27' and (cast('1999-01-27' as date) + INTERVAL 90 days) and d_date_sk = cs_sold_date_sk ) limit 100
23/11/30 18:45:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 336:>              (1 + 57) / 58][Stage 337:>              (1 + 57) / 58][Stage 336:==========>   (42 + 16) / 58][Stage 337:===========>  (46 + 12) / 58][Stage 337:=====================================================> (56 + 2) / 58][Stage 337:======================================================>(57 + 1) / 58]                                                                                2023-11-30T18:45:54.878 END took 4603 ms: q32 - iteration 1
2023-11-30T18:45:54.878 ================================================================================
2023-11-30T18:45:54.879 ================================================================================
2023-11-30T18:45:54.879 START: q33 - iteration 1
2023-11-30T18:45:54.879 SQL:  with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_manufact_id in (select i_manufact_id from item where i_category in ('Electronics')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in ('Electronics')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in ('Electronics')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id) select  i_manufact_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100
23/11/30 18:45:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:45:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:45:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 344:>(1 + 57) / 58][Stage 345:>(0 + 57) / 57][Stage 346:(0 + 27) / 114][Stage 344:(12 + 46) / 58][Stage 345:>(0 + 57) / 57][Stage 346:(0 + 38) / 114][Stage 344:>(57 + 1) / 58][Stage 345:>(54 + 3) / 57][Stage 346:(25 + 89) / 114][Stage 344:==============>(57 + 1) / 58][Stage 346:==>          (26 + 88) / 114][Stage 344:==============>(57 + 1) / 58][Stage 346:===>         (27 + 87) / 114][Stage 344:==============>(57 + 1) / 58][Stage 346:===========> (98 + 16) / 114][Stage 344:======================================================>(57 + 1) / 58][Stage 347:====================================================>(599 + 1) / 600]                                                                                2023-11-30T18:46:02.359 END took 7480 ms: q33 - iteration 1
2023-11-30T18:46:02.359 ================================================================================
2023-11-30T18:46:02.359 ================================================================================
2023-11-30T18:46:02.359 START: q34 - iteration 1
2023-11-30T18:46:02.359 SQL:  select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28) and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = 'Unknown') and household_demographics.hd_vehicle_count > 0 and (case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end)  > 1.2 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_county in ('Nez Perce County','Murray County','Surry County','Calhoun County', 'Wilkinson County','Brown County','Wallace County','Carter County') group by ss_ticket_number,ss_customer_sk) dn,customer where ss_customer_sk = c_customer_sk and cnt between 15 and 20 order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 353:>                                                    (0 + 114) / 114][Stage 353:==========================>                          (58 + 56) / 114][Stage 353:====================================================>(112 + 2) / 114][Stage 353:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:46:07.223 END took 4864 ms: q34 - iteration 1
2023-11-30T18:46:07.223 ================================================================================
2023-11-30T18:46:07.223 ================================================================================
2023-11-30T18:46:07.223 START: q35 - iteration 1
2023-11-30T18:46:07.223 SQL:  select ca_state, cd_gender, cd_marital_status, cd_dep_count, count(*) cnt1, stddev_samp(cd_dep_count), sum(cd_dep_count), min(cd_dep_count), cd_dep_employed_count, count(*) cnt2, stddev_samp(cd_dep_employed_count), sum(cd_dep_employed_count), min(cd_dep_employed_count), cd_dep_college_count, count(*) cnt3, stddev_samp(cd_dep_college_count), sum(cd_dep_college_count), min(cd_dep_college_count) from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4)) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100
23/11/30 18:46:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 360:>(0 + 57) / 57][Stage 361:>(1 + 57) / 58][Stage 363:(0 + 27) / 114][Stage 360:>(0 + 57) / 57][Stage 361:>(1 + 57) / 58][Stage 363:(0 + 28) / 114][Stage 360:(26 + 31) / 57][Stage 361:>(8 + 50) / 58][Stage 363:(15 + 61) / 114][Stage 361:==============>(55 + 3) / 58][Stage 363:==>          (26 + 88) / 114][Stage 363:============>                                        (27 + 87) / 114][Stage 363:=============>                                       (28 + 86) / 114][Stage 363:=======================================>             (84 + 30) / 114][Stage 366:================================>                    (123 + 4) / 200][Stage 366:========================================>            (154 + 4) / 200][Stage 366:================================================>    (183 + 4) / 200]                                                                                2023-11-30T18:46:13.332 END took 6108 ms: q35 - iteration 1
2023-11-30T18:46:13.332 ================================================================================
2023-11-30T18:46:13.332 ================================================================================
2023-11-30T18:46:13.332 START: q36 - iteration 1
2023-11-30T18:46:13.332 SQL:  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent from store_sales ,date_dim       d1 ,item ,store where d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk  = ss_item_sk and s_store_sk  = ss_store_sk and s_state in ('MN','TX','TX','IN', 'CA','LA','NM','TX') group by rollup(i_category,i_class) order by lochierarchy desc ,case when lochierarchy = 0 then i_category end ,rank_within_parent limit 100
23/11/30 18:46:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 371:>                                                    (0 + 114) / 114][Stage 371:===================>                                 (43 + 71) / 114]                                                                                2023-11-30T18:46:15.789 END took 2456 ms: q36 - iteration 1
2023-11-30T18:46:15.789 ================================================================================
2023-11-30T18:46:15.789 ================================================================================
2023-11-30T18:46:15.789 START: q37 - iteration 1
2023-11-30T18:46:15.789 SQL:  select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 16 and 16 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-06-05' as date) and (cast('2002-06-05' as date) + interval 60 days) and i_manufact_id in (841,790,796,739) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100
23/11/30 18:46:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 374:>              (1 + 57) / 58][Stage 377:=>               (1 + 8) / 9][Stage 374:=============> (51 + 7) / 58][Stage 377:=>               (1 + 8) / 9]                                                                                23/11/30 18:46:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 377:============================================>            (7 + 2) / 9]                                                                                2023-11-30T18:46:18.587 END took 2798 ms: q37 - iteration 1
2023-11-30T18:46:18.587 ================================================================================
2023-11-30T18:46:18.587 ================================================================================
2023-11-30T18:46:18.587 START: q38 - iteration 1
2023-11-30T18:46:18.587 SQL:  select  count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 ) hot_cust limit 100
23/11/30 18:46:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 381:>(0 + 57) / 57][Stage 382:>(1 + 57) / 58][Stage 384:(0 + 28) / 114][Stage 381:(16 + 41) / 57][Stage 382:(36 + 22) / 58][Stage 384:(16 + 79) / 114][Stage 381:==============>(56 + 1) / 57][Stage 384:===>         (28 + 86) / 114][Stage 384:=============>                                       (28 + 86) / 114][Stage 383:============>(199 + 1) / 200][Stage 384:===>         (28 + 86) / 114][Stage 383:============>(199 + 1) / 200][Stage 384:========>    (71 + 43) / 114][Stage 383:====================================================>(199 + 1) / 200][Stage 386:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:46:23.264 END took 4676 ms: q38 - iteration 1
2023-11-30T18:46:23.264 ================================================================================
2023-11-30T18:46:23.264 ================================================================================
2023-11-30T18:46:23.264 START: q39a - iteration 1
2023-11-30T18:46:23.264 SQL:  with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =1999 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=3 and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 393:=>               (1 + 8) / 9][Stage 395:=>               (1 + 8) / 9][Stage 393:===>             (2 + 7) / 9][Stage 395:=>               (1 + 8) / 9][Stage 395:==================================================>      (8 + 1) / 9]                                                                                2023-11-30T18:46:27.034 END took 3769 ms: q39a - iteration 1
2023-11-30T18:46:27.034 ================================================================================
2023-11-30T18:46:27.034 ================================================================================
2023-11-30T18:46:27.034 START: q39b - iteration 1
2023-11-30T18:46:27.034 SQL:  with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =1999 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=3 and inv2.d_moy=3+1 and inv1.cov > 1.5 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 408:=>               (1 + 8) / 9][Stage 410:=>               (1 + 8) / 9][Stage 410:==================================================>      (8 + 1) / 9]                                                                                2023-11-30T18:46:30.120 END took 3085 ms: q39b - iteration 1
2023-11-30T18:46:30.120 ================================================================================
2023-11-30T18:46:30.120 ================================================================================
2023-11-30T18:46:30.120 START: q4 - iteration 1
2023-11-30T18:46:30.120 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total ,'c' sale_type from customer ,catalog_sales ,date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_c_firstyear ,year_total t_c_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = 's' and t_c_firstyear.sale_type = 'c' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_c_secyear.sale_type = 'c' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear =  1999 and t_s_secyear.dyear = 1999+1 and t_c_firstyear.dyear =  1999 and t_c_secyear.dyear =  1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total > 0 and t_c_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country limit 100
23/11/30 18:46:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 422:(0 + 114) / 114][Stage 425:>(0 + 29) / 58][Stage 428:> (0 + 0) / 57][Stage 422:(97 + 17) / 114][Stage 425:(20 + 38) / 58][Stage 428:>(0 + 57) / 57][Stage 422:(113 + 1) / 114][Stage 425:(30 + 28) / 58][Stage 428:>(0 + 57) / 57][Stage 422:(113 + 1) / 114][Stage 425:(44 + 14) / 58][Stage 428:(15 + 42) / 57][Stage 422:============>(113 + 1) / 114][Stage 428:==============>(54 + 3) / 57][Stage 422:====================================================>(113 + 1) / 114][Stage 422:(113 + 1) / 114][Stage 426:(103 + 11) / 200][Stage 429:>(0 + 0) / 200][Stage 422:(113 + 1) / 114][Stage 426:(154 + 12) / 200][Stage 429:>(0 + 0) / 200][Stage 429:>(0 + 0) / 200][Stage 431:>(0 + 0) / 200][Stage 433:>(0 + 0) / 200][Stage 423:(114 + 11) / 200][Stage 427:(199 + 1) / 200][Stage 429:>(0 + 0) / 200][Stage 423:(155 + 11) / 200][Stage 427:(199 + 1) / 200][Stage 429:>(0 + 0) / 200][Stage 423:(189 + 11) / 200][Stage 427:(199 + 1) / 200][Stage 429:>(0 + 0) / 200][Stage 429:(12 + 9) / 200][Stage 431:>(0 + 0) / 200][Stage 433:>(0 + 0) / 200][Stage 429:(79 + 11) / 200][Stage 431:>(0 + 0) / 200][Stage 433:>(0 + 0) / 200][Stage 429:(148 + 11) / 200][Stage 431:>(0 + 0) / 200][Stage 433:>(0 + 0) / 200][Stage 431:(0 + 11) / 200][Stage 433:>(0 + 0) / 200][Stage 435:>(0 + 0) / 200][Stage 431:(41 + 11) / 200][Stage 433:(0 + 133) / 200][Stage 435:>(0 + 0) / 200][Stage 431:(113 + 87) / 200][Stage 433:(100 + 41) / 200][Stage 435:>(0 + 0) / 200][Stage 433:==========>  (159 + 5) / 200][Stage 435:>              (0 + 0) / 200][Stage 433:============>(199 + 1) / 200][Stage 435:>             (0 + 10) / 200][Stage 435:===>                                                 (13 + 11) / 200][Stage 435:============>                                       (49 + 144) / 200][Stage 435:====================================================>(197 + 3) / 200][Stage 437:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:46:41.996 END took 11876 ms: q4 - iteration 1
2023-11-30T18:46:41.996 ================================================================================
2023-11-30T18:46:41.996 ================================================================================
2023-11-30T18:46:41.996 START: q40 - iteration 1
2023-11-30T18:46:41.996 SQL:  select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-04-27' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('1999-04-27' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = cs_item_sk and cs_warehouse_sk    = w_warehouse_sk and cs_sold_date_sk    = d_date_sk and d_date between (cast ('1999-04-27' as date) - INTERVAL 30 days) and (cast ('1999-04-27' as date) + INTERVAL 30 days) group by w_state,i_item_id order by w_state,i_item_id limit 100
23/11/30 18:46:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 440:>                                                      (1 + 64) / 65][Stage 440:============================>                         (34 + 31) / 65][Stage 440:======================================================>(64 + 1) / 65]                                                                                23/11/30 18:46:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 442:>                                                      (0 + 58) / 58][Stage 442:=============>                                        (14 + 44) / 58][Stage 442:=====================================================> (56 + 2) / 58][Stage 442:======================================================>(57 + 1) / 58][Stage 443:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:46:51.266 END took 9270 ms: q40 - iteration 1
2023-11-30T18:46:51.266 ================================================================================
2023-11-30T18:46:51.266 ================================================================================
2023-11-30T18:46:51.266 START: q41 - iteration 1
2023-11-30T18:46:51.266 SQL:  select  distinct(i_product_name) from item i1 where i_manufact_id between 841 and 841+40 and (select count(*) as item_cnt from item where (i_manufact = i1.i_manufact and ((i_category = 'Women' and (i_color = 'bisque' or i_color = 'khaki') and (i_units = 'Carton' or i_units = 'Box') and (i_size = 'large' or i_size = 'extra large') ) or (i_category = 'Women' and (i_color = 'antique' or i_color = 'sandy') and (i_units = 'Pallet' or i_units = 'Cup') and (i_size = 'petite' or i_size = 'small') ) or (i_category = 'Men' and (i_color = 'forest' or i_color = 'brown') and (i_units = 'Dram' or i_units = 'Ton') and (i_size = 'economy' or i_size = 'medium') ) or (i_category = 'Men' and (i_color = 'chartreuse' or i_color = 'light') and (i_units = 'Pound' or i_units = 'Dozen') and (i_size = 'large' or i_size = 'extra large') ))) or (i_manufact = i1.i_manufact and ((i_category = 'Women' and (i_color = 'turquoise' or i_color = 'chocolate') and (i_units = 'Bundle' or i_units = 'Unknown') and (i_size = 'large' or i_size = 'extra large') ) or (i_category = 'Women' and (i_color = 'maroon' or i_color = 'pale') and (i_units = 'Each' or i_units = 'Tbl') and (i_size = 'petite' or i_size = 'small') ) or (i_category = 'Men' and (i_color = 'almond' or i_color = 'floral') and (i_units = 'Gross' or i_units = 'N/A') and (i_size = 'economy' or i_size = 'medium') ) or (i_category = 'Men' and (i_color = 'drab' or i_color = 'plum') and (i_units = 'Bunch' or i_units = 'Case') and (i_size = 'large' or i_size = 'extra large') )))) > 0 order by i_product_name limit 100
23/11/30 18:46:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:46:51.820 END took 553 ms: q41 - iteration 1
2023-11-30T18:46:51.820 ================================================================================
2023-11-30T18:46:51.820 ================================================================================
2023-11-30T18:46:51.820 START: q42 - iteration 1
2023-11-30T18:46:51.820 SQL:  select  dt.d_year ,item.i_category_id ,item.i_category ,sum(ss_ext_sales_price) from 	date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=2002 group by 	dt.d_year ,item.i_category_id ,item.i_category order by       sum(ss_ext_sales_price) desc,dt.d_year ,item.i_category_id ,item.i_category limit 100 
23/11/30 18:46:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 448:>                                                    (0 + 114) / 114][Stage 448:======================================>              (82 + 32) / 114][Stage 448:==================================================>  (109 + 5) / 114][Stage 448:====================================================>(112 + 2) / 114][Stage 448:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:46:57.554 END took 5733 ms: q42 - iteration 1
2023-11-30T18:46:57.554 ================================================================================
2023-11-30T18:46:57.554 ================================================================================
2023-11-30T18:46:57.554 START: q43 - iteration 1
2023-11-30T18:46:57.554 SQL:  select  s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from date_dim, store_sales, store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -5 and d_year = 2002 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales limit 100
23/11/30 18:46:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:46:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:46:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 452:>                                                    (0 + 114) / 114][Stage 452:====>                                               (10 + 104) / 114][Stage 452:==================================================>  (108 + 6) / 114]                                                                                2023-11-30T18:47:00.067 END took 2512 ms: q43 - iteration 1
2023-11-30T18:47:00.067 ================================================================================
2023-11-30T18:47:00.067 ================================================================================
2023-11-30T18:47:00.067 START: q44 - iteration 1
2023-11-30T18:47:00.067 SQL:  select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select * from (select item_sk,rank() over (order by rank_col asc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 709 group by ss_item_sk having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 709 and ss_addr_sk is null group by ss_store_sk))V1)V11 where rnk  < 11) asceding, (select * from (select item_sk,rank() over (order by rank_col desc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 709 group by ss_item_sk having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 709 and ss_addr_sk is null group by ss_store_sk))V2)V21 where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk and i1.i_item_sk=asceding.item_sk and i2.i_item_sk=descending.item_sk order by asceding.rnk limit 100
23/11/30 18:47:00 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:00 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:47:01.699 END took 1631 ms: q44 - iteration 1
2023-11-30T18:47:01.699 ================================================================================
2023-11-30T18:47:01.699 ================================================================================
2023-11-30T18:47:01.699 START: q45 - iteration 1
2023-11-30T18:47:01.699 SQL:  select  ca_zip, ca_state, sum(ws_sales_price) from web_sales, customer, customer_address, date_dim, item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 2002 group by ca_zip, ca_state order by ca_zip, ca_state limit 100
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 477:>                                                      (0 + 57) / 57][Stage 477:====>                                                  (5 + 52) / 57][Stage 477:================================================>      (50 + 7) / 57][Stage 477:=====================================================> (55 + 2) / 57][Stage 477:======================================================>(56 + 1) / 57]                                                                                2023-11-30T18:47:06.682 END took 4982 ms: q45 - iteration 1
2023-11-30T18:47:06.682 ================================================================================
2023-11-30T18:47:06.682 ================================================================================
2023-11-30T18:47:06.682 START: q46 - iteration 1
2023-11-30T18:47:06.682 SQL:  select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,amt,profit from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count= 1) and date_dim.d_dow in (6,0) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in ('Johnson','Norwood','Cambridge','Klondike','Rock Hill') group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number limit 100
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 484:>                                                    (0 + 114) / 114][Stage 484:================================================>    (105 + 9) / 114]                                                                                2023-11-30T18:47:09.406 END took 2723 ms: q46 - iteration 1
2023-11-30T18:47:09.406 ================================================================================
2023-11-30T18:47:09.406 ================================================================================
2023-11-30T18:47:09.406 START: q47 - iteration 1
2023-11-30T18:47:09.406 SQL:  with v1 as( select i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, s_store_name, s_company_name order by d_year, d_moy) rn from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ( d_year = 2001 or ( d_year = 2001-1 and d_moy =12) or ( d_year = 2001+1 and d_moy =1) ) group by i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 as( select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name ,v1.d_year, v1.d_moy ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1.s_store_name = v1_lag.s_store_name and v1.s_store_name = v1_lead.s_store_name and v1.s_company_name = v1_lag.s_company_name and v1.s_company_name = v1_lead.s_company_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 2001 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales, psum limit 100
23/11/30 18:47:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 489:>                                                    (0 + 114) / 114][Stage 489:===========================>                         (59 + 55) / 114][Stage 489:====================================================>(112 + 2) / 114][Stage 494:====================================================>(198 + 2) / 200]                                                                                2023-11-30T18:47:14.166 END took 4759 ms: q47 - iteration 1
2023-11-30T18:47:14.166 ================================================================================
2023-11-30T18:47:14.166 ================================================================================
2023-11-30T18:47:14.166 START: q48 - iteration 1
2023-11-30T18:47:14.166 SQL:  select sum (ss_quantity) from store_sales, store, customer_demographics, customer_address, date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2000 and ( ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 ) ) and ( ( ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'OH', 'GA') and ss_net_profit between 0 and 2000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('WV', 'AZ', 'NM') and ss_net_profit between 150 and 3000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'PA', 'KY') and ss_net_profit between 50 and 25000 ) )
23/11/30 18:47:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 501:>                                                    (0 + 114) / 114][Stage 501:=================>                                   (38 + 76) / 114][Stage 501:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:47:16.924 END took 2758 ms: q48 - iteration 1
2023-11-30T18:47:16.924 ================================================================================
2023-11-30T18:47:16.924 ================================================================================
2023-11-30T18:47:16.924 START: q49 - iteration 1
2023-11-30T18:47:16.925 SQL:  select  channel, item, return_ratio, return_rank, currency_rank from (select 'web' as channel ,web.item ,web.return_ratio ,web.return_rank ,web.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select ws.ws_item_sk as item ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio from web_sales ws left outer join web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk) ,date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel ,catalog.item ,catalog.return_ratio ,catalog.return_rank ,catalog.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select cs.cs_item_sk as item ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio from catalog_sales cs left outer join catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk) ,date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel ,store.item ,store.return_ratio ,store.return_rank ,store.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select sts.ss_item_sk as item ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio from store_sales sts left outer join store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk) ,date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where  ( store.return_rank <= 10 or store.currency_rank <= 10 ) ) order by 1,4,5,2 limit 100
23/11/30 18:47:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:47:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 504:>(1 + 16) / 17][Stage 505:>(1 + 27) / 28][Stage 506:>(0 + 14) / 14][Stage 504:>(1 + 16) / 17][Stage 505:>(1 + 27) / 28][Stage 506:>(1 + 13) / 14][Stage 504:>(1 + 16) / 17][Stage 505:>(1 + 27) / 28][Stage 506:=>(8 + 6) / 14][Stage 504:>(7 + 10) / 17][Stage 505:>(19 + 9) / 28][Stage 506:>(13 + 1) / 14]                                                                                23/11/30 18:47:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 508:(0 + 34) / 114][Stage 509:>(1 + 57) / 58][Stage 510:>(0 + 57) / 57][Stage 508:(19 + 71) / 114][Stage 509:(15 + 43) / 58][Stage 510:(23 + 34) / 57][Stage 508:===>         (33 + 81) / 114][Stage 509:==============>(55 + 3) / 58][Stage 508:===============>                                     (34 + 80) / 114][Stage 508:============================================>        (95 + 19) / 114]                                                                                2023-11-30T18:47:23.498 END took 6573 ms: q49 - iteration 1
2023-11-30T18:47:23.498 ================================================================================
2023-11-30T18:47:23.498 ================================================================================
2023-11-30T18:47:23.498 START: q5 - iteration 1
2023-11-30T18:47:23.498 SQL:  with ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ss_store_sk as store_sk, ss_sold_date_sk  as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  cs_catalog_page_sk as page_sk, cs_sold_date_sk  as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk  as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and wsr_web_site_sk = web_site_sk group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from   ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from  csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 519:>                                                      (1 + 66) / 67][Stage 519:==============>                                       (18 + 49) / 67][Stage 519:===================================================>   (63 + 4) / 67]                                                                                23/11/30 18:47:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 521:(0 + 148) / 177][Stage 522:>(0 + 0) / 123][Stage 523:>(0 + 0) / 114][Stage 521:(22 + 148) / 177][Stage 522:>(0 + 0) / 123][Stage 523:>(0 + 0) / 114][Stage 521:(135 + 42) / 177][Stage 522:(0 + 106) / 123][Stage 523:>(0 + 0) / 114][Stage 521:(148 + 29) / 177][Stage 522:(1 + 119) / 123][Stage 523:>(0 + 0) / 114][Stage 521:(149 + 28) / 177][Stage 522:(1 + 120) / 123][Stage 523:>(0 + 0) / 114][Stage 521:(155 + 22) / 177][Stage 522:(1 + 122) / 123][Stage 523:>(0 + 4) / 114][Stage 521:(176 + 1) / 177][Stage 522:(50 + 73) / 123][Stage 523:(0 + 74) / 114][Stage 522:========>    (83 + 40) / 123][Stage 523:>            (0 + 108) / 114][Stage 522:============>(117 + 6) / 123][Stage 523:>            (0 + 114) / 114][Stage 522:============>(121 + 2) / 123][Stage 523:>            (0 + 114) / 114][Stage 522:============>(122 + 1) / 123][Stage 523:>            (1 + 113) / 114][Stage 523:========================>                            (52 + 62) / 114][Stage 523:===========================================>         (94 + 20) / 114][Stage 523:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:47:31.751 END took 8253 ms: q5 - iteration 1
2023-11-30T18:47:31.751 ================================================================================
2023-11-30T18:47:31.751 ================================================================================
2023-11-30T18:47:31.751 START: q50 - iteration 1
2023-11-30T18:47:31.751 SQL:  select s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from store_sales ,store_returns ,store ,date_dim d1 ,date_dim d2 where d2.d_year = 2000 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip order by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip limit 100
23/11/30 18:47:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 527:>                                                      (0 + 63) / 63][Stage 527:>                                                      (1 + 62) / 63][Stage 527:================>                                     (19 + 44) / 63]                                                                                23/11/30 18:47:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 530:>                                                    (0 + 114) / 114][Stage 530:========================================>            (88 + 26) / 114][Stage 530:====================================================>(112 + 2) / 114][Stage 530:====================================================>(113 + 1) / 114][Stage 531:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:47:40.103 END took 8351 ms: q50 - iteration 1
2023-11-30T18:47:40.103 ================================================================================
2023-11-30T18:47:40.103 ================================================================================
2023-11-30T18:47:40.103 START: q51 - iteration 1
2023-11-30T18:47:40.103 SQL:  WITH web_v1 as ( select ws_item_sk item_sk, d_date, sum(sum(ws_sales_price)) over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales ,date_dim where ws_sold_date_sk=d_date_sk and d_month_seq between 1177 and 1177+11 and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select ss_item_sk item_sk, d_date, sum(sum(ss_sales_price)) over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales ,date_dim where ss_sold_date_sk=d_date_sk and d_month_seq between 1177 and 1177+11 and ss_item_sk is not NULL group by ss_item_sk, d_date) select  * from (select item_sk ,d_date ,web_sales ,store_sales ,max(web_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative ,max(store_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk ,case when web.d_date is not null then web.d_date else store.d_date end d_date ,web.cume_sales web_sales ,store.cume_sales store_sales from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk and web.d_date = store.d_date) )x )y where web_cumulative > store_cumulative order by item_sk ,d_date limit 100
23/11/30 18:47:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 533:>              (0 + 36) / 57][Stage 535:>            (0 + 114) / 114][Stage 533:=>             (5 + 52) / 57][Stage 535:=======>     (65 + 49) / 114][Stage 533:========>     (35 + 22) / 57][Stage 535:============>(113 + 1) / 114][Stage 533:========>     (36 + 21) / 57][Stage 535:============>(113 + 1) / 114][Stage 533:==============>(54 + 3) / 57][Stage 535:============>(113 + 1) / 114][Stage 535:====================================================>(113 + 1) / 114][Stage 537:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:47:47.080 END took 6976 ms: q51 - iteration 1
2023-11-30T18:47:47.080 ================================================================================
2023-11-30T18:47:47.080 ================================================================================
2023-11-30T18:47:47.080 START: q52 - iteration 1
2023-11-30T18:47:47.080 SQL:  select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_ext_sales_price) ext_price from date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=2001 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,ext_price desc ,brand_id limit 100 
23/11/30 18:47:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 543:>                                                    (0 + 114) / 114][Stage 543:===============================================>    (104 + 10) / 114][Stage 543:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:47:51.097 END took 4016 ms: q52 - iteration 1
2023-11-30T18:47:51.097 ================================================================================
2023-11-30T18:47:51.097 ================================================================================
2023-11-30T18:47:51.097 START: q53 - iteration 1
2023-11-30T18:47:51.097 SQL:  select  * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id limit 100
23/11/30 18:47:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 548:>                                                    (0 + 114) / 114][Stage 548:==>                                                  (6 + 108) / 114][Stage 548:==================>                                  (39 + 75) / 114][Stage 548:========================================>            (88 + 26) / 114][Stage 548:===================================================> (111 + 3) / 114]                                                                                2023-11-30T18:47:54.304 END took 3206 ms: q53 - iteration 1
2023-11-30T18:47:54.304 ================================================================================
2023-11-30T18:47:54.304 ================================================================================
2023-11-30T18:47:54.304 START: q54 - iteration 1
2023-11-30T18:47:54.304 SQL:  with my_customers as ( select distinct c_customer_sk , c_current_addr_sk from ( select cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk from   catalog_sales union all select ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk from   web_sales ) cs_or_ws_sales, item, date_dim, customer where   sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'pants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 2002 ) , my_revenue as ( select c_customer_sk, sum(ss_ext_sales_price) as revenue from   my_customers, store_sales, customer_address, store, date_dim where  c_current_addr_sk = ca_address_sk and ca_county = s_county and ca_state = s_state and ss_sold_date_sk = d_date_sk and c_customer_sk = ss_customer_sk and d_month_seq between (select distinct d_month_seq+1 from   date_dim where d_year = 2002 and d_moy = 5) and  (select distinct d_month_seq+3 from   date_dim where d_year = 2002 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from   my_revenue ) select  segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 559:>            (1 + 114) / 115][Stage 561:>             (0 + 37) / 114][Stage 559:==========> (102 + 13) / 115][Stage 561:===>         (35 + 79) / 114][Stage 561:=================>                                   (37 + 77) / 114][Stage 561:======================>                              (49 + 65) / 114]                                                                                2023-11-30T18:47:59.011 END took 4707 ms: q54 - iteration 1
2023-11-30T18:47:59.012 ================================================================================
2023-11-30T18:47:59.012 ================================================================================
2023-11-30T18:47:59.012 START: q55 - iteration 1
2023-11-30T18:47:59.012 SQL:  select  i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=67 and d_moy=11 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 
23/11/30 18:47:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:47:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:47:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 566:>                                                    (0 + 114) / 114][Stage 566:============================================>        (95 + 19) / 114]                                                                                2023-11-30T18:48:01.111 END took 2099 ms: q55 - iteration 1
2023-11-30T18:48:01.112 ================================================================================
2023-11-30T18:48:01.112 ================================================================================
2023-11-30T18:48:01.112 START: q56 - iteration 1
2023-11-30T18:48:01.112 SQL:  with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id) select  i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales, i_item_id limit 100
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 572:>(1 + 57) / 58][Stage 573:(0 + 94) / 114][Stage 574:> (0 + 0) / 57][Stage 572:>(3 + 55) / 58][Stage 573:(0 + 96) / 114][Stage 574:> (0 + 0) / 57][Stage 572:(10 + 48) / 58][Stage 573:(7 + 104) / 114][Stage 574:> (0 + 0) / 57][Stage 573:==========>  (94 + 20) / 114][Stage 574:>              (0 + 57) / 57][Stage 573:===========> (99 + 15) / 114][Stage 574:>              (0 + 57) / 57][Stage 573:==========> (104 + 10) / 114][Stage 574:>              (0 + 57) / 57][Stage 573:============>(113 + 1) / 114][Stage 574:>              (0 + 57) / 57][Stage 574:===================================================>   (53 + 4) / 57]                                                                                2023-11-30T18:48:05.831 END took 4719 ms: q56 - iteration 1
2023-11-30T18:48:05.831 ================================================================================
2023-11-30T18:48:05.831 ================================================================================
2023-11-30T18:48:05.831 START: q57 - iteration 1
2023-11-30T18:48:05.831 SQL:  with v1 as( select i_category, i_brand, cc_name, d_year, d_moy, sum(cs_sales_price) sum_sales, avg(sum(cs_sales_price)) over (partition by i_category, i_brand, cc_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, cc_name order by d_year, d_moy) rn from item, catalog_sales, date_dim, call_center where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and cc_call_center_sk= cs_call_center_sk and ( d_year = 2000 or ( d_year = 2000-1 and d_moy =12) or ( d_year = 2000+1 and d_moy =1) ) group by i_category, i_brand, cc_name , d_year, d_moy), v2 as( select v1.i_category, v1.i_brand ,v1.d_year ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1. cc_name = v1_lag. cc_name and v1. cc_name = v1_lead. cc_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 2000 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales, sum_sales limit 100
23/11/30 18:48:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 580:>                                                      (1 + 57) / 58][Stage 580:==========================================>           (46 + 12) / 58][Stage 580:======================================================>(57 + 1) / 58]                                                                                2023-11-30T18:48:13.668 END took 7836 ms: q57 - iteration 1
2023-11-30T18:48:13.668 ================================================================================
2023-11-30T18:48:13.668 ================================================================================
2023-11-30T18:48:13.668 START: q58 - iteration 1
2023-11-30T18:48:13.668 SQL:  with ss_items as (select i_item_id item_id ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '2000-05-24')) and ss_sold_date_sk   = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '2000-05-24')) and  cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq =(select d_week_seq from date_dim where d_date = '2000-05-24')) and ws_sold_date_sk   = d_date_sk group by i_item_id) select  ss_items.item_id ,ss_item_rev ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev ,cs_item_rev ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev ,ws_item_rev ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id ,ss_item_rev limit 100
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 596:(0 + 114) / 114][Stage 597:>(0 + 38) / 57][Stage 598:> (0 + 0) / 58][Stage 596:(54 + 60) / 114][Stage 597:>(5 + 52) / 57][Stage 598:>(0 + 40) / 58][Stage 596:(113 + 1) / 114][Stage 597:(37 + 20) / 57][Stage 598:>(0 + 58) / 58][Stage 597:=========>    (38 + 19) / 57][Stage 598:>              (1 + 57) / 58][Stage 597:=============> (52 + 5) / 57][Stage 598:=====>        (22 + 36) / 58]                                                                                2023-11-30T18:48:18.130 END took 4461 ms: q58 - iteration 1
2023-11-30T18:48:18.130 ================================================================================
2023-11-30T18:48:18.130 ================================================================================
2023-11-30T18:48:18.130 START: q59 - iteration 1
2023-11-30T18:48:18.130 SQL:  with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select  s_store_name1,s_store_id1,d_week_seq1 ,sun_sales1/sun_sales2,mon_sales1/mon_sales2 ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2 ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1 ,s_store_id s_store_id1,sun_sales sun_sales1 ,mon_sales mon_sales1,tue_sales tue_sales1 ,wed_sales wed_sales1,thu_sales thu_sales1 ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1197 and 1197 + 11) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2 ,s_store_id s_store_id2,sun_sales sun_sales2 ,mon_sales mon_sales2,tue_sales tue_sales2 ,wed_sales wed_sales2,thu_sales thu_sales2 ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1197+ 12 and 1197 + 23) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 605:>                                                    (0 + 114) / 114][Stage 605:===========>                                         (25 + 89) / 114]                                                                                2023-11-30T18:48:20.955 END took 2824 ms: q59 - iteration 1
2023-11-30T18:48:20.955 ================================================================================
2023-11-30T18:48:20.955 ================================================================================
2023-11-30T18:48:20.955 START: q6 - iteration 1
2023-11-30T18:48:20.955 SQL:  select  a.ca_state state, count(*) cnt from customer_address a ,customer c ,store_sales s ,date_dim d ,item i where       a.ca_address_sk = c.c_current_addr_sk and c.c_customer_sk = s.ss_customer_sk and s.ss_sold_date_sk = d.d_date_sk and s.ss_item_sk = i.i_item_sk and d.d_month_seq = (select distinct (d_month_seq) from date_dim where d_year = 2002 and d_moy = 3 ) and i.i_current_price > 1.2 * (select avg(j.i_current_price) from item j where j.i_category = i.i_category) group by a.ca_state having count(*) >= 10 order by cnt, a.ca_state limit 100
23/11/30 18:48:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 614:>                                                    (0 + 114) / 114][Stage 614:==========================>                          (58 + 56) / 114][Stage 616:================================================>   (187 + 11) / 200]                                                                                2023-11-30T18:48:24.373 END took 3417 ms: q6 - iteration 1
2023-11-30T18:48:24.373 ================================================================================
2023-11-30T18:48:24.373 ================================================================================
2023-11-30T18:48:24.373 START: q60 - iteration 1
2023-11-30T18:48:24.373 SQL:  with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_category in ('Shoes')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in ('Shoes')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in ('Shoes')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by i_item_id ,total_sales limit 100
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 623:>            (0 + 114) / 114][Stage 624:>              (0 + 38) / 57][Stage 623:(0 + 114) / 114][Stage 624:>(0 + 38) / 57][Stage 625:> (0 + 0) / 58][Stage 623:(99 + 15) / 114][Stage 624:(22 + 35) / 57][Stage 625:>(0 + 58) / 58][Stage 624:=========>    (38 + 19) / 57][Stage 625:>              (0 + 58) / 58][Stage 624:=========>    (38 + 19) / 57][Stage 625:>              (1 + 57) / 58][Stage 625:==========================================>           (46 + 12) / 58]                                                                                2023-11-30T18:48:28.531 END took 4158 ms: q60 - iteration 1
2023-11-30T18:48:28.531 ================================================================================
2023-11-30T18:48:28.531 ================================================================================
2023-11-30T18:48:28.531 START: q61 - iteration 1
2023-11-30T18:48:28.531 SQL:  select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from  store_sales ,store ,promotion ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_promo_sk = p_promo_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -7 and   i_category = 'Jewelry' and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and   s_gmt_offset = -7 and   d_year = 2002 and   d_moy  = 11) promotional_sales, (select sum(ss_ext_sales_price) total from  store_sales ,store ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -7 and   i_category = 'Jewelry' and   s_gmt_offset = -7 and   d_year = 2002 and   d_moy  = 11) all_sales order by promotions, total limit 100
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 633:>                                                    (0 + 114) / 114][Stage 633:=============================================>      (100 + 14) / 114]                                                                                [Stage 635:>                                                    (0 + 114) / 114][Stage 635:============================================>        (96 + 18) / 114]                                                                                2023-11-30T18:48:32.439 END took 3907 ms: q61 - iteration 1
2023-11-30T18:48:32.439 ================================================================================
2023-11-30T18:48:32.439 ================================================================================
2023-11-30T18:48:32.439 START: q62 - iteration 1
2023-11-30T18:48:32.439 SQL:  select substr(w_warehouse_name,1,20) ,sm_type ,web_name ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from web_sales ,warehouse ,ship_mode ,web_site ,date_dim where d_month_seq between 1194 and 1194 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by substr(w_warehouse_name,1,20) ,sm_type ,web_name order by substr(w_warehouse_name,1,20) ,sm_type ,web_name limit 100
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 641:>                                                      (0 + 57) / 57][Stage 641:===============================>                      (33 + 24) / 57]                                                                                2023-11-30T18:48:35.121 END took 2682 ms: q62 - iteration 1
2023-11-30T18:48:35.121 ================================================================================
2023-11-30T18:48:35.121 ================================================================================
2023-11-30T18:48:35.121 START: q63 - iteration 1
2023-11-30T18:48:35.121 SQL:  select  * from (select i_manager_id ,sum(ss_sales_price) sum_sales ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from item ,store_sales ,date_dim ,store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1222,1222+1,1222+2,1222+3,1222+4,1222+5,1222+6,1222+7,1222+8,1222+9,1222+10,1222+11) and ((    i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(    i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id ,avg_monthly_sales ,sum_sales limit 100
23/11/30 18:48:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 646:>                                                    (0 + 114) / 114][Stage 646:=========================>                           (55 + 59) / 114]                                                                                2023-11-30T18:48:37.437 END took 2315 ms: q63 - iteration 1
2023-11-30T18:48:37.437 ================================================================================
2023-11-30T18:48:37.437 ================================================================================
2023-11-30T18:48:37.437 START: q64 - iteration 1
2023-11-30T18:48:37.437 SQL:  with cs_ui as (select cs_item_sk ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM   store_sales ,store_returns ,cs_ui ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,customer ,customer_demographics cd1 ,customer_demographics cd2 ,promotion ,household_demographics hd1 ,household_demographics hd2 ,customer_address ad1 ,customer_address ad2 ,income_band ib1 ,income_band ib2 ,item WHERE  ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_color in ('ivory','purple','almond','bisque','lawn','azure') and i_current_price between 60 and 60 + 10 and i_current_price between 60 + 1 and 60 + 15 group by i_product_name ,i_item_sk ,s_store_name ,s_zip ,ad1.ca_street_number ,ad1.ca_street_name ,ad1.ca_city ,ad1.ca_zip ,ad2.ca_street_number ,ad2.ca_street_name ,ad2.ca_city ,ad2.ca_zip ,d1.d_year ,d2.d_year ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name ,cs1.store_name ,cs2.cnt ,cs1.s1 ,cs2.s1
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 656:>              (0 + 63) / 63][Stage 657:>              (1 + 64) / 65][Stage 656:>              (1 + 62) / 63][Stage 657:>              (1 + 64) / 65][Stage 656:========>     (36 + 27) / 63][Stage 657:>              (1 + 64) / 65]                                                                                23/11/30 18:48:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 661:(0 + 114) / 114][Stage 662:>(0 + 37) / 58][Stage 664:>  (0 + 1) / 1][Stage 661:>            (0 + 114) / 114][Stage 662:>              (0 + 38) / 58][Stage 661:==>          (26 + 88) / 114][Stage 662:=>             (4 + 54) / 58][Stage 661:============>(109 + 5) / 114][Stage 662:========>     (35 + 23) / 58][Stage 662:====================================>                 (39 + 19) / 58][Stage 662:========================================>             (43 + 15) / 58][Stage 665:=========================>                            (96 + 9) / 200][Stage 665:=========>   (144 + 9) / 200][Stage 669:>              (0 + 0) / 200][Stage 665:============>(186 + 9) / 200][Stage 669:>              (0 + 0) / 200][Stage 669:==>                                                    (9 + 0) / 200][Stage 666:======>       (97 + 9) / 200][Stage 669:>              (9 + 0) / 200][Stage 666:============>(186 + 9) / 200][Stage 669:>              (9 + 0) / 200][Stage 669:========>                                             (30 + 9) / 200][Stage 669:========================>                             (91 + 9) / 200][Stage 669:=========================================>           (156 + 9) / 200]                                                                                2023-11-30T18:48:49.716 END took 12279 ms: q64 - iteration 1
2023-11-30T18:48:49.716 ================================================================================
2023-11-30T18:48:49.716 ================================================================================
2023-11-30T18:48:49.717 START: q65 - iteration 1
2023-11-30T18:48:49.717 SQL:  select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc limit 100
23/11/30 18:48:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 689:>            (0 + 114) / 114][Stage 691:>             (0 + 39) / 114][Stage 689:==========>  (96 + 18) / 114][Stage 691:===>         (31 + 83) / 114][Stage 689:============>(113 + 1) / 114][Stage 691:====>        (39 + 75) / 114][Stage 689:============>(113 + 1) / 114][Stage 691:====>        (41 + 73) / 114][Stage 689:====================================================>(113 + 1) / 114][Stage 690:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:48:56.673 END took 6956 ms: q65 - iteration 1
2023-11-30T18:48:56.673 ================================================================================
2023-11-30T18:48:56.673 ================================================================================
2023-11-30T18:48:56.673 START: q66 - iteration 1
2023-11-30T18:48:56.673 SQL:  select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year ,sum(jan_sales) as jan_sales ,sum(feb_sales) as feb_sales ,sum(mar_sales) as mar_sales ,sum(apr_sales) as apr_sales ,sum(may_sales) as may_sales ,sum(jun_sales) as jun_sales ,sum(jul_sales) as jul_sales ,sum(aug_sales) as aug_sales ,sum(sep_sales) as sep_sales ,sum(oct_sales) as oct_sales ,sum(nov_sales) as nov_sales ,sum(dec_sales) as dec_sales ,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot ,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot ,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot ,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot ,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot ,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot ,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot ,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot ,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot ,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot ,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot ,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot ,sum(jan_net) as jan_net ,sum(feb_net) as feb_net ,sum(mar_net) as mar_net ,sum(apr_net) as apr_net ,sum(may_net) as may_net ,sum(jun_net) as jun_net ,sum(jul_net) as jul_net ,sum(aug_net) as aug_net ,sum(sep_net) as sep_net ,sum(oct_net) as oct_net ,sum(nov_net) as nov_net ,sum(dec_net) as dec_net from ( select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,'FEDEX' || ',' || 'MSC' as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then ws_ext_list_price* ws_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then ws_ext_list_price* ws_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then ws_ext_list_price* ws_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then ws_ext_list_price* ws_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then ws_ext_list_price* ws_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then ws_ext_list_price* ws_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then ws_ext_list_price* ws_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then ws_ext_list_price* ws_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then ws_ext_list_price* ws_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then ws_ext_list_price* ws_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then ws_ext_list_price* ws_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then ws_ext_list_price* ws_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then ws_net_profit * ws_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then ws_net_profit * ws_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then ws_net_profit * ws_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then ws_net_profit * ws_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then ws_net_profit * ws_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then ws_net_profit * ws_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then ws_net_profit * ws_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then ws_net_profit * ws_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then ws_net_profit * ws_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then ws_net_profit * ws_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then ws_net_profit * ws_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then ws_net_profit * ws_quantity else 0 end) as dec_net from web_sales ,warehouse ,date_dim ,time_dim ,ship_mode where ws_warehouse_sk =  w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2002 and t_time between 2662 and 2662+28800 and sm_carrier in ('FEDEX','MSC') group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year union all select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,'FEDEX' || ',' || 'MSC' as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then cs_ext_list_price* cs_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then cs_ext_list_price* cs_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then cs_ext_list_price* cs_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then cs_ext_list_price* cs_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then cs_ext_list_price* cs_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then cs_ext_list_price* cs_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then cs_ext_list_price* cs_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then cs_ext_list_price* cs_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then cs_ext_list_price* cs_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then cs_ext_list_price* cs_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then cs_ext_list_price* cs_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then cs_ext_list_price* cs_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then cs_net_profit * cs_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then cs_net_profit * cs_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then cs_net_profit * cs_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then cs_net_profit * cs_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then cs_net_profit * cs_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then cs_net_profit * cs_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then cs_net_profit * cs_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then cs_net_profit * cs_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then cs_net_profit * cs_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then cs_net_profit * cs_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then cs_net_profit * cs_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then cs_net_profit * cs_quantity else 0 end) as dec_net from catalog_sales ,warehouse ,date_dim ,time_dim ,ship_mode where cs_warehouse_sk =  w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2002 and t_time between 2662 AND 2662+28800 and sm_carrier in ('FEDEX','MSC') group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year ) x group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year order by w_warehouse_name limit 100
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:48:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 698:>              (1 + 57) / 58][Stage 699:>              (0 + 57) / 57][Stage 698:===========>  (47 + 11) / 58][Stage 699:===========>  (47 + 10) / 57][Stage 698:==============>(57 + 1) / 58][Stage 699:==============>(56 + 1) / 57][Stage 698:======================================================>(57 + 1) / 58]                                                                                2023-11-30T18:49:02.681 END took 6007 ms: q66 - iteration 1
2023-11-30T18:49:02.682 ================================================================================
2023-11-30T18:49:02.682 ================================================================================
2023-11-30T18:49:02.682 START: q67 - iteration 1
2023-11-30T18:49:02.682 SQL:  select  * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1177 and 1177+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100
23/11/30 18:49:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 705:>                                                    (0 + 114) / 114][Stage 705:========>                                            (19 + 95) / 114][Stage 705:=============================================>       (98 + 16) / 114][Stage 705:===================================================> (110 + 4) / 114][Stage 705:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:49:05.826 END took 3143 ms: q67 - iteration 1
2023-11-30T18:49:05.826 ================================================================================
2023-11-30T18:49:05.826 ================================================================================
2023-11-30T18:49:05.826 START: q68 - iteration 1
2023-11-30T18:49:05.826 SQL:  select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,extended_price ,extended_tax ,list_price from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_ext_sales_price) extended_price ,sum(ss_ext_list_price) list_price ,sum(ss_ext_tax) extended_tax from store_sales ,date_dim ,store ,household_demographics ,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count= 4) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in ('Lodi','Richmond') group by ss_ticket_number ,ss_customer_sk ,ss_addr_sk,ca_city) dn ,customer ,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ,ss_ticket_number limit 100
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 713:>                                                    (0 + 114) / 114][Stage 713:================================================>    (105 + 9) / 114]                                                                                2023-11-30T18:49:08.229 END took 2403 ms: q68 - iteration 1
2023-11-30T18:49:08.229 ================================================================================
2023-11-30T18:49:08.229 ================================================================================
2023-11-30T18:49:08.229 START: q69 - iteration 1
2023-11-30T18:49:08.229 SQL:  select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','FL','SD') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2) and (not exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2) and not exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100
23/11/30 18:49:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 717:>            (0 + 114) / 114][Stage 718:>              (0 + 40) / 58][Stage 717:(0 + 114) / 114][Stage 718:>(0 + 40) / 58][Stage 719:> (0 + 0) / 57][Stage 717:(1 + 113) / 114][Stage 718:>(0 + 41) / 58][Stage 719:> (0 + 0) / 57][Stage 717:(106 + 8) / 114][Stage 718:(25 + 33) / 58][Stage 719:>(0 + 57) / 57][Stage 718:(41 + 17) / 58][Stage 719:>(0 + 57) / 57][Stage 722:>  (0 + 1) / 1][Stage 718:(42 + 16) / 58][Stage 719:>(0 + 57) / 57][Stage 722:>  (0 + 1) / 1][Stage 719:=====================================================> (55 + 2) / 57]                                                                                2023-11-30T18:49:12.917 END took 4687 ms: q69 - iteration 1
2023-11-30T18:49:12.917 ================================================================================
2023-11-30T18:49:12.917 ================================================================================
2023-11-30T18:49:12.917 START: q7 - iteration 1
2023-11-30T18:49:12.917 SQL:  select  i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, item, promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id limit 100
23/11/30 18:49:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 729:>                                                    (0 + 114) / 114][Stage 729:=======>                                             (16 + 98) / 114][Stage 729:====================================================>(112 + 2) / 114][Stage 730:==============================================>     (180 + 11) / 200]                                                                                2023-11-30T18:49:15.859 END took 2941 ms: q7 - iteration 1
2023-11-30T18:49:15.859 ================================================================================
2023-11-30T18:49:15.859 ================================================================================
2023-11-30T18:49:15.859 START: q70 - iteration 1
2023-11-30T18:49:15.859 SQL:  select sum(ss_net_profit) as total_sum ,s_state ,s_county ,grouping(s_state)+grouping(s_county) as lochierarchy ,rank() over ( partition by grouping(s_state)+grouping(s_county), case when grouping(s_county) = 0 then s_state end order by sum(ss_net_profit) desc) as rank_within_parent from store_sales ,date_dim       d1 ,store where d1.d_month_seq between 1206 and 1206+11 and d1.d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk and s_state in ( select s_state from  (select s_state as s_state, rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking from   store_sales, store, date_dim where  d_month_seq between 1206 and 1206+11 and d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk group by s_state ) tmp1 where ranking <= 5 ) group by rollup(s_state,s_county) order by lochierarchy desc ,case when lochierarchy = 0 then s_state end ,rank_within_parent limit 100
23/11/30 18:49:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 734:>                                                    (0 + 114) / 114][Stage 734:======>                                              (15 + 99) / 114]                                                                                23/11/30 18:49:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 739:>                                                    (0 + 114) / 114][Stage 739:=============>                                       (30 + 84) / 114][Stage 739:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:49:20.207 END took 4348 ms: q70 - iteration 1
2023-11-30T18:49:20.207 ================================================================================
2023-11-30T18:49:20.207 ================================================================================
2023-11-30T18:49:20.207 START: q71 - iteration 1
2023-11-30T18:49:20.207 SQL:  select i_brand_id brand_id, i_brand brand,t_hour,t_minute, sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price, ws_sold_date_sk as sold_date_sk, ws_item_sk as sold_item_sk, ws_sold_time_sk as time_sk from web_sales,date_dim where d_date_sk = ws_sold_date_sk and d_moy=11 and d_year=1999 union all select cs_ext_sales_price as ext_price, cs_sold_date_sk as sold_date_sk, cs_item_sk as sold_item_sk, cs_sold_time_sk as time_sk from catalog_sales,date_dim where d_date_sk = cs_sold_date_sk and d_moy=11 and d_year=1999 union all select ss_ext_sales_price as ext_price, ss_sold_date_sk as sold_date_sk, ss_item_sk as sold_item_sk, ss_sold_time_sk as time_sk from store_sales,date_dim where d_date_sk = ss_sold_date_sk and d_moy=11 and d_year=1999 ) tmp,time_dim where sold_item_sk = i_item_sk and i_manager_id=1 and time_sk = t_time_sk and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id 
23/11/30 18:49:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 745:>                                                    (1 + 154) / 229][Stage 745:======================>                            (102 + 127) / 229][Stage 745:==================================>                 (154 + 75) / 229][Stage 745:===================================>                (155 + 74) / 229][Stage 745:===================================>                (157 + 72) / 229][Stage 745:====================================================>(228 + 1) / 229]                                                                                2023-11-30T18:49:24.044 END took 3836 ms: q71 - iteration 1
2023-11-30T18:49:24.044 ================================================================================
2023-11-30T18:49:24.044 ================================================================================
2023-11-30T18:49:24.044 START: q72 - iteration 1
2023-11-30T18:49:24.044 SQL:  select  i_item_desc ,w_warehouse_name ,d1.d_week_seq ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo ,sum(case when p_promo_sk is not null then 1 else 0 end) promo ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand < cs_quantity and d3.d_date > d1.d_date + interval 5 days and hd_buy_potential = '1001-5000' and d1.d_year = 2000 and cd_marital_status = 'S' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq limit 100
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 757:>                                                      (1 + 64) / 65][Stage 757:==>                                                    (3 + 62) / 65][Stage 757:================================================>      (57 + 8) / 65]                                                                                23/11/30 18:49:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 758:=>               (1 + 8) / 9][Stage 759:>              (1 + 57) / 58][Stage 758:=>               (1 + 8) / 9][Stage 759:>              (3 + 55) / 58][Stage 758:=>               (1 + 8) / 9][Stage 759:==============>(57 + 1) / 58][Stage 758:======>                                                  (1 + 8) / 9][Stage 758:============>                                            (2 + 7) / 9][Stage 761:=========================================>          (159 + 41) / 200][Stage 762:===>                                                  (13 + 5) / 200][Stage 762:=====>                                                (22 + 5) / 200][Stage 762:========>                                             (32 + 5) / 200][Stage 762:============>                                         (45 + 5) / 200][Stage 762:==============>                                       (55 + 5) / 200][Stage 762:==================>                                   (67 + 5) / 200][Stage 762:=====================>                                (79 + 5) / 200][Stage 762:========================>                             (89 + 5) / 200][Stage 762:==========================>                          (100 + 5) / 200][Stage 762:=============================>                       (110 + 5) / 200][Stage 762:================================>                    (123 + 5) / 200][Stage 762:===================================>                 (135 + 5) / 200][Stage 762:======================================>              (145 + 5) / 200][Stage 762:==========================================>          (159 + 5) / 200][Stage 762:=============================================>       (170 + 5) / 200][Stage 762:===============================================>     (181 + 5) / 200][Stage 762:===================================================> (193 + 5) / 200]                                                                                2023-11-30T18:49:33.960 END took 9916 ms: q72 - iteration 1
2023-11-30T18:49:33.960 ================================================================================
2023-11-30T18:49:33.960 ================================================================================
2023-11-30T18:49:33.960 START: q73 - iteration 1
2023-11-30T18:49:33.960 SQL:  select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = 'Unknown') and household_demographics.hd_vehicle_count > 0 and case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_county in ('Humboldt County','Hickman County','Galax city','Abbeville County') group by ss_ticket_number,ss_customer_sk) dj,customer where ss_customer_sk = c_customer_sk and cnt between 1 and 5 order by cnt desc, c_last_name asc
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 768:>                                                    (0 + 114) / 114][Stage 768:=================================================>   (107 + 7) / 114]                                                                                2023-11-30T18:49:36.622 END took 2661 ms: q73 - iteration 1
2023-11-30T18:49:36.622 ================================================================================
2023-11-30T18:49:36.622 ================================================================================
2023-11-30T18:49:36.622 START: q74 - iteration 1
2023-11-30T18:49:36.622 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,max(ss_net_paid) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2001,2001+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,max(ws_net_paid) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year in (2001,2001+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year ) select t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.year = 2001 and t_s_secyear.year = 2001+1 and t_w_firstyear.year = 2001 and t_w_secyear.year = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end order by 3,1,2 limit 100
23/11/30 18:49:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 776:>(0 + 57) / 57][Stage 778:(0 + 97) / 114][Stage 780:>(0 + 0) / 114][Stage 776:(36 + 21) / 57][Stage 778:(60 + 54) / 114][Stage 780:(0 + 79) / 114][Stage 776:>(54 + 3) / 57][Stage 778:(93 + 21) / 114][Stage 780:(0 + 114) / 114][Stage 778:(97 + 17) / 114][Stage 780:(0 + 114) / 114][Stage 782:>(0 + 22) / 57][Stage 777:(24 + 1) / 200][Stage 778:(97 + 17) / 114][Stage 780:(0 + 114) / 114][Stage 777:(42 + 4) / 200][Stage 778:(100 + 14) / 114][Stage 780:(0 + 114) / 114][Stage 777:(191 + 2) / 200][Stage 780:(69 + 45) / 114][Stage 782:>(0 + 57) / 57][Stage 782:=========>                                            (10 + 47) / 57][Stage 782:====================>                                 (22 + 35) / 57][Stage 782:====================================>                 (38 + 19) / 57][Stage 784:================>                                     (62 + 2) / 200][Stage 784:======================>                               (82 + 2) / 200][Stage 784:===========================>                         (104 + 2) / 200][Stage 784:==================================>                  (129 + 2) / 200][Stage 784:=======================================>             (149 + 2) / 200][Stage 784:==============================================>      (177 + 2) / 200]                                                                                2023-11-30T18:49:43.877 END took 7254 ms: q74 - iteration 1
2023-11-30T18:49:43.877 ================================================================================
2023-11-30T18:49:43.877 ================================================================================
2023-11-30T18:49:43.877 START: q75 - iteration 1
2023-11-30T18:49:43.877 SQL:  WITH all_sales AS ( SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,SUM(sales_cnt) AS sales_cnt ,SUM(sales_amt) AS sales_amt FROM (SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk JOIN date_dim ON d_date_sk=cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number AND cs_item_sk=cr_item_sk) WHERE i_category='Books' UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk=ss_item_sk JOIN date_dim ON d_date_sk=ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number AND ss_item_sk=sr_item_sk) WHERE i_category='Books' UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk=ws_item_sk JOIN date_dim ON d_date_sk=ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number=wr_order_number AND ws_item_sk=wr_item_sk) WHERE i_category='Books') sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT  prev_yr.d_year AS prev_year ,curr_yr.d_year AS year ,curr_yr.i_brand_id ,curr_yr.i_class_id ,curr_yr.i_category_id ,curr_yr.i_manufact_id ,prev_yr.sales_cnt AS prev_yr_cnt ,curr_yr.sales_cnt AS curr_yr_cnt ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff FROM all_sales curr_yr, all_sales prev_yr WHERE curr_yr.i_brand_id=prev_yr.i_brand_id AND curr_yr.i_class_id=prev_yr.i_class_id AND curr_yr.i_category_id=prev_yr.i_category_id AND curr_yr.i_manufact_id=prev_yr.i_manufact_id AND curr_yr.d_year=2001 AND prev_yr.d_year=2001-1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9 ORDER BY sales_cnt_diff,sales_amt_diff limit 100
23/11/30 18:49:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 786:>(1 + 66) / 67][Stage 788:>(1 + 64) / 65][Stage 789:>(0 + 25) / 63][Stage 786:>(1 + 66) / 67][Stage 788:>(2 + 63) / 65][Stage 789:>(1 + 26) / 63]                                                                                23/11/30 18:49:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 786:==============>(66 + 1) / 67][Stage 789:=====>        (26 + 37) / 63][Stage 786:==============>(66 + 1) / 67][Stage 789:======>       (28 + 35) / 63][Stage 786:==============>(66 + 1) / 67][Stage 789:=============> (56 + 7) / 63]                                                                                23/11/30 18:49:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 786:======================================================>(66 + 1) / 67]                                                                                23/11/30 18:49:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 791:>            (0 + 155) / 229][Stage 794:>              (0 + 0) / 229][Stage 791:>            (1 + 155) / 229][Stage 794:>              (0 + 0) / 229][Stage 791:==>         (45 + 155) / 229][Stage 794:>              (0 + 0) / 229][Stage 791:========>   (153 + 76) / 229][Stage 794:>             (0 + 79) / 229][Stage 791:========>   (155 + 74) / 229][Stage 794:>             (1 + 81) / 229][Stage 791:========>   (156 + 73) / 229][Stage 794:>             (1 + 82) / 229][Stage 791:==========> (200 + 29) / 229][Stage 794:>            (1 + 126) / 229][Stage 794:==============>                                     (62 + 153) / 229][Stage 794:==================>                                 (82 + 133) / 229][Stage 794:==================>                                 (82 + 147) / 229][Stage 794:===================>                                (86 + 143) / 229][Stage 793:============>(198 + 0) / 200][Stage 794:=======>    (137 + 92) / 229][Stage 793:============>(198 + 1) / 200][Stage 794:==========> (200 + 29) / 229][Stage 794:================================================>   (215 + 14) / 229][Stage 794:====================================================>(227 + 2) / 229][Stage 796:====================================================>(199 + 1) / 200]                                                                                2023-11-30T18:49:57.400 END took 13523 ms: q75 - iteration 1
2023-11-30T18:49:57.400 ================================================================================
2023-11-30T18:49:57.400 ================================================================================
2023-11-30T18:49:57.400 START: q76 - iteration 1
2023-11-30T18:49:57.400 SQL:  select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM ( SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price FROM store_sales, item, date_dim WHERE ss_promo_sk IS NULL AND ss_sold_date_sk=d_date_sk AND ss_item_sk=i_item_sk UNION ALL SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price FROM web_sales, item, date_dim WHERE ws_ship_addr_sk IS NULL AND ws_sold_date_sk=d_date_sk AND ws_item_sk=i_item_sk UNION ALL SELECT 'catalog' as channel, 'cs_ship_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price FROM catalog_sales, item, date_dim WHERE cs_ship_customer_sk IS NULL AND cs_sold_date_sk=d_date_sk AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100
23/11/30 18:49:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:49:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:49:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 800:>                                                    (1 + 156) / 163][Stage 800:>                                                    (2 + 156) / 163][Stage 800:============================================>       (138 + 25) / 163][Stage 800:===================================================> (157 + 6) / 163][Stage 800:===================================================> (158 + 5) / 163][Stage 800:====================================================>(160 + 3) / 163][Stage 800:====================================================>(162 + 1) / 163][Stage 801:====================================================>(197 + 3) / 200]                                                                                2023-11-30T18:50:03.457 END took 6056 ms: q76 - iteration 1
2023-11-30T18:50:03.457 ================================================================================
2023-11-30T18:50:03.457 ================================================================================
2023-11-30T18:50:03.457 START: q77 - iteration 1
2023-11-30T18:50:03.457 SQL:  with ss as (select s_store_sk, sum(ss_ext_sales_price) as sales, sum(ss_net_profit) as profit from store_sales, date_dim, store where ss_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and ss_store_sk = s_store_sk group by s_store_sk) , sr as (select s_store_sk, sum(sr_return_amt) as returns, sum(sr_net_loss) as profit_loss from store_returns, date_dim, store where sr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and sr_store_sk = s_store_sk group by s_store_sk), cs as (select cs_call_center_sk, sum(cs_ext_sales_price) as sales, sum(cs_net_profit) as profit from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) group by cs_call_center_sk ), cr as (select cr_call_center_sk, sum(cr_return_amount) as returns, sum(cr_net_loss) as profit_loss from catalog_returns, date_dim where cr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) group by cr_call_center_sk ), ws as ( select wp_web_page_sk, sum(ws_ext_sales_price) as sales, sum(ws_net_profit) as profit from web_sales, date_dim, web_page where ws_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and ws_web_page_sk = wp_web_page_sk group by wp_web_page_sk), wr as (select wp_web_page_sk, sum(wr_return_amt) as returns, sum(wr_net_loss) as profit_loss from web_returns, date_dim, web_page where wr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and wr_web_page_sk = wp_web_page_sk group by wp_web_page_sk) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , ss.s_store_sk as id , sales , coalesce(returns, 0) as returns , (profit - coalesce(profit_loss,0)) as profit from   ss left join sr on  ss.s_store_sk = sr.s_store_sk union all select 'catalog channel' as channel , cs_call_center_sk as id , sales , returns , (profit - profit_loss) as profit from  cs , cr union all select 'web channel' as channel , ws.wp_web_page_sk as id , sales , coalesce(returns, 0) returns , (profit - coalesce(profit_loss,0)) as profit from   ws left join wr on  ws.wp_web_page_sk = wr.wp_web_page_sk ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 18:50:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 804:>                                                        (0 + 1) / 1]                                                                                23/11/30 18:50:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 805:>(1 + 57) / 58][Stage 806:>(1 + 64) / 65][Stage 807:(0 + 38) / 114][Stage 805:(14 + 44) / 58][Stage 806:>(1 + 64) / 65][Stage 807:(0 + 51) / 114][Stage 805:>(57 + 1) / 58][Stage 806:(28 + 37) / 65][Stage 807:(34 + 80) / 114][Stage 805:>(57 + 1) / 58][Stage 806:>(63 + 2) / 65][Stage 807:(35 + 79) / 114][Stage 805:>(57 + 1) / 58][Stage 807:(36 + 78) / 114][Stage 808:>(0 + 57) / 57][Stage 805:>(57 + 1) / 58][Stage 807:(37 + 77) / 114][Stage 808:>(0 + 57) / 57][Stage 805:>(57 + 1) / 58][Stage 807:(70 + 44) / 114][Stage 808:>(0 + 57) / 57][Stage 805:>(57 + 1) / 58][Stage 807:(112 + 2) / 114][Stage 808:(26 + 31) / 57][Stage 805:>(57 + 1) / 58][Stage 807:(113 + 1) / 114][Stage 808:>(53 + 4) / 57][Stage 805:>(57 + 1) / 58][Stage 807:(113 + 1) / 114][Stage 809:(21 + 42) / 63][Stage 805:>(57 + 1) / 58][Stage 807:(113 + 1) / 114][Stage 809:(23 + 40) / 63][Stage 805:>(57 + 1) / 58][Stage 807:(113 + 1) / 114][Stage 809:(24 + 39) / 63][Stage 805:>(57 + 1) / 58][Stage 807:(113 + 1) / 114][Stage 809:(32 + 31) / 63][Stage 807:(113 + 1) / 114][Stage 809:>(62 + 1) / 63][Stage 810:>(3 + 63) / 66][Stage 810:=============================================>        (56 + 10) / 66][Stage 811:=>                                              (1142 + 173) / 40400][Stage 811:==>                                             (1934 + 175) / 40400][Stage 811:===>                                            (2620 + 199) / 40400][Stage 811:====>                                           (3417 + 167) / 40400][Stage 811:====>                                           (4187 + 180) / 40400][Stage 811:=====>                                          (4680 + 272) / 40400][Stage 811:======>                                         (5462 + 166) / 40400][Stage 811:=======>                                        (6246 + 171) / 40400][Stage 811:========>                                       (6827 + 168) / 40400][Stage 811:========>                                       (7315 + 202) / 40400]23/11/30 18:50:14 ERROR AsyncEventQueue: Dropping event from queue eventLog. This likely means one of the listeners is too slow and cannot keep up with the rate at which tasks are being started by the scheduler.
23/11/30 18:50:14 WARN AsyncEventQueue: Dropped 2 events from eventLog since the application started.
[Stage 811:=========>                                      (8276 + 181) / 40400][Stage 811:==========>                                     (8827 + 204) / 40400][Stage 811:===========>                                    (9610 + 194) / 40400][Stage 811:===========>                                   (10031 + 189) / 40400][Stage 811:============>                                  (10857 + 180) / 40400][Stage 811:=============>                                 (11442 + 199) / 40400][Stage 811:==============>                                (12213 + 177) / 40400][Stage 811:==============>                                (12757 + 162) / 40400][Stage 811:===============>                               (13449 + 218) / 40400][Stage 811:================>                              (14014 + 209) / 40400][Stage 811:================>                              (14605 + 166) / 40400][Stage 811:=================>                             (15428 + 170) / 40400][Stage 811:==================>                            (15986 + 169) / 40400][Stage 811:===================>                           (16591 + 207) / 40400][Stage 811:====================>                          (17425 + 169) / 40400][Stage 811:=====================>                         (18070 + 167) / 40400][Stage 811:=====================>                         (18804 + 254) / 40400][Stage 811:======================>                        (19331 + 163) / 40400][Stage 811:=======================>                       (20114 + 191) / 40400][Stage 811:=======================>                       (20405 + 170) / 40400][Stage 811:========================>                      (21020 + 198) / 40400][Stage 811:=========================>                     (21682 + 201) / 40400][Stage 811:==========================>                    (22389 + 256) / 40400][Stage 811:==========================>                    (23131 + 168) / 40400][Stage 811:===========================>                   (23918 + 176) / 40400][Stage 811:============================>                  (24599 + 167) / 40400][Stage 811:=============================>                 (25346 + 171) / 40400][Stage 811:==============================>                (26075 + 166) / 40400][Stage 811:===============================>               (26771 + 174) / 40400][Stage 811:================================>              (27533 + 193) / 40400][Stage 811:================================>              (28319 + 170) / 40400][Stage 811:=================================>             (28993 + 187) / 40400][Stage 811:==================================>            (29766 + 176) / 40400][Stage 811:===================================>           (30550 + 182) / 40400][Stage 811:====================================>          (31175 + 195) / 40400][Stage 811:=====================================>         (31996 + 177) / 40400][Stage 811:======================================>        (32667 + 179) / 40400][Stage 811:======================================>        (33374 + 191) / 40400][Stage 811:=======================================>       (34026 + 191) / 40400][Stage 811:========================================>      (34863 + 190) / 40400][Stage 811:=========================================>     (35580 + 197) / 40400][Stage 811:==========================================>    (36388 + 194) / 40400][Stage 811:===========================================>   (37168 + 193) / 40400][Stage 811:============================================>  (37977 + 296) / 40400][Stage 811:=============================================> (38819 + 196) / 40400][Stage 811:==============================================>(39595 + 199) / 40400][Stage 811:==============================================>(40261 + 139) / 40400][Stage 811:===============================================>(40385 + 15) / 40400][Stage 811:================================================>(40392 + 8) / 40400][Stage 811:================================================>(40395 + 5) / 40400][Stage 811:================================================>(40399 + 1) / 40400][Stage 812:=================================================>  (189 + 11) / 200][Stage 812:===================================================> (195 + 5) / 200]                                                                                2023-11-30T18:50:27.941 END took 24484 ms: q77 - iteration 1
2023-11-30T18:50:27.941 ================================================================================
2023-11-30T18:50:27.941 ================================================================================
2023-11-30T18:50:27.941 START: q78 - iteration 1
2023-11-30T18:50:27.941 SQL:  with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from web_sales left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from catalog_sales left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from store_sales left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_item_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000 order by ss_item_sk, ss_qty desc, ss_wc desc, ss_sp desc, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio limit 100
23/11/30 18:50:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 813:>(0 + 63) / 63][Stage 815:>(1 + 64) / 65][Stage 817:>(1 + 66) / 67][Stage 813:>(1 + 62) / 63][Stage 815:>(1 + 64) / 65][Stage 817:>(1 + 66) / 67][Stage 813:>(5 + 58) / 63][Stage 815:>(1 + 64) / 65][Stage 817:>(1 + 66) / 67][Stage 813:(48 + 15) / 63][Stage 815:(46 + 19) / 65][Stage 817:(35 + 32) / 67][Stage 813:(48 + 15) / 63][Stage 815:(52 + 13) / 65][Stage 817:(53 + 14) / 67][Stage 813:(48 + 15) / 63][Stage 815:(53 + 12) / 65][Stage 817:(54 + 13) / 67][Stage 813:(50 + 13) / 63][Stage 815:(54 + 11) / 65][Stage 817:(54 + 13) / 67][Stage 813:(50 + 13) / 63][Stage 815:(55 + 10) / 65][Stage 817:(56 + 11) / 67][Stage 813:>(54 + 9) / 63][Stage 815:>(56 + 9) / 65][Stage 817:>(58 + 9) / 67][Stage 813:>(57 + 6) / 63][Stage 815:>(57 + 8) / 65][Stage 817:>(60 + 7) / 67][Stage 813:>(62 + 1) / 63][Stage 815:>(62 + 3) / 65][Stage 817:>(65 + 2) / 67]                                                                                23/11/30 18:50:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 818:(0 + 114) / 114][Stage 819:>(0 + 57) / 57][Stage 820:>(0 + 29) / 58][Stage 818:(11 + 103) / 114][Stage 819:>(1 + 56) / 57][Stage 820:>(1 + 41) / 58][Stage 818:(87 + 27) / 114][Stage 819:(42 + 15) / 57][Stage 820:(21 + 37) / 58][Stage 818:(94 + 20) / 114][Stage 819:(43 + 14) / 57][Stage 820:(24 + 34) / 58][Stage 818:(97 + 17) / 114][Stage 819:>(49 + 8) / 57][Stage 820:(25 + 33) / 58][Stage 818:============>(110 + 4) / 114][Stage 820:=======>      (29 + 29) / 58][Stage 820:===========================>                          (29 + 29) / 58][Stage 820:=============================>                        (32 + 26) / 58][Stage 820:======================================================>(57 + 1) / 58][Stage 821:===========================================>        (166 + 34) / 200][Stage 821:===========================================>        (169 + 31) / 200][Stage 821:===================================================> (196 + 4) / 200]                                                                                2023-11-30T18:50:38.310 END took 10369 ms: q78 - iteration 1
2023-11-30T18:50:38.310 ================================================================================
2023-11-30T18:50:38.310 ================================================================================
2023-11-30T18:50:38.310 START: q79 - iteration 1
2023-11-30T18:50:38.310 SQL:  select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number ,ss_customer_sk ,store.s_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > -1) and date_dim.d_dow = 1 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 826:>                                                    (0 + 114) / 114][Stage 826:=====================================>               (80 + 34) / 114][Stage 826:=============================================>       (97 + 17) / 114]                                                                                2023-11-30T18:50:41.495 END took 3185 ms: q79 - iteration 1
2023-11-30T18:50:41.495 ================================================================================
2023-11-30T18:50:41.495 ================================================================================
2023-11-30T18:50:41.495 START: q8 - iteration 1
2023-11-30T18:50:41.495 SQL:  select  s_store_name ,sum(ss_net_profit) from store_sales ,date_dim ,store, (select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( '47602','16704','35863','28577','83910','36201', '58412','48162','28055','41419','80332', '38607','77817','24891','16226','18410', '21231','59345','13918','51089','20317', '17167','54585','67881','78366','47770', '18360','51717','73108','14440','21800', '89338','45859','65501','34948','25973', '73219','25333','17291','10374','18829', '60736','82620','41351','52094','19326', '25214','54207','40936','21814','79077', '25178','75742','77454','30621','89193', '27369','41232','48567','83041','71948', '37119','68341','14073','16891','62878', '49130','19833','24286','27700','40979', '50412','81504','94835','84844','71954', '39503','57649','18434','24987','12350', '86379','27413','44529','98569','16515', '27287','24255','21094','16005','56436', '91110','68293','56455','54558','10298', '83647','32754','27052','51766','19444', '13869','45645','94791','57631','20712', '37788','41807','46507','21727','71836', '81070','50632','88086','63991','20244', '31655','51782','29818','63792','68605', '94898','36430','57025','20601','82080', '33869','22728','35834','29086','92645', '98584','98072','11652','78093','57553', '43830','71144','53565','18700','90209', '71256','38353','54364','28571','96560', '57839','56355','50679','45266','84680', '34306','34972','48530','30106','15371', '92380','84247','92292','68852','13338', '34594','82602','70073','98069','85066', '47289','11686','98862','26217','47529', '63294','51793','35926','24227','14196', '24594','32489','99060','49472','43432', '49211','14312','88137','47369','56877', '20534','81755','15794','12318','21060', '73134','41255','63073','81003','73873', '66057','51184','51195','45676','92696', '70450','90669','98338','25264','38919', '59226','58581','60298','17895','19489', '52301','80846','95464','68770','51634', '19988','18367','18421','11618','67975', '25494','41352','95430','15734','62585', '97173','33773','10425','75675','53535', '17879','41967','12197','67998','79658', '59130','72592','14851','43933','68101', '50636','25717','71286','24660','58058', '72991','95042','15543','33122','69280', '11912','59386','27642','65177','17672', '33467','64592','36335','54010','18767', '63193','42361','49254','33113','33159', '36479','59080','11855','81963','31016', '49140','29392','41836','32958','53163', '13844','73146','23952','65148','93498', '14530','46131','58454','13376','13378', '83986','12320','17193','59852','46081', '98533','52389','13086','68843','31013', '13261','60560','13443','45533','83583', '11489','58218','19753','22911','25115', '86709','27156','32669','13123','51933', '39214','41331','66943','14155','69998', '49101','70070','35076','14242','73021', '59494','15782','29752','37914','74686', '83086','34473','15751','81084','49230', '91894','60624','17819','28810','63180', '56224','39459','55233','75752','43639', '55349','86057','62361','50788','31830', '58062','18218','85761','60083','45484', '21204','90229','70041','41162','35390', '16364','39500','68908','26689','52868', '81335','40146','11340','61527','61794', '71997','30415','59004','29450','58117', '69952','33562','83833','27385','61860', '96435','48333','23065','32961','84919', '61997','99132','22815','56600','68730', '48017','95694','32919','88217','27116', '28239','58032','18884','16791','21343', '97462','18569','75660','15475') intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 832:>                                                    (0 + 114) / 114][Stage 832:=>                                                   (4 + 110) / 114][Stage 832:==========================================>          (91 + 23) / 114][Stage 832:====================================================>(112 + 2) / 114]                                                                                2023-11-30T18:50:44.473 END took 2977 ms: q8 - iteration 1
2023-11-30T18:50:44.473 ================================================================================
2023-11-30T18:50:44.473 ================================================================================
2023-11-30T18:50:44.473 START: q80 - iteration 1
2023-11-30T18:50:44.473 SQL:  with ssr as (select  s_store_id as store_id, sum(ss_ext_sales_price) as sales, sum(coalesce(sr_return_amt, 0)) as returns, sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit from store_sales left outer join store_returns on (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion where ss_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and ss_store_sk = s_store_sk and ss_item_sk = i_item_sk and i_current_price > 50 and ss_promo_sk = p_promo_sk and p_channel_tv = 'N' group by s_store_id) , csr as (select  cp_catalog_page_id as catalog_page_id, sum(cs_ext_sales_price) as sales, sum(coalesce(cr_return_amount, 0)) as returns, sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit from catalog_sales left outer join catalog_returns on (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion where cs_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and cs_catalog_page_sk = cp_catalog_page_sk and cs_item_sk = i_item_sk and i_current_price > 50 and cs_promo_sk = p_promo_sk and p_channel_tv = 'N' group by cp_catalog_page_id) , wsr as (select  web_site_id, sum(ws_ext_sales_price) as sales, sum(coalesce(wr_return_amt, 0)) as returns, sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit from web_sales left outer join web_returns on (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number), date_dim, web_site, item, promotion where ws_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and ws_web_site_sk = web_site_sk and ws_item_sk = i_item_sk and i_current_price > 50 and ws_promo_sk = p_promo_sk and p_channel_tv = 'N' group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || store_id as id , sales , returns , profit from   ssr union all select 'catalog channel' as channel , 'catalog_page' || catalog_page_id as id , sales , returns , profit from  csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 834:>(0 + 63) / 63][Stage 838:>(1 + 64) / 65][Stage 842:>(1 + 66) / 67][Stage 834:>(1 + 62) / 63][Stage 838:>(1 + 64) / 65][Stage 842:>(1 + 66) / 67][Stage 834:(48 + 15) / 63][Stage 838:(41 + 24) / 65][Stage 842:(27 + 40) / 67]                                                                                23/11/30 18:50:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 843:>              (1 + 57) / 58][Stage 844:>              (0 + 57) / 57][Stage 843:>(1 + 57) / 58][Stage 844:>(0 + 57) / 57][Stage 845:(0 + 86) / 114][Stage 843:>(2 + 56) / 58][Stage 844:>(0 + 57) / 57][Stage 845:(0 + 87) / 114][Stage 843:(43 + 15) / 58][Stage 844:(41 + 16) / 57][Stage 845:(27 + 87) / 114][Stage 843:>(55 + 3) / 58][Stage 844:>(55 + 2) / 57][Stage 845:(71 + 43) / 114][Stage 845:=======================================>             (86 + 28) / 114][Stage 845:========================================>            (88 + 26) / 114][Stage 845:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:50:51.946 END took 7472 ms: q80 - iteration 1
2023-11-30T18:50:51.946 ================================================================================
2023-11-30T18:50:51.946 ================================================================================
2023-11-30T18:50:51.946 START: q81 - iteration 1
2023-11-30T18:50:51.946 SQL:  with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'MO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return limit 100
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 853:>              (1 + 64) / 65][Stage 854:>              (1 + 64) / 65][Stage 853:==>           (12 + 53) / 65][Stage 854:======>       (28 + 37) / 65][Stage 853:==============>(61 + 4) / 65][Stage 854:==============>(63 + 2) / 65][Stage 853:=======================================================(65 + 0) / 65]                                                                                2023-11-30T18:50:55.697 END took 3750 ms: q81 - iteration 1
2023-11-30T18:50:55.697 ================================================================================
2023-11-30T18:50:55.697 ================================================================================
2023-11-30T18:50:55.697 START: q82 - iteration 1
2023-11-30T18:50:55.697 SQL:  select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, store_sales where i_current_price between 68 and 68+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-08' as date) and (cast('2002-05-08' as date) +  INTERVAL 60 days) and i_manufact_id in (562,370,230,182) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100
23/11/30 18:50:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 861:>            (0 + 114) / 114][Stage 862:=>               (1 + 8) / 9][Stage 861:========>    (76 + 38) / 114][Stage 862:=>               (1 + 8) / 9][Stage 862:============>                                            (2 + 7) / 9][Stage 862:============================================>            (7 + 2) / 9]                                                                                2023-11-30T18:50:58.538 END took 2841 ms: q82 - iteration 1
2023-11-30T18:50:58.538 ================================================================================
2023-11-30T18:50:58.538 ================================================================================
2023-11-30T18:50:58.538 START: q83 - iteration 1
2023-11-30T18:50:58.538 SQL:  with sr_items as (select i_item_id item_id, sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   sr_returned_date_sk   = d_date_sk group by i_item_id), cr_items as (select i_item_id item_id, sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   cr_returned_date_sk   = d_date_sk group by i_item_id), wr_items as (select i_item_id item_id, sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   wr_returned_date_sk   = d_date_sk group by i_item_id) select  sr_items.item_id ,sr_item_qty ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev ,cr_item_qty ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev ,wr_item_qty ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:50:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 869:>(0 + 63) / 63][Stage 870:>(1 + 66) / 67][Stage 871:>(0 + 65) / 65][Stage 869:>(1 + 62) / 63][Stage 870:>(1 + 66) / 67][Stage 871:>(1 + 64) / 65][Stage 869:>(3 + 60) / 63][Stage 870:>(1 + 66) / 67][Stage 871:>(1 + 64) / 65][Stage 869:>(59 + 4) / 63][Stage 870:(43 + 24) / 67][Stage 871:(55 + 10) / 65][Stage 870:======================================================>(66 + 1) / 67]                                                                                2023-11-30T18:51:01.996 END took 3457 ms: q83 - iteration 1
2023-11-30T18:51:01.996 ================================================================================
2023-11-30T18:51:01.996 ================================================================================
2023-11-30T18:51:01.996 START: q84 - iteration 1
2023-11-30T18:51:01.996 SQL:  select  c_customer_id as customer_id , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city	        =  'Buena Vista' and c_current_addr_sk = ca_address_sk and ib_lower_bound   >=  49786 and ib_upper_bound   <=  49786 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100
23/11/30 18:51:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 874:>                                                      (1 + 62) / 63][Stage 874:===========================================>          (51 + 12) / 63]                                                                                23/11/30 18:51:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:51:04.537 END took 2541 ms: q84 - iteration 1
2023-11-30T18:51:04.537 ================================================================================
2023-11-30T18:51:04.537 ================================================================================
2023-11-30T18:51:04.537 START: q85 - iteration 1
2023-11-30T18:51:04.537 SQL:  select  substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'ND', 'FL') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OH', 'MS', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MN', 'LA', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) limit 100
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 883:>                                                      (0 + 66) / 66][Stage 883:================================================>      (58 + 8) / 66]                                                                                23/11/30 18:51:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 885:>              (0 + 57) / 57][Stage 887:>                (0 + 1) / 1][Stage 885:>                                                      (0 + 57) / 57][Stage 885:=============================>                        (31 + 26) / 57]                                                                                2023-11-30T18:51:09.269 END took 4731 ms: q85 - iteration 1
2023-11-30T18:51:09.269 ================================================================================
2023-11-30T18:51:09.269 ================================================================================
2023-11-30T18:51:09.269 START: q86 - iteration 1
2023-11-30T18:51:09.269 SQL:  select sum(ws_net_paid) as total_sum ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ws_net_paid) desc) as rank_within_parent from web_sales ,date_dim       d1 ,item where d1.d_month_seq between 1217 and 1217+11 and d1.d_date_sk = ws_sold_date_sk and i_item_sk  = ws_item_sk group by rollup(i_category,i_class) order by lochierarchy desc, case when lochierarchy = 0 then i_category end, rank_within_parent limit 100
23/11/30 18:51:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 892:>                                                      (0 + 57) / 57][Stage 892:===>                                                   (4 + 53) / 57][Stage 892:======================================================>(56 + 1) / 57]                                                                                2023-11-30T18:51:11.568 END took 2299 ms: q86 - iteration 1
2023-11-30T18:51:11.568 ================================================================================
2023-11-30T18:51:11.568 ================================================================================
2023-11-30T18:51:11.568 START: q87 - iteration 1
2023-11-30T18:51:11.568 SQL:  select count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) ) cool_cust
23/11/30 18:51:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 897:>              (1 + 57) / 58][Stage 898:>              (0 + 57) / 57][Stage 897:>(1 + 57) / 58][Stage 898:>(0 + 57) / 57][Stage 901:(0 + 86) / 114][Stage 897:(18 + 40) / 58][Stage 898:(37 + 20) / 57][Stage 901:(46 + 68) / 114][Stage 897:==============>(57 + 1) / 58][Stage 901:=========>   (85 + 29) / 114][Stage 901:=======================================>             (85 + 29) / 114][Stage 901:=======================================>             (86 + 28) / 114][Stage 901:=========================================>           (89 + 25) / 114]                                                                                2023-11-30T18:51:15.768 END took 4199 ms: q87 - iteration 1
2023-11-30T18:51:15.768 ================================================================================
2023-11-30T18:51:15.768 ================================================================================
2023-11-30T18:51:15.768 START: q88 - iteration 1
2023-11-30T18:51:15.768 SQL:  select  * from (select count(*) h8_30_to_9 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 8 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s1, (select count(*) h9_to_9_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s2, (select count(*) h9_30_to_10 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s3, (select count(*) h10_to_10_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s4, (select count(*) h10_30_to_11 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s5, (select count(*) h11_to_11_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s6, (select count(*) h11_30_to_12 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s7, (select count(*) h12_to_12_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 12 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s8
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 915:(0 + 114) / 114][Stage 917:(0 + 86) / 114][Stage 919:>(0 + 0) / 114][Stage 915:(27 + 87) / 114][Stage 917:(1 + 113) / 114][Stage 919:>(0 + 1) / 114][Stage 915:(113 + 1) / 114][Stage 917:(83 + 31) / 114][Stage 919:(0 + 114) / 114]                                                                                [Stage 917:(86 + 28) / 114][Stage 919:(0 + 114) / 114][Stage 921:(0 + 58) / 114]                                                                                [Stage 921:(58 + 56) / 114][Stage 923:(0 + 114) / 114][Stage 925:(0 + 30) / 114][Stage 921:(78 + 36) / 114][Stage 923:(0 + 114) / 114][Stage 925:(0 + 50) / 114]                                                                                [Stage 925:===>         (30 + 84) / 114][Stage 927:>            (0 + 114) / 114][Stage 925:==========>  (94 + 20) / 114][Stage 927:>            (0 + 114) / 114]                                                                                [Stage 929:>                                                    (0 + 114) / 114][Stage 929:====================================>                (78 + 36) / 114]                                                                                2023-11-30T18:51:24.793 END took 9025 ms: q88 - iteration 1
2023-11-30T18:51:24.793 ================================================================================
2023-11-30T18:51:24.793 ================================================================================
2023-11-30T18:51:24.793 START: q89 - iteration 1
2023-11-30T18:51:24.793 SQL:  select  * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (2001) and ((i_category in ('Children','Home','Women') and i_class in ('toddlers','flatware','fragrances') ) or (i_category in ('Music','Electronics','Shoes') and i_class in ('country','dvd/vcr players','mens') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100
23/11/30 18:51:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 934:>                                                    (0 + 114) / 114][Stage 934:===================>                                 (42 + 72) / 114][Stage 934:====================================================>(113 + 1) / 114]                                                                                2023-11-30T18:51:27.241 END took 2447 ms: q89 - iteration 1
2023-11-30T18:51:27.241 ================================================================================
2023-11-30T18:51:27.241 ================================================================================
2023-11-30T18:51:27.241 START: q9 - iteration 1
2023-11-30T18:51:27.241 SQL:  select case when (select count(*) from store_sales where ss_quantity between 1 and 20) > 4502397049 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from store_sales where ss_quantity between 21 and 40) > 4756228269 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from store_sales where ss_quantity between 41 and 60) > 4101835064 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from store_sales where ss_quantity between 61 and 80) > 4583261513 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from store_sales where ss_quantity between 81 and 100) > 4208819283 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from store_sales where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1
[Stage 937:(0 + 114) / 114][Stage 939:(0 + 86) / 114][Stage 941:>(0 + 0) / 114][Stage 937:(103 + 11) / 114][Stage 939:(60 + 54) / 114][Stage 941:(0 + 114) / 114][Stage 937:(113 + 1) / 114][Stage 939:(86 + 28) / 114][Stage 941:(0 + 114) / 114][Stage 939:(86 + 28) / 114][Stage 941:(0 + 114) / 114][Stage 943:(0 + 58) / 114][Stage 938:>  (0 + 0) / 1][Stage 939:(86 + 28) / 114][Stage 941:(0 + 114) / 114]                                                                                [Stage 943:(58 + 56) / 114][Stage 945:(0 + 114) / 114][Stage 947:(0 + 30) / 114][Stage 943:(66 + 48) / 114][Stage 945:(0 + 114) / 114][Stage 947:(0 + 38) / 114]                                                                                [Stage 947:(30 + 84) / 114][Stage 949:(0 + 114) / 114][Stage 951:>(0 + 2) / 114][Stage 947:(90 + 24) / 114][Stage 949:(0 + 114) / 114][Stage 951:(0 + 63) / 114]                                                                                [Stage 951:(106 + 8) / 114][Stage 953:(2 + 112) / 114][Stage 955:(0 + 81) / 114]                                                                                [Stage 953:(90 + 24) / 114][Stage 955:(0 + 114) / 114][Stage 957:(0 + 62) / 114][Stage 955:(35 + 79) / 114][Stage 957:(0 + 114) / 114][Stage 959:>(0 + 6) / 114]                                                                                [Stage 957:(60 + 54) / 114][Stage 959:(0 + 114) / 114][Stage 961:(0 + 32) / 114][Stage 957:(82 + 32) / 114][Stage 959:(0 + 114) / 114][Stage 961:(0 + 54) / 114]                                                                                [Stage 961:(103 + 11) / 114][Stage 963:(0 + 75) / 114][Stage 965:(0 + 114) / 114]                                                                                2023-11-30T18:51:39.390 END took 12148 ms: q9 - iteration 1
2023-11-30T18:51:39.390 ================================================================================
2023-11-30T18:51:39.390 ================================================================================
2023-11-30T18:51:39.390 START: q90 - iteration 1
2023-11-30T18:51:39.390 SQL:  select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 7 and 7+1 and household_demographics.hd_dep_count = 1 and web_page.wp_char_count between 5000 and 5200) at, ( select count(*) pmc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 20 and 20+1 and household_demographics.hd_dep_count = 1 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio limit 100
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 972:>                                                      (0 + 57) / 57][Stage 972:===========================================>          (46 + 11) / 57]                                                                                [Stage 974:>                                                      (0 + 57) / 57][Stage 974:====================================================>  (54 + 3) / 57]                                                                                2023-11-30T18:51:42.911 END took 3521 ms: q90 - iteration 1
2023-11-30T18:51:42.911 ================================================================================
2023-11-30T18:51:42.911 ================================================================================
2023-11-30T18:51:42.911 START: q91 - iteration 1
2023-11-30T18:51:42.911 SQL:  select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics where cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1998 and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown') or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like 'Unknown%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 982:>                                                      (1 + 64) / 65][Stage 982:===================================>                  (43 + 22) / 65]                                                                                2023-11-30T18:51:46.335 END took 3423 ms: q91 - iteration 1
2023-11-30T18:51:46.335 ================================================================================
2023-11-30T18:51:46.335 ================================================================================
2023-11-30T18:51:46.335 START: q92 - iteration 1
2023-11-30T18:51:46.335 SQL:  select sum(ws_ext_discount_amt)  as `Excess Discount Amount` from web_sales ,item ,date_dim where i_manufact_id = 172 and i_item_sk = ws_item_sk and d_date between '1999-01-12' and (cast('1999-01-12' as date) + INTERVAL 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales ,date_dim WHERE ws_item_sk = i_item_sk and d_date between '1999-01-12' and (cast('1999-01-12' as date) + INTERVAL 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) limit 100
23/11/30 18:51:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 992:>              (0 + 57) / 57][Stage 993:>              (0 + 57) / 57][Stage 992:>              (2 + 55) / 57][Stage 993:>              (0 + 57) / 57][Stage 992:==============>(56 + 1) / 57][Stage 993:=============> (50 + 7) / 57][Stage 993:======================================================>(56 + 1) / 57]                                                                                2023-11-30T18:51:48.718 END took 2382 ms: q92 - iteration 1
2023-11-30T18:51:48.718 ================================================================================
2023-11-30T18:51:48.718 ================================================================================
2023-11-30T18:51:48.718 START: q93 - iteration 1
2023-11-30T18:51:48.718 SQL:  select  ss_customer_sk ,sum(act_sales) sumsales from (select ss_item_sk ,ss_ticket_number ,ss_customer_sk ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number) ,reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 58') t group by ss_customer_sk order by sumsales, ss_customer_sk limit 100
23/11/30 18:51:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 996:>                                                      (0 + 63) / 63][Stage 996:>                                                      (1 + 62) / 63][Stage 996:===============================================>       (54 + 9) / 63]                                                                                23/11/30 18:51:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 998:>                                                    (0 + 114) / 114][Stage 998:==============================================>     (101 + 13) / 114]                                                                                2023-11-30T18:51:52.634 END took 3915 ms: q93 - iteration 1
2023-11-30T18:51:52.634 ================================================================================
2023-11-30T18:51:52.634 ================================================================================
2023-11-30T18:51:52.634 START: q94 - iteration 1
2023-11-30T18:51:52.634 SQL:  select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between '2002-3-01' and (cast('2002-3-01' as date) + INTERVAL 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'GA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select * from web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select * from web_returns wr1 where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100
23/11/30 18:51:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1003:>                                                     (1 + 66) / 67][Stage 1003:=========================================>           (52 + 15) / 67]                                                                                23/11/30 18:51:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1004:>             (0 + 57) / 57][Stage 1005:>             (0 + 57) / 57][Stage 1004:====>        (20 + 37) / 57][Stage 1005:=====>       (23 + 34) / 57][Stage 1004:=====================================================>(56 + 1) / 57]                                                                                2023-11-30T18:51:56.854 END took 4219 ms: q94 - iteration 1
2023-11-30T18:51:56.854 ================================================================================
2023-11-30T18:51:56.854 ================================================================================
2023-11-30T18:51:56.854 START: q95 - iteration 1
2023-11-30T18:51:56.854 SQL:  with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2 from web_sales ws1,web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between '2001-3-01' and (cast('2001-3-01' as date) + INTERVAL 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'NE' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number from ws_wh) and ws1.ws_order_number in (select wr_order_number from web_returns,ws_wh where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100
23/11/30 18:51:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1009:>             (0 + 57) / 57][Stage 1011:>             (1 + 66) / 67][Stage 1009:==>          (12 + 45) / 57][Stage 1011:>             (1 + 66) / 67]                                                                                23/11/30 18:51:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:51:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:51:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1013:(0 + 57) / 57][Stage 1014:(0 + 57) / 57][Stage 1015:(0 + 57) / 57][Stage 1013:(25 + 32) / 57][Stage 1014:(0 + 57) / 57][Stage 1015:(0 + 57) / 57][Stage 1014:==>          (13 + 44) / 57][Stage 1015:=>            (5 + 52) / 57][Stage 1014:============> (51 + 6) / 57][Stage 1015:=============>(56 + 1) / 57]                                                                                2023-11-30T18:52:01.499 END took 4645 ms: q95 - iteration 1
2023-11-30T18:52:01.499 ================================================================================
2023-11-30T18:52:01.499 ================================================================================
2023-11-30T18:52:01.499 START: q96 - iteration 1
2023-11-30T18:52:01.499 SQL:  select  count(*) from store_sales ,household_demographics ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 16 and time_dim.t_minute >= 30 and household_demographics.hd_dep_count = 0 and store.s_store_name = 'ese' order by count(*) limit 100
23/11/30 18:52:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1021:>                                                   (0 + 114) / 114][Stage 1021:=========>                                          (21 + 93) / 114][Stage 1021:===================================================>(113 + 1) / 114]                                                                                2023-11-30T18:52:03.509 END took 2010 ms: q96 - iteration 1
2023-11-30T18:52:03.509 ================================================================================
2023-11-30T18:52:03.509 ================================================================================
2023-11-30T18:52:03.509 START: q97 - iteration 1
2023-11-30T18:52:03.509 SQL:  with ssci as ( select ss_customer_sk customer_sk ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219 + 11 group by ss_customer_sk ,ss_item_sk), csci as( select cs_bill_customer_sk customer_sk ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219 + 11 group by cs_bill_customer_sk ,cs_item_sk) select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk and ssci.item_sk = csci.item_sk) limit 100
23/11/30 18:52:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1024:>             (1 + 57) / 58][Stage 1025:>           (0 + 114) / 114][Stage 1024:==========>  (48 + 10) / 58][Stage 1025:========>   (83 + 31) / 114]                                                                                2023-11-30T18:52:06.052 END took 2543 ms: q97 - iteration 1
2023-11-30T18:52:06.052 ================================================================================
2023-11-30T18:52:06.052 ================================================================================
2023-11-30T18:52:06.052 START: q98 - iteration 1
2023-11-30T18:52:06.052 SQL:  select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ss_ext_sales_price) as itemrevenue ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over (partition by i_class) as revenueratio from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and i_category in ('Books', 'Children', 'Sports') and ss_sold_date_sk = d_date_sk and d_date between cast('2001-03-10' as date) and (cast('2001-03-10' as date) + interval 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio
23/11/30 18:52:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1030:>                                                   (0 + 114) / 114][Stage 1030:================================================>   (106 + 8) / 114]                                                                                2023-11-30T18:52:08.547 END took 2494 ms: q98 - iteration 1
2023-11-30T18:52:08.547 ================================================================================
2023-11-30T18:52:08.547 ================================================================================
2023-11-30T18:52:08.547 START: q99 - iteration 1
2023-11-30T18:52:08.547 SQL:  select substr(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20) ,sm_type ,cc_name order by substr(w_warehouse_name,1,20) ,sm_type ,cc_name limit 100
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1041:>                                                     (1 + 57) / 58][Stage 1041:==================================>                  (38 + 20) / 58]                                                                                2023-11-30T18:52:10.941 END took 2393 ms: q99 - iteration 1
2023-11-30T18:52:10.941 ================================================================================
2023-11-30T18:52:10.941 ================================================================================
2023-11-30T18:52:10.941 START: q1 - iteration 2
2023-11-30T18:52:10.941 SQL:  with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 group by sr_customer_sk ,sr_store_sk) select  c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'MO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id limit 100
23/11/30 18:52:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1046:>             (0 + 63) / 63][Stage 1048:>             (0 + 63) / 63][Stage 1046:>             (1 + 62) / 63][Stage 1048:>             (0 + 63) / 63][Stage 1046:>             (1 + 62) / 63][Stage 1048:>             (1 + 62) / 63][Stage 1046:=>            (7 + 56) / 63][Stage 1048:>             (4 + 59) / 63][Stage 1046:=============>(62 + 1) / 63][Stage 1048:=============>(61 + 2) / 63]                                                                                2023-11-30T18:52:13.439 END took 2498 ms: q1 - iteration 2
2023-11-30T18:52:13.439 ================================================================================
2023-11-30T18:52:13.439 ================================================================================
2023-11-30T18:52:13.439 START: q10 - iteration 2
2023-11-30T18:52:13.439 SQL:  select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Grady County','Marion County','Decatur County','Lyman County','Beaver County') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 and 2+3) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 ANd 2+3) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 and 2+3)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100
23/11/30 18:52:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1054:>             (0 + 57) / 57][Stage 1055:>           (0 + 114) / 114][Stage 1054:(0 + 57) / 57][Stage 1055:(0 + 114) / 114][Stage 1056:(0 + 29) / 58][Stage 1054:(49 + 8) / 57][Stage 1055:(68 + 46) / 114][Stage 1056:(10 + 48) / 58][Stage 1056:======>      (29 + 29) / 58][Stage 1058:>               (0 + 1) / 1][Stage 1056:======>      (30 + 28) / 58][Stage 1058:>               (0 + 1) / 1][Stage 1056:=====================================================>(57 + 1) / 58][Stage 1057:======================================>            (151 + 11) / 200]                                                                                2023-11-30T18:52:18.237 END took 4798 ms: q10 - iteration 2
2023-11-30T18:52:18.237 ================================================================================
2023-11-30T18:52:18.238 ================================================================================
2023-11-30T18:52:18.238 START: q11 - iteration 2
2023-11-30T18:52:18.238 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_preferred_cust_flag from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 2001 and t_s_secyear.dyear = 2001+1 and t_w_firstyear.dyear = 2001 and t_w_secyear.dyear = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_preferred_cust_flag limit 100
23/11/30 18:52:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1063:>                                                   (0 + 114) / 114][Stage 1063:>           (0 + 114) / 114][Stage 1067:>             (0 + 57) / 57][Stage 1063:>           (2 + 112) / 114][Stage 1067:>             (0 + 57) / 57][Stage 1063:===========>(112 + 2) / 114][Stage 1067:=============>(53 + 4) / 57][Stage 1065:====>        (65 + 7) / 200][Stage 1070:>             (0 + 0) / 200][Stage 1065:(105 + 7) / 200][Stage 1068:(0 + 0) / 200][Stage 1070:(0 + 0) / 200][Stage 1065:(147 + 7) / 200][Stage 1068:(0 + 0) / 200][Stage 1070:(0 + 0) / 200][Stage 1065:(192 + 7) / 200][Stage 1068:(0 + 0) / 200][Stage 1070:(0 + 0) / 200][Stage 1068:(7 + 0) / 200][Stage 1070:(0 + 0) / 200][Stage 1072:(0 + 0) / 200][Stage 1068:(19 + 7) / 200][Stage 1070:(0 + 0) / 200][Stage 1072:(0 + 0) / 200][Stage 1068:(79 + 7) / 200][Stage 1070:(0 + 0) / 200][Stage 1072:(0 + 0) / 200][Stage 1068:(141 + 7) / 200][Stage 1070:(0 + 0) / 200][Stage 1072:(0 + 0) / 200][Stage 1070:>             (0 + 7) / 200][Stage 1072:>             (0 + 0) / 200][Stage 1070:>             (7 + 0) / 200][Stage 1072:>             (0 + 0) / 200][Stage 1070:=>           (20 + 7) / 200][Stage 1072:>             (0 + 0) / 200][Stage 1070:===>         (54 + 7) / 200][Stage 1072:>             (0 + 0) / 200][Stage 1070:======>     (100 + 7) / 200][Stage 1072:>             (0 + 0) / 200][Stage 1070:=========>  (150 + 7) / 200][Stage 1072:>             (0 + 0) / 200][Stage 1070:==========>(186 + 14) / 200][Stage 1072:>           (0 + 186) / 200][Stage 1072:===================================================>(197 + 3) / 200]                                                                                2023-11-30T18:52:25.401 END took 7163 ms: q11 - iteration 2
2023-11-30T18:52:25.401 ================================================================================
2023-11-30T18:52:25.401 ================================================================================
2023-11-30T18:52:25.401 START: q12 - iteration 2
2023-11-30T18:52:25.401 SQL:  select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Children', 'Jewelry', 'Music') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-05-11' as date) and (cast('2001-05-11' as date) + INTERVAL 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100
23/11/30 18:52:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1077:>                                                     (0 + 57) / 57][Stage 1077:=========================================>           (45 + 12) / 57]                                                                                2023-11-30T18:52:27.356 END took 1954 ms: q12 - iteration 2
2023-11-30T18:52:27.356 ================================================================================
2023-11-30T18:52:27.356 ================================================================================
2023-11-30T18:52:27.356 START: q13 - iteration 2
2023-11-30T18:52:27.356 SQL:  select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('SC', 'WY', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'NE', 'GA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'AR', 'MI') and ss_net_profit between 50 and 250 ))
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1085:>                                                   (0 + 114) / 114][Stage 1085:==>                                                 (6 + 108) / 114][Stage 1085:===================================================>(112 + 2) / 114][Stage 1086:==========================================>         (162 + 1) / 200][Stage 1086:=================================================>  (190 + 1) / 200]                                                                                2023-11-30T18:52:30.550 END took 3193 ms: q13 - iteration 2
2023-11-30T18:52:30.550 ================================================================================
2023-11-30T18:52:30.550 ================================================================================
2023-11-30T18:52:30.550 START: q14a - iteration 2
2023-11-30T18:52:30.550 SQL:  with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales) from( select 'store' channel, i_brand_id,i_class_id ,i_category_id,sum(ss_quantity*ss_list_price) sales , count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales) union all select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales from catalog_sales ,item ,date_dim where cs_item_sk in (select ss_item_sk from cross_items) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales) union all select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales from web_sales ,item ,date_dim where ws_item_sk in (select ss_item_sk from cross_items) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales) ) y group by rollup (channel, i_brand_id,i_class_id,i_category_id) order by channel,i_brand_id,i_class_id,i_category_id limit 100
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1093:(1 + 200) / 229][Stage 1095:> (0 + 0) / 1][Stage 1096:>(0 + 0) / 57][Stage 1093:(2 + 200) / 229][Stage 1095:> (0 + 0) / 1][Stage 1096:>(0 + 0) / 57][Stage 1093:(187 + 42) / 229][Stage 1096:(0 + 57) / 57][Stage 1097:(0 + 58) / 58][Stage 1093:(201 + 28) / 229][Stage 1096:(0 + 57) / 57][Stage 1097:(0 + 58) / 58][Stage 1093:(201 + 28) / 229][Stage 1096:(0 + 57) / 57][Stage 1097:(1 + 57) / 58][Stage 1093:(227 + 2) / 229][Stage 1096:(6 + 51) / 57][Stage 1097:(1 + 57) / 58]                                                                                [Stage 1098:=========================================>         (163 + 11) / 200]                                                                                23/11/30 18:52:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1099:>                                                   (0 + 114) / 114][Stage 1099:==================================================> (110 + 4) / 114]                                                                                23/11/30 18:52:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1103:(0 + 114) / 114][Stage 1106:(0 + 29) / 58][Stage 1107:(0 + 57) / 57][Stage 1103:(9 + 105) / 114][Stage 1106:(0 + 58) / 58][Stage 1107:(27 + 30) / 57][Stage 1106:==========================>                          (29 + 29) / 58][Stage 1106:===========================>                         (30 + 28) / 58][Stage 1106:====================================================> (56 + 2) / 58]                                                                                2023-11-30T18:52:43.510 END took 12959 ms: q14a - iteration 2
2023-11-30T18:52:43.510 ================================================================================
2023-11-30T18:52:43.510 ================================================================================
2023-11-30T18:52:43.510 START: q14b - iteration 2
2023-11-30T18:52:43.510 SQL:  with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select  this_year.channel ty_channel ,this_year.i_brand_id ty_brand ,this_year.i_class_id ty_class ,this_year.i_category_id ty_category ,this_year.sales ty_sales ,this_year.number_sales ty_number_sales ,last_year.channel ly_channel ,last_year.i_brand_id ly_brand ,last_year.i_class_id ly_class ,last_year.i_category_id ly_category ,last_year.sales ly_sales ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 5) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 5) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1119:(1 + 200) / 229][Stage 1121:> (0 + 0) / 1][Stage 1122:> (0 + 0) / 1][Stage 1119:(54 + 175) / 229][Stage 1121:> (0 + 1) / 1][Stage 1122:> (0 + 1) / 1]                                                                                23/11/30 18:52:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1119:(201 + 28) / 229][Stage 1124:(0 + 57) / 57][Stage 1125:(1 + 57) / 58]                                                                                23/11/30 18:52:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1128:>                                                   (0 + 114) / 114][Stage 1128:================================================>   (107 + 7) / 114]                                                                                23/11/30 18:52:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1133:>                                                   (0 + 114) / 114][Stage 1133:=====>                                             (13 + 101) / 114]                                                                                2023-11-30T18:52:53.653 END took 10143 ms: q14b - iteration 2
2023-11-30T18:52:53.654 ================================================================================
2023-11-30T18:52:53.654 ================================================================================
2023-11-30T18:52:53.654 START: q15 - iteration 2
2023-11-30T18:52:53.654 SQL:  select  ca_zip ,sum(cs_sales_price) from catalog_sales ,customer ,customer_address ,date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip limit 100
23/11/30 18:52:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1140:>                                                     (1 + 57) / 58][Stage 1140:===>                                                  (4 + 54) / 58]                                                                                2023-11-30T18:52:55.712 END took 2058 ms: q15 - iteration 2
2023-11-30T18:52:55.712 ================================================================================
2023-11-30T18:52:55.712 ================================================================================
2023-11-30T18:52:55.712 START: q16 - iteration 2
2023-11-30T18:52:55.712 SQL:  select count(distinct cs_order_number) as `order count` ,sum(cs_ext_ship_cost) as `total shipping cost` ,sum(cs_net_profit) as `total net profit` from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2000-3-01' and (cast('2000-3-01' as date) + INTERVAL 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Luce County','Wadena County','Jefferson Davis Parish','Daviess County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100
23/11/30 18:52:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:52:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1144:>                                                     (1 + 64) / 65][Stage 1144:=================>                                   (22 + 43) / 65][Stage 1144:=================================================>    (60 + 5) / 65]                                                                                23/11/30 18:52:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:52:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1146:>             (1 + 57) / 58][Stage 1147:>             (1 + 57) / 58][Stage 1146:====>        (20 + 38) / 58][Stage 1147:>             (4 + 54) / 58][Stage 1147:=====================================================>(57 + 1) / 58]                                                                                2023-11-30T18:53:00.066 END took 4353 ms: q16 - iteration 2
2023-11-30T18:53:00.066 ================================================================================
2023-11-30T18:53:00.066 ================================================================================
2023-11-30T18:53:00.066 START: q17 - iteration 2
2023-11-30T18:53:00.066 SQL:  select  i_item_id ,i_item_desc ,s_state ,count(ss_quantity) as store_sales_quantitycount ,avg(ss_quantity) as store_sales_quantityave ,stddev_samp(ss_quantity) as store_sales_quantitystdev ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov ,count(sr_return_quantity) as store_returns_quantitycount ,avg(sr_return_quantity) as store_returns_quantityave ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_quarter_name = '1999Q1' and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_quarter_name in ('1999Q1','1999Q2','1999Q3') and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_quarter_name in ('1999Q1','1999Q2','1999Q3') group by i_item_id ,i_item_desc ,s_state order by i_item_id ,i_item_desc ,s_state limit 100
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1150:>                                                     (1 + 62) / 63][Stage 1150:==========================================>          (50 + 13) / 63]                                                                                23/11/30 18:53:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1155:>           (0 + 114) / 114][Stage 1156:>             (1 + 57) / 58][Stage 1155:>           (1 + 113) / 114][Stage 1156:>             (1 + 57) / 58][Stage 1155:==========> (97 + 17) / 114][Stage 1156:=============>(56 + 2) / 58]                                                                                2023-11-30T18:53:04.674 END took 4607 ms: q17 - iteration 2
2023-11-30T18:53:04.674 ================================================================================
2023-11-30T18:53:04.674 ================================================================================
2023-11-30T18:53:04.674 START: q18 - iteration 2
2023-11-30T18:53:04.674 SQL:  select  i_item_id, ca_country, ca_state, ca_county, avg( cast(cs_quantity as decimal(12,2))) agg1, avg( cast(cs_list_price as decimal(12,2))) agg2, avg( cast(cs_coupon_amt as decimal(12,2))) agg3, avg( cast(cs_sales_price as decimal(12,2))) agg4, avg( cast(cs_net_profit as decimal(12,2))) agg5, avg( cast(c_birth_year as decimal(12,2))) agg6, avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7 from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd1.cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd1.cd_gender = 'F' and cd1.cd_education_status = 'Unknown' and c_current_cdemo_sk = cd2.cd_demo_sk and c_current_addr_sk = ca_address_sk and c_birth_month in (4,8,12,10,11,9) and d_year = 2001 and ca_state in ('AR','IA','TX' ,'KS','LA','NC','SD') group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country, ca_state, ca_county, i_item_id limit 100
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1165:>                                                     (1 + 57) / 58][Stage 1165:================================================>     (52 + 6) / 58][Stage 1166:===================================>               (138 + 11) / 200]                                                                                2023-11-30T18:53:08.702 END took 4028 ms: q18 - iteration 2
2023-11-30T18:53:08.702 ================================================================================
2023-11-30T18:53:08.702 ================================================================================
2023-11-30T18:53:08.702 START: q19 - iteration 2
2023-11-30T18:53:08.702 SQL:  select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=63 and d_moy=11 and d_year=2002 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip,1,5) <> substr(s_zip,1,5) and ss_store_sk = s_store_sk group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100 
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1173:>                                                   (0 + 114) / 114][Stage 1173:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:53:10.834 END took 2131 ms: q19 - iteration 2
2023-11-30T18:53:10.834 ================================================================================
2023-11-30T18:53:10.834 ================================================================================
2023-11-30T18:53:10.834 START: q2 - iteration 2
2023-11-30T18:53:10.834 SQL:  with wscs as (select sold_date_sk ,sales_price from (select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales)), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1
23/11/30 18:53:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1178:>                                                   (1 + 114) / 115][Stage 1178:=========================================>          (92 + 23) / 115]                                                                                2023-11-30T18:53:13.762 END took 2927 ms: q2 - iteration 2
2023-11-30T18:53:13.762 ================================================================================
2023-11-30T18:53:13.762 ================================================================================
2023-11-30T18:53:13.762 START: q20 - iteration 2
2023-11-30T18:53:13.762 SQL:  select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from	catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Electronics', 'Children', 'Home') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-03-19' as date) and (cast('2002-03-19' as date) + INTERVAL 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100
23/11/30 18:53:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1187:>                                                     (1 + 57) / 58]                                                                                2023-11-30T18:53:15.837 END took 2074 ms: q20 - iteration 2
2023-11-30T18:53:15.837 ================================================================================
2023-11-30T18:53:15.837 ================================================================================
2023-11-30T18:53:15.837 START: q21 - iteration 2
2023-11-30T18:53:15.837 SQL:  select  * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-04-12' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-04-12' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = inv_item_sk and inv_warehouse_sk   = w_warehouse_sk and inv_date_sk    = d_date_sk and d_date between (cast ('1999-04-12' as date) - INTERVAL 30 days) and (cast ('1999-04-12' as date) + INTERVAL 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id limit 100
23/11/30 18:53:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1193:======>                                                 (1 + 8) / 9][Stage 1193:==================>                                     (3 + 6) / 9]                                                                                2023-11-30T18:53:18.343 END took 2506 ms: q21 - iteration 2
2023-11-30T18:53:18.343 ================================================================================
2023-11-30T18:53:18.343 ================================================================================
2023-11-30T18:53:18.343 START: q22 - iteration 2
2023-11-30T18:53:18.343 SQL:  select  i_product_name ,i_brand ,i_class ,i_category ,avg(inv_quantity_on_hand) qoh from inventory ,date_dim ,item where inv_date_sk=d_date_sk and inv_item_sk=i_item_sk and d_month_seq between 1188 and 1188 + 11 group by rollup(i_product_name ,i_brand ,i_class ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category limit 100
23/11/30 18:53:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1197:======>                                                 (1 + 8) / 9][Stage 1197:============>                                           (2 + 7) / 9][Stage 1197:==================>                                     (3 + 6) / 9][Stage 1197:===============================>                        (5 + 4) / 9]                                                                                2023-11-30T18:53:20.965 END took 2621 ms: q22 - iteration 2
2023-11-30T18:53:20.965 ================================================================================
2023-11-30T18:53:20.965 ================================================================================
2023-11-30T18:53:20.965 START: q23a - iteration 2
2023-11-30T18:53:20.965 SQL:  with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (1998,1998+1,1998+2,1998+3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1,1998+2,1998+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select  sum(sales) from (select cs_quantity*cs_list_price sales from catalog_sales ,date_dim where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) union all select ws_quantity*ws_list_price sales from web_sales ,date_dim where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) limit 100
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1205:>                                                   (0 + 114) / 114][Stage 1205:===========================================>        (96 + 18) / 114]                                                                                [Stage 1208:(0 + 114) / 114][Stage 1210:(0 + 57) / 57][Stage 1211:(0 + 29) / 58][Stage 1208:(23 + 91) / 114][Stage 1210:(31 + 26) / 57][Stage 1211:(12 + 46) / 58][Stage 1208:(113 + 1) / 114][Stage 1211:(29 + 29) / 58][Stage 1214:(0 + 114) / 114][Stage 1211:======>      (30 + 28) / 58][Stage 1214:>           (0 + 114) / 114][Stage 1214:=======================================>            (87 + 27) / 114]                                                                                2023-11-30T18:53:27.528 END took 6562 ms: q23a - iteration 2
2023-11-30T18:53:27.528 ================================================================================
2023-11-30T18:53:27.528 ================================================================================
2023-11-30T18:53:27.528 START: q23b - iteration 2
2023-11-30T18:53:27.528 SQL:  with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (1998,1998 + 1,1998 + 2,1998 + 3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1,1998+2,1998+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select  c_last_name,c_first_name,sales from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales from catalog_sales ,customer ,date_dim where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name union all select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales from web_sales ,customer ,date_dim where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name) order by c_last_name,c_first_name,sales limit 100
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1223:>                                                   (0 + 114) / 114][Stage 1223:=====================================>              (82 + 32) / 114]                                                                                [Stage 1226:>                                                   (0 + 114) / 114][Stage 1226:>                                                   (1 + 113) / 114][Stage 1226:===============================================>    (105 + 9) / 114]                                                                                23/11/30 18:53:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1230:>           (0 + 114) / 114][Stage 1231:>             (1 + 57) / 58][Stage 1230:(0 + 114) / 114][Stage 1231:(1 + 57) / 58][Stage 1236:(0 + 29) / 57][Stage 1230:(0 + 114) / 114][Stage 1231:(2 + 56) / 58][Stage 1236:(0 + 30) / 57][Stage 1230:========>   (82 + 32) / 114][Stage 1236:======>      (28 + 29) / 57][Stage 1236:==========================>                          (28 + 29) / 57][Stage 1236:==========================>                          (29 + 28) / 57][Stage 1236:===========================================>         (47 + 10) / 57]                                                                                2023-11-30T18:53:36.470 END took 8942 ms: q23b - iteration 2
2023-11-30T18:53:36.470 ================================================================================
2023-11-30T18:53:36.470 ================================================================================
2023-11-30T18:53:36.470 START: q24a - iteration 2
2023-11-30T18:53:36.470 SQL:  with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id=7 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'goldenrod' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1240:>             (1 + 62) / 63][Stage 1241:>             (0 + 63) / 63][Stage 1240:>             (1 + 62) / 63][Stage 1241:>             (1 + 62) / 63][Stage 1240:============> (58 + 5) / 63][Stage 1241:=========>   (48 + 15) / 63]                                                                                23/11/30 18:53:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1250:>                                                   (0 + 114) / 114][Stage 1250:==============================================>    (103 + 11) / 114]                                                                                [Stage 1253:>                                                   (0 + 114) / 114][Stage 1253:=>                                                  (3 + 111) / 114][Stage 1253:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:53:42.759 END took 6289 ms: q24a - iteration 2
2023-11-30T18:53:42.759 ================================================================================
2023-11-30T18:53:42.759 ================================================================================
2023-11-30T18:53:42.759 START: q24b - iteration 2
2023-11-30T18:53:42.759 SQL:  with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id = 7 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'magenta' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1260:>             (1 + 62) / 63][Stage 1263:>             (1 + 62) / 63][Stage 1260:==>          (10 + 53) / 63][Stage 1263:=>            (5 + 58) / 63][Stage 1260:=============>(62 + 1) / 63][Stage 1263:=============>(62 + 1) / 63]                                                                                23/11/30 18:53:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1270:>                                                   (0 + 114) / 114][Stage 1270:=================================================>  (108 + 6) / 114]                                                                                [Stage 1273:>                                                   (0 + 114) / 114][Stage 1273:========================>                           (53 + 61) / 114][Stage 1273:===================================================>(113 + 1) / 114]                                                                                2023-11-30T18:53:48.635 END took 5875 ms: q24b - iteration 2
2023-11-30T18:53:48.635 ================================================================================
2023-11-30T18:53:48.635 ================================================================================
2023-11-30T18:53:48.635 START: q25 - iteration 2
2023-11-30T18:53:48.635 SQL:  select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy               between 4 and  10 and d2.d_year              = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy               between 4 and  10 and d3.d_year              = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1283:>                                                     (0 + 63) / 63][Stage 1283:>                                                     (1 + 62) / 63][Stage 1283:=====================================================>(62 + 1) / 63]                                                                                23/11/30 18:53:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1285:>           (0 + 114) / 114][Stage 1286:>             (1 + 57) / 58][Stage 1285:=========> (102 + 12) / 114][Stage 1286:=============>(56 + 2) / 58]                                                                                2023-11-30T18:53:53.032 END took 4396 ms: q25 - iteration 2
2023-11-30T18:53:53.032 ================================================================================
2023-11-30T18:53:53.032 ================================================================================
2023-11-30T18:53:53.032 START: q26 - iteration 2
2023-11-30T18:53:53.032 SQL:  select  i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from catalog_sales, customer_demographics, date_dim, item, promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id limit 100
23/11/30 18:53:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1293:>                                                     (1 + 57) / 58][Stage 1293:==========================================>          (47 + 11) / 58]                                                                                2023-11-30T18:53:55.859 END took 2826 ms: q26 - iteration 2
2023-11-30T18:53:55.859 ================================================================================
2023-11-30T18:53:55.859 ================================================================================
2023-11-30T18:53:55.859 START: q27 - iteration 2
2023-11-30T18:53:55.859 SQL:  select  i_item_id, s_state, grouping(s_state) g_state, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Secondary' and d_year = 1999 and s_state in ('AL','FL', 'TX', 'NM', 'MI', 'GA') group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100
23/11/30 18:53:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:53:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:53:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1299:>                                                   (0 + 114) / 114][Stage 1299:>                                                   (1 + 113) / 114][Stage 1299:=================================================>  (108 + 6) / 114]                                                                                2023-11-30T18:53:58.287 END took 2427 ms: q27 - iteration 2
2023-11-30T18:53:58.287 ================================================================================
2023-11-30T18:53:58.287 ================================================================================
2023-11-30T18:53:58.287 START: q28 - iteration 2
2023-11-30T18:53:58.287 SQL:  select  * from (select avg(ss_list_price) B1_LP ,count(ss_list_price) B1_CNT ,count(distinct ss_list_price) B1_CNTD from store_sales where ss_quantity between 0 and 5 and (ss_list_price between 74 and 74+10 or ss_coupon_amt between 2949 and 2949+1000 or ss_wholesale_cost between 49 and 49+20)) B1, (select avg(ss_list_price) B2_LP ,count(ss_list_price) B2_CNT ,count(distinct ss_list_price) B2_CNTD from store_sales where ss_quantity between 6 and 10 and (ss_list_price between 136 and 136+10 or ss_coupon_amt between 10027 and 10027+1000 or ss_wholesale_cost between 53 and 53+20)) B2, (select avg(ss_list_price) B3_LP ,count(ss_list_price) B3_CNT ,count(distinct ss_list_price) B3_CNTD from store_sales where ss_quantity between 11 and 15 and (ss_list_price between 73 and 73+10 or ss_coupon_amt between 1451 and 1451+1000 or ss_wholesale_cost between 78 and 78+20)) B3, (select avg(ss_list_price) B4_LP ,count(ss_list_price) B4_CNT ,count(distinct ss_list_price) B4_CNTD from store_sales where ss_quantity between 16 and 20 and (ss_list_price between 87 and 87+10 or ss_coupon_amt between 17007 and 17007+1000 or ss_wholesale_cost between 55 and 55+20)) B4, (select avg(ss_list_price) B5_LP ,count(ss_list_price) B5_CNT ,count(distinct ss_list_price) B5_CNTD from store_sales where ss_quantity between 21 and 25 and (ss_list_price between 112 and 112+10 or ss_coupon_amt between 17243 and 17243+1000 or ss_wholesale_cost between 2 and 2+20)) B5, (select avg(ss_list_price) B6_LP ,count(ss_list_price) B6_CNT ,count(distinct ss_list_price) B6_CNTD from store_sales where ss_quantity between 26 and 30 and (ss_list_price between 119 and 119+10 or ss_coupon_amt between 4954 and 4954+1000 or ss_wholesale_cost between 22 and 22+20)) B6 limit 100
[Stage 1303:(0 + 114) / 114][Stage 1306:(0 + 86) / 114][Stage 1309:(0 + 0) / 114][Stage 1303:(5 + 109) / 114][Stage 1306:(0 + 92) / 114][Stage 1309:(0 + 0) / 114][Stage 1303:(113 + 1) / 114][Stage 1306:(86 + 28) / 114][Stage 1309:(0 + 114) / 114][Stage 1306:(86 + 28) / 114][Stage 1309:(0 + 114) / 114][Stage 1312:(0 + 58) / 114][Stage 1304:(0 + 0) / 200][Stage 1306:(86 + 28) / 114][Stage 1309:(0 + 114) / 114][Stage 1304:(43 + 37) / 200][Stage 1306:(110 + 4) / 114][Stage 1309:(12 + 102) / 114]                                                                                [Stage 1312:======>     (58 + 56) / 114][Stage 1315:>           (0 + 114) / 114][Stage 1312:==========> (95 + 19) / 114][Stage 1315:>           (1 + 113) / 114][Stage 1315:===================>                                (42 + 72) / 114]                                                                                [Stage 1318:>                                                   (0 + 114) / 114][Stage 1318:=====>                                             (13 + 101) / 114]                                                                                2023-11-30T18:54:05.469 END took 7182 ms: q28 - iteration 2
2023-11-30T18:54:05.469 ================================================================================
2023-11-30T18:54:05.469 ================================================================================
2023-11-30T18:54:05.469 START: q29 - iteration 2
2023-11-30T18:54:05.469 SQL:  select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_quantity)        as store_sales_quantity ,stddev_samp(sr_return_quantity) as store_returns_quantity ,stddev_samp(cs_quantity)        as catalog_sales_quantity from store_sales ,store_returns ,catalog_sales ,date_dim             d1 ,date_dim             d2 ,date_dim             d3 ,store ,item where d1.d_moy               = 4 and d1.d_year              = 2000 and d1.d_date_sk           = ss_sold_date_sk and i_item_sk              = ss_item_sk and s_store_sk             = ss_store_sk and ss_customer_sk         = sr_customer_sk and ss_item_sk             = sr_item_sk and ss_ticket_number       = sr_ticket_number and sr_returned_date_sk    = d2.d_date_sk and d2.d_moy               between 4 and  4 + 3 and d2.d_year              = 2000 and sr_customer_sk         = cs_bill_customer_sk and sr_item_sk             = cs_item_sk and cs_sold_date_sk        = d3.d_date_sk and d3.d_year              in (2000,2000+1,2000+2) group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1323:>                                                     (0 + 63) / 63][Stage 1323:>                                                     (1 + 62) / 63][Stage 1323:=====================================================>(62 + 1) / 63]                                                                                23/11/30 18:54:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1327:>           (0 + 114) / 114][Stage 1328:>             (1 + 57) / 58][Stage 1327:=======>    (74 + 40) / 114][Stage 1328:============> (50 + 8) / 58]                                                                                2023-11-30T18:54:09.618 END took 4148 ms: q29 - iteration 2
2023-11-30T18:54:09.619 ================================================================================
2023-11-30T18:54:09.619 ================================================================================
2023-11-30T18:54:09.619 START: q3 - iteration 2
2023-11-30T18:54:09.619 SQL:  select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_sales_price) sum_agg from  date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,sum_agg desc ,brand_id limit 100
23/11/30 18:54:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1333:>                                                   (0 + 114) / 114][Stage 1333:=================================================>  (108 + 6) / 114]                                                                                2023-11-30T18:54:11.566 END took 1947 ms: q3 - iteration 2
2023-11-30T18:54:11.566 ================================================================================
2023-11-30T18:54:11.566 ================================================================================
2023-11-30T18:54:11.566 START: q30 - iteration 2
2023-11-30T18:54:11.566 SQL:  with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'MI' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return limit 100
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1340:>             (0 + 66) / 66][Stage 1341:>             (0 + 66) / 66][Stage 1340:>             (1 + 65) / 66][Stage 1341:>             (4 + 62) / 66][Stage 1340:=============>(65 + 1) / 66][Stage 1341:=============>(65 + 1) / 66][Stage 1345:==================================================> (195 + 4) / 200]                                                                                2023-11-30T18:54:14.964 END took 3398 ms: q30 - iteration 2
2023-11-30T18:54:14.964 ================================================================================
2023-11-30T18:54:14.964 ================================================================================
2023-11-30T18:54:14.964 START: q31 - iteration 2
2023-11-30T18:54:14.964 SQL:  with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year) select ss1.ca_county ,ss1.d_year ,ws2.web_sales/ws1.web_sales web_q1_q2_increase ,ss2.store_sales/ss1.store_sales store_q1_q2_increase ,ws3.web_sales/ws2.web_sales web_q2_q3_increase ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from ss ss1 ,ss ss2 ,ss ss3 ,ws ws1 ,ws ws2 ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:16 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1350:(0 + 114) / 114][Stage 1352:(0 + 57) / 57][Stage 1354:(0 + 29) / 57][Stage 1350:(1 + 113) / 114][Stage 1352:(0 + 57) / 57][Stage 1354:(0 + 30) / 57][Stage 1350:(113 + 1) / 114][Stage 1352:(38 + 19) / 57][Stage 1354:(23 + 34) / 57][Stage 1354:(29 + 28) / 57][Stage 1356:(0 + 114) / 114][Stage 1358:(0 + 54) / 114][Stage 1354:(29 + 28) / 57][Stage 1356:(0 + 114) / 114][Stage 1358:(0 + 58) / 114][Stage 1351:(199 + 0) / 200][Stage 1354:(29 + 28) / 57][Stage 1356:(0 + 114) / 114][Stage 1351:(199 + 0) / 200][Stage 1353:(2 + 0) / 200][Stage 1354:(29 + 28) / 57][Stage 1353:(11 + 8) / 200][Stage 1354:(44 + 13) / 57][Stage 1356:(19 + 95) / 114][Stage 1358:====>       (38 + 76) / 114][Stage 1360:>             (0 + 57) / 57][Stage 1358:=====>      (55 + 59) / 114][Stage 1360:>             (0 + 57) / 57][Stage 1358:======>     (58 + 56) / 114][Stage 1360:>             (0 + 57) / 57][Stage 1355:(186 + 0) / 200][Stage 1358:(58 + 56) / 114][Stage 1360:(0 + 57) / 57][Stage 1358:===========>(113 + 1) / 114][Stage 1360:==>          (11 + 46) / 57]                                                                                2023-11-30T18:54:21.460 END took 6495 ms: q31 - iteration 2
2023-11-30T18:54:21.460 ================================================================================
2023-11-30T18:54:21.460 ================================================================================
2023-11-30T18:54:21.460 START: q32 - iteration 2
2023-11-30T18:54:21.460 SQL:  select  sum(cs_ext_discount_amt)  as `excess discount amount` from catalog_sales ,item ,date_dim where i_manufact_id = 490 and i_item_sk = cs_item_sk and d_date between '1999-01-27' and (cast('1999-01-27' as date) + INTERVAL 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '1999-01-27' and (cast('1999-01-27' as date) + INTERVAL 90 days) and d_date_sk = cs_sold_date_sk ) limit 100
23/11/30 18:54:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1379:>             (1 + 57) / 58][Stage 1380:>             (1 + 57) / 58][Stage 1379:===>         (14 + 44) / 58][Stage 1380:>             (4 + 54) / 58]                                                                                2023-11-30T18:54:23.580 END took 2119 ms: q32 - iteration 2
2023-11-30T18:54:23.580 ================================================================================
2023-11-30T18:54:23.580 ================================================================================
2023-11-30T18:54:23.580 START: q33 - iteration 2
2023-11-30T18:54:23.580 SQL:  with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_manufact_id in (select i_manufact_id from item where i_category in ('Electronics')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in ('Electronics')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in ('Electronics')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id) select  i_manufact_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1387:(1 + 57) / 58][Stage 1388:(0 + 57) / 57][Stage 1389:(0 + 86) / 114][Stage 1387:(3 + 55) / 58][Stage 1388:(0 + 57) / 57][Stage 1389:(0 + 89) / 114][Stage 1388:==========>  (44 + 13) / 57][Stage 1389:========>   (80 + 34) / 114][Stage 1389:=======================================>            (86 + 28) / 114][Stage 1389:==================================================> (111 + 3) / 114]                                                                                2023-11-30T18:54:27.656 END took 4076 ms: q33 - iteration 2
2023-11-30T18:54:27.656 ================================================================================
2023-11-30T18:54:27.656 ================================================================================
2023-11-30T18:54:27.656 START: q34 - iteration 2
2023-11-30T18:54:27.656 SQL:  select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28) and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = 'Unknown') and household_demographics.hd_vehicle_count > 0 and (case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end)  > 1.2 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_county in ('Nez Perce County','Murray County','Surry County','Calhoun County', 'Wilkinson County','Brown County','Wallace County','Carter County') group by ss_ticket_number,ss_customer_sk) dn,customer where ss_customer_sk = c_customer_sk and cnt between 15 and 20 order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1396:>                                                   (0 + 114) / 114][Stage 1396:>                                                   (2 + 112) / 114]                                                                                2023-11-30T18:54:30.229 END took 2573 ms: q34 - iteration 2
2023-11-30T18:54:30.229 ================================================================================
2023-11-30T18:54:30.229 ================================================================================
2023-11-30T18:54:30.229 START: q35 - iteration 2
2023-11-30T18:54:30.229 SQL:  select ca_state, cd_gender, cd_marital_status, cd_dep_count, count(*) cnt1, stddev_samp(cd_dep_count), sum(cd_dep_count), min(cd_dep_count), cd_dep_employed_count, count(*) cnt2, stddev_samp(cd_dep_employed_count), sum(cd_dep_employed_count), min(cd_dep_employed_count), cd_dep_college_count, count(*) cnt3, stddev_samp(cd_dep_college_count), sum(cd_dep_college_count), min(cd_dep_college_count) from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4)) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100
23/11/30 18:54:31 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:31 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:31 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:31 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1403:(0 + 57) / 57][Stage 1404:(0 + 114) / 114][Stage 1405:(0 + 28) / 58][Stage 1403:(0 + 57) / 57][Stage 1404:(0 + 114) / 114][Stage 1405:(0 + 29) / 58][Stage 1403:(54 + 3) / 57][Stage 1404:(76 + 38) / 114][Stage 1405:(6 + 52) / 58][Stage 1405:==========================>                          (29 + 29) / 58][Stage 1405:===========================>                         (30 + 28) / 58][Stage 1405:=============================>                       (32 + 26) / 58][Stage 1405:=====================================================>(57 + 1) / 58]                                                                                2023-11-30T18:54:35.052 END took 4822 ms: q35 - iteration 2
2023-11-30T18:54:35.052 ================================================================================
2023-11-30T18:54:35.052 ================================================================================
2023-11-30T18:54:35.052 START: q36 - iteration 2
2023-11-30T18:54:35.053 SQL:  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent from store_sales ,date_dim       d1 ,item ,store where d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk  = ss_item_sk and s_store_sk  = ss_store_sk and s_state in ('MN','TX','TX','IN', 'CA','LA','NM','TX') group by rollup(i_category,i_class) order by lochierarchy desc ,case when lochierarchy = 0 then i_category end ,rank_within_parent limit 100
23/11/30 18:54:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1414:>                                                   (0 + 114) / 114][Stage 1414:===================================================>(113 + 1) / 114]                                                                                2023-11-30T18:54:37.290 END took 2237 ms: q36 - iteration 2
2023-11-30T18:54:37.291 ================================================================================
2023-11-30T18:54:37.291 ================================================================================
2023-11-30T18:54:37.291 START: q37 - iteration 2
2023-11-30T18:54:37.291 SQL:  select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 16 and 16 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-06-05' as date) and (cast('2002-06-05' as date) + interval 60 days) and i_manufact_id in (841,790,796,739) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100
23/11/30 18:54:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1418:>             (1 + 57) / 58][Stage 1420:=>              (1 + 8) / 9][Stage 1418:========>    (39 + 19) / 58][Stage 1420:=>              (1 + 8) / 9]                                                                                23/11/30 18:54:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:54:39.569 END took 2278 ms: q37 - iteration 2
2023-11-30T18:54:39.569 ================================================================================
2023-11-30T18:54:39.569 ================================================================================
2023-11-30T18:54:39.569 START: q38 - iteration 2
2023-11-30T18:54:39.569 SQL:  select  count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 ) hot_cust limit 100
23/11/30 18:54:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1424:(0 + 57) / 57][Stage 1425:(0 + 29) / 58][Stage 1426:(0 + 114) / 114][Stage 1424:(0 + 57) / 57][Stage 1425:(1 + 54) / 58][Stage 1426:(25 + 89) / 114][Stage 1424:=============>(54 + 3) / 57][Stage 1425:======>      (27 + 31) / 58][Stage 1425:===========================>                         (30 + 28) / 58][Stage 1425:==================================================>   (54 + 4) / 58]                                                                                2023-11-30T18:54:43.709 END took 4139 ms: q38 - iteration 2
2023-11-30T18:54:43.709 ================================================================================
2023-11-30T18:54:43.709 ================================================================================
2023-11-30T18:54:43.709 START: q39a - iteration 2
2023-11-30T18:54:43.709 SQL:  with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =1999 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=3 and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1436:=>              (1 + 8) / 9][Stage 1438:=>              (1 + 8) / 9][Stage 1436:==============> (8 + 1) / 9][Stage 1438:============>   (7 + 2) / 9]                                                                                2023-11-30T18:54:47.207 END took 3498 ms: q39a - iteration 2
2023-11-30T18:54:47.207 ================================================================================
2023-11-30T18:54:47.208 ================================================================================
2023-11-30T18:54:47.208 START: q39b - iteration 2
2023-11-30T18:54:47.208 SQL:  with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =1999 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=3 and inv2.d_moy=3+1 and inv1.cov > 1.5 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1451:=>              (1 + 8) / 9][Stage 1453:=>              (1 + 8) / 9][Stage 1451:========>       (5 + 4) / 9][Stage 1453:==========>     (6 + 3) / 9][Stage 1451:=================================================>      (8 + 1) / 9]                                                                                2023-11-30T18:54:50.043 END took 2835 ms: q39b - iteration 2
2023-11-30T18:54:50.043 ================================================================================
2023-11-30T18:54:50.043 ================================================================================
2023-11-30T18:54:50.043 START: q4 - iteration 2
2023-11-30T18:54:50.043 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total ,'c' sale_type from customer ,catalog_sales ,date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_c_firstyear ,year_total t_c_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = 's' and t_c_firstyear.sale_type = 'c' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_c_secyear.sale_type = 'c' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear =  1999 and t_s_secyear.dyear = 1999+1 and t_c_firstyear.dyear =  1999 and t_c_secyear.dyear =  1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total > 0 and t_c_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country limit 100
23/11/30 18:54:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1464:(0 + 57) / 57][Stage 1468:(0 + 114) / 114][Stage 1473:(0 + 29) / 58][Stage 1464:(18 + 39) / 57][Stage 1468:(1 + 113) / 114][Stage 1473:(0 + 48) / 58][Stage 1468:===========>(111 + 3) / 114][Stage 1473:======>      (28 + 30) / 58][Stage 1473:===========================>                         (30 + 28) / 58][Stage 1466:(111 + 8) / 200][Stage 1471:(0 + 0) / 200][Stage 1473:(30 + 28) / 58][Stage 1466:(169 + 8) / 200][Stage 1469:(0 + 0) / 200][Stage 1471:(0 + 0) / 200][Stage 1469:(3 + 5) / 200][Stage 1471:(0 + 0) / 200][Stage 1473:(47 + 11) / 58][Stage 1469:(8 + 9) / 200][Stage 1471:(0 + 0) / 200][Stage 1478:(5 + 0) / 200][Stage 1469:(35 + 9) / 200][Stage 1471:(0 + 0) / 200][Stage 1478:(5 + 0) / 200][Stage 1469:(71 + 9) / 200][Stage 1471:(0 + 0) / 200][Stage 1474:(0 + 0) / 200][Stage 1469:(112 + 9) / 200][Stage 1471:(0 + 0) / 200][Stage 1474:(0 + 0) / 200][Stage 1469:(155 + 9) / 200][Stage 1471:(0 + 0) / 200][Stage 1474:(0 + 0) / 200][Stage 1469:(199 + 1) / 200][Stage 1471:(0 + 8) / 200][Stage 1474:(0 + 0) / 200][Stage 1471:(8 + 4) / 200][Stage 1474:(0 + 0) / 200][Stage 1476:(0 + 0) / 200][Stage 1471:(31 + 9) / 200][Stage 1474:(0 + 0) / 200][Stage 1476:(0 + 0) / 200][Stage 1471:(67 + 9) / 200][Stage 1474:(0 + 0) / 200][Stage 1476:(0 + 0) / 200][Stage 1471:(108 + 9) / 200][Stage 1474:(0 + 0) / 200][Stage 1476:(0 + 0) / 200][Stage 1471:(152 + 9) / 200][Stage 1474:(0 + 0) / 200][Stage 1476:(0 + 0) / 200][Stage 1471:(193 + 7) / 200][Stage 1474:(0 + 2) / 200][Stage 1476:(0 + 0) / 200][Stage 1474:(16 + 9) / 200][Stage 1476:(0 + 0) / 200][Stage 1478:(5 + 191) / 200][Stage 1474:===>         (53 + 9) / 200][Stage 1476:>             (0 + 0) / 200][Stage 1474:======>      (94 + 9) / 200][Stage 1476:>             (0 + 0) / 200][Stage 1474:=========>  (151 + 9) / 200][Stage 1476:>             (0 + 0) / 200][Stage 1476:>                                                     (0 + 9) / 200][Stage 1476:====================>                              (80 + 120) / 200]                                                                                2023-11-30T18:54:59.047 END took 9004 ms: q4 - iteration 2
2023-11-30T18:54:59.048 ================================================================================
2023-11-30T18:54:59.048 ================================================================================
2023-11-30T18:54:59.048 START: q40 - iteration 2
2023-11-30T18:54:59.048 SQL:  select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-04-27' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('1999-04-27' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = cs_item_sk and cs_warehouse_sk    = w_warehouse_sk and cs_sold_date_sk    = d_date_sk and d_date between (cast ('1999-04-27' as date) - INTERVAL 30 days) and (cast ('1999-04-27' as date) + INTERVAL 30 days) group by w_state,i_item_id order by w_state,i_item_id limit 100
23/11/30 18:54:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:54:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:54:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1482:>                                                     (1 + 64) / 65][Stage 1482:==>                                                   (3 + 62) / 65][Stage 1482:=====================================================>(64 + 1) / 65]                                                                                23/11/30 18:55:00 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:00 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1485:>                                                     (1 + 57) / 58][Stage 1485:===================>                                 (21 + 37) / 58]                                                                                2023-11-30T18:55:02.729 END took 3681 ms: q40 - iteration 2
2023-11-30T18:55:02.729 ================================================================================
2023-11-30T18:55:02.729 ================================================================================
2023-11-30T18:55:02.729 START: q41 - iteration 2
2023-11-30T18:55:02.729 SQL:  select  distinct(i_product_name) from item i1 where i_manufact_id between 841 and 841+40 and (select count(*) as item_cnt from item where (i_manufact = i1.i_manufact and ((i_category = 'Women' and (i_color = 'bisque' or i_color = 'khaki') and (i_units = 'Carton' or i_units = 'Box') and (i_size = 'large' or i_size = 'extra large') ) or (i_category = 'Women' and (i_color = 'antique' or i_color = 'sandy') and (i_units = 'Pallet' or i_units = 'Cup') and (i_size = 'petite' or i_size = 'small') ) or (i_category = 'Men' and (i_color = 'forest' or i_color = 'brown') and (i_units = 'Dram' or i_units = 'Ton') and (i_size = 'economy' or i_size = 'medium') ) or (i_category = 'Men' and (i_color = 'chartreuse' or i_color = 'light') and (i_units = 'Pound' or i_units = 'Dozen') and (i_size = 'large' or i_size = 'extra large') ))) or (i_manufact = i1.i_manufact and ((i_category = 'Women' and (i_color = 'turquoise' or i_color = 'chocolate') and (i_units = 'Bundle' or i_units = 'Unknown') and (i_size = 'large' or i_size = 'extra large') ) or (i_category = 'Women' and (i_color = 'maroon' or i_color = 'pale') and (i_units = 'Each' or i_units = 'Tbl') and (i_size = 'petite' or i_size = 'small') ) or (i_category = 'Men' and (i_color = 'almond' or i_color = 'floral') and (i_units = 'Gross' or i_units = 'N/A') and (i_size = 'economy' or i_size = 'medium') ) or (i_category = 'Men' and (i_color = 'drab' or i_color = 'plum') and (i_units = 'Bunch' or i_units = 'Case') and (i_size = 'large' or i_size = 'extra large') )))) > 0 order by i_product_name limit 100
23/11/30 18:55:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:55:03.118 END took 388 ms: q41 - iteration 2
2023-11-30T18:55:03.118 ================================================================================
2023-11-30T18:55:03.118 ================================================================================
2023-11-30T18:55:03.118 START: q42 - iteration 2
2023-11-30T18:55:03.118 SQL:  select  dt.d_year ,item.i_category_id ,item.i_category ,sum(ss_ext_sales_price) from 	date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=2002 group by 	dt.d_year ,item.i_category_id ,item.i_category order by       sum(ss_ext_sales_price) desc,dt.d_year ,item.i_category_id ,item.i_category limit 100 
23/11/30 18:55:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1491:>                                                   (0 + 114) / 114][Stage 1491:==================================================> (111 + 3) / 114]                                                                                2023-11-30T18:55:05.058 END took 1940 ms: q42 - iteration 2
2023-11-30T18:55:05.058 ================================================================================
2023-11-30T18:55:05.058 ================================================================================
2023-11-30T18:55:05.058 START: q43 - iteration 2
2023-11-30T18:55:05.058 SQL:  select  s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from date_dim, store_sales, store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -5 and d_year = 2002 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales limit 100
23/11/30 18:55:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1495:>                                                   (0 + 114) / 114][Stage 1495:======>                                             (15 + 99) / 114]                                                                                2023-11-30T18:55:07.120 END took 2061 ms: q43 - iteration 2
2023-11-30T18:55:07.120 ================================================================================
2023-11-30T18:55:07.120 ================================================================================
2023-11-30T18:55:07.120 START: q44 - iteration 2
2023-11-30T18:55:07.120 SQL:  select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select * from (select item_sk,rank() over (order by rank_col asc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 709 group by ss_item_sk having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 709 and ss_addr_sk is null group by ss_store_sk))V1)V11 where rnk  < 11) asceding, (select * from (select item_sk,rank() over (order by rank_col desc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 709 group by ss_item_sk having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 709 and ss_addr_sk is null group by ss_store_sk))V2)V21 where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk and i1.i_item_sk=asceding.item_sk and i2.i_item_sk=descending.item_sk order by asceding.rnk limit 100
23/11/30 18:55:07 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:07 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:55:08.734 END took 1614 ms: q44 - iteration 2
2023-11-30T18:55:08.734 ================================================================================
2023-11-30T18:55:08.734 ================================================================================
2023-11-30T18:55:08.734 START: q45 - iteration 2
2023-11-30T18:55:08.734 SQL:  select  ca_zip, ca_state, sum(ws_sales_price) from web_sales, customer, customer_address, date_dim, item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 2002 group by ca_zip, ca_state order by ca_zip, ca_state limit 100
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1520:>                                                     (0 + 57) / 57][Stage 1520:====================================================> (55 + 2) / 57]                                                                                2023-11-30T18:55:10.962 END took 2228 ms: q45 - iteration 2
2023-11-30T18:55:10.962 ================================================================================
2023-11-30T18:55:10.962 ================================================================================
2023-11-30T18:55:10.962 START: q46 - iteration 2
2023-11-30T18:55:10.962 SQL:  select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,amt,profit from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count= 1) and date_dim.d_dow in (6,0) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in ('Johnson','Norwood','Cambridge','Klondike','Rock Hill') group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number limit 100
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1527:>                                                   (0 + 114) / 114][Stage 1527:======================>                             (50 + 64) / 114]                                                                                2023-11-30T18:55:13.403 END took 2440 ms: q46 - iteration 2
2023-11-30T18:55:13.403 ================================================================================
2023-11-30T18:55:13.403 ================================================================================
2023-11-30T18:55:13.403 START: q47 - iteration 2
2023-11-30T18:55:13.403 SQL:  with v1 as( select i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, s_store_name, s_company_name order by d_year, d_moy) rn from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ( d_year = 2001 or ( d_year = 2001-1 and d_moy =12) or ( d_year = 2001+1 and d_moy =1) ) group by i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 as( select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name ,v1.d_year, v1.d_moy ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1.s_store_name = v1_lag.s_store_name and v1.s_store_name = v1_lead.s_store_name and v1.s_company_name = v1_lag.s_company_name and v1.s_company_name = v1_lead.s_company_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 2001 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales, psum limit 100
23/11/30 18:55:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1532:>                                                   (0 + 114) / 114][Stage 1532:======================================>             (85 + 29) / 114]                                                                                2023-11-30T18:55:17.287 END took 3883 ms: q47 - iteration 2
2023-11-30T18:55:17.287 ================================================================================
2023-11-30T18:55:17.287 ================================================================================
2023-11-30T18:55:17.287 START: q48 - iteration 2
2023-11-30T18:55:17.287 SQL:  select sum (ss_quantity) from store_sales, store, customer_demographics, customer_address, date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2000 and ( ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 ) ) and ( ( ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'OH', 'GA') and ss_net_profit between 0 and 2000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('WV', 'AZ', 'NM') and ss_net_profit between 150 and 3000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'PA', 'KY') and ss_net_profit between 50 and 25000 ) )
23/11/30 18:55:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1544:>                                                   (0 + 114) / 114][Stage 1544:=======================================>            (87 + 27) / 114]                                                                                2023-11-30T18:55:19.752 END took 2465 ms: q48 - iteration 2
2023-11-30T18:55:19.752 ================================================================================
2023-11-30T18:55:19.752 ================================================================================
2023-11-30T18:55:19.753 START: q49 - iteration 2
2023-11-30T18:55:19.753 SQL:  select  channel, item, return_ratio, return_rank, currency_rank from (select 'web' as channel ,web.item ,web.return_ratio ,web.return_rank ,web.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select ws.ws_item_sk as item ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio from web_sales ws left outer join web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk) ,date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel ,catalog.item ,catalog.return_ratio ,catalog.return_rank ,catalog.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select cs.cs_item_sk as item ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio from catalog_sales cs left outer join catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk) ,date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel ,store.item ,store.return_ratio ,store.return_rank ,store.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select sts.ss_item_sk as item ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio from store_sales sts left outer join store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk) ,date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where  ( store.return_rank <= 10 or store.currency_rank <= 10 ) ) order by 1,4,5,2 limit 100
23/11/30 18:55:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 18:55:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1547:(1 + 16) / 17][Stage 1549:(0 + 14) / 14][Stage 1550:(1 + 27) / 28][Stage 1547:(1 + 16) / 17][Stage 1549:(1 + 13) / 14][Stage 1550:(1 + 27) / 28][Stage 1547:(13 + 4) / 17][Stage 1549:(12 + 2) / 14][Stage 1550:(8 + 20) / 28]                                                                                23/11/30 18:55:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1551:(0 + 114) / 114][Stage 1552:(0 + 29) / 58][Stage 1553:(0 + 57) / 57][Stage 1551:(78 + 36) / 114][Stage 1552:(12 + 46) / 58][Stage 1553:(56 + 1) / 57][Stage 1552:===========================>                         (30 + 28) / 58][Stage 1552:=============================>                       (32 + 26) / 58]                                                                                2023-11-30T18:55:25.401 END took 5648 ms: q49 - iteration 2
2023-11-30T18:55:25.401 ================================================================================
2023-11-30T18:55:25.401 ================================================================================
2023-11-30T18:55:25.401 START: q5 - iteration 2
2023-11-30T18:55:25.401 SQL:  with ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ss_store_sk as store_sk, ss_sold_date_sk  as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  cs_catalog_page_sk as page_sk, cs_sold_date_sk  as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk  as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and wsr_web_site_sk = web_site_sk group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from   ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from  csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1561:>                                                     (1 + 66) / 67][Stage 1561:=======================>                             (30 + 37) / 67]                                                                                23/11/30 18:55:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1564:(0 + 177) / 177][Stage 1565:(0 + 23) / 114][Stage 1566:(0 + 0) / 123][Stage 1564:(1 + 176) / 177][Stage 1565:(0 + 24) / 114][Stage 1566:(0 + 0) / 123][Stage 1564:(150 + 27) / 177][Stage 1565:(21 + 93) / 114][Stage 1566:(0 + 80) / 123][Stage 1565:==>         (23 + 91) / 114][Stage 1566:>           (0 + 109) / 123][Stage 1565:==>         (23 + 91) / 114][Stage 1566:>           (1 + 109) / 123][Stage 1565:==>         (24 + 90) / 114][Stage 1566:>           (1 + 110) / 123][Stage 1565:===>        (31 + 83) / 114][Stage 1566:>           (1 + 117) / 123][Stage 1565:===========>(112 + 2) / 114][Stage 1566:====>       (51 + 72) / 123][Stage 1566:============================================>      (108 + 15) / 123][Stage 1566:==============================================>    (111 + 12) / 123][Stage 1566:================================================>   (115 + 8) / 123]                                                                                2023-11-30T18:55:32.327 END took 6926 ms: q5 - iteration 2
2023-11-30T18:55:32.327 ================================================================================
2023-11-30T18:55:32.328 ================================================================================
2023-11-30T18:55:32.328 START: q50 - iteration 2
2023-11-30T18:55:32.328 SQL:  select s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from store_sales ,store_returns ,store ,date_dim d1 ,date_dim d2 where d2.d_year = 2000 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip order by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip limit 100
23/11/30 18:55:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1570:>                                                     (0 + 63) / 63][Stage 1570:>                                                     (1 + 62) / 63][Stage 1570:==>                                                   (3 + 60) / 63]                                                                                23/11/30 18:55:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1573:>                                                   (0 + 114) / 114][Stage 1573:==========>                                         (23 + 91) / 114]                                                                                2023-11-30T18:55:36.128 END took 3800 ms: q50 - iteration 2
2023-11-30T18:55:36.128 ================================================================================
2023-11-30T18:55:36.128 ================================================================================
2023-11-30T18:55:36.128 START: q51 - iteration 2
2023-11-30T18:55:36.128 SQL:  WITH web_v1 as ( select ws_item_sk item_sk, d_date, sum(sum(ws_sales_price)) over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales ,date_dim where ws_sold_date_sk=d_date_sk and d_month_seq between 1177 and 1177+11 and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select ss_item_sk item_sk, d_date, sum(sum(ss_sales_price)) over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales ,date_dim where ss_sold_date_sk=d_date_sk and d_month_seq between 1177 and 1177+11 and ss_item_sk is not NULL group by ss_item_sk, d_date) select  * from (select item_sk ,d_date ,web_sales ,store_sales ,max(web_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative ,max(store_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk ,case when web.d_date is not null then web.d_date else store.d_date end d_date ,web.cume_sales web_sales ,store.cume_sales store_sales from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk and web.d_date = store.d_date) )x )y where web_cumulative > store_cumulative order by item_sk ,d_date limit 100
23/11/30 18:55:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1576:>           (0 + 114) / 114][Stage 1578:>             (0 + 57) / 57][Stage 1576:==>         (21 + 93) / 114][Stage 1578:=========>   (41 + 16) / 57]                                                                                2023-11-30T18:55:39.200 END took 3072 ms: q51 - iteration 2
2023-11-30T18:55:39.200 ================================================================================
2023-11-30T18:55:39.200 ================================================================================
2023-11-30T18:55:39.200 START: q52 - iteration 2
2023-11-30T18:55:39.200 SQL:  select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_ext_sales_price) ext_price from date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=2001 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,ext_price desc ,brand_id limit 100 
23/11/30 18:55:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1586:>                                                   (0 + 114) / 114][Stage 1586:==============================================>    (104 + 10) / 114]                                                                                2023-11-30T18:55:41.005 END took 1804 ms: q52 - iteration 2
2023-11-30T18:55:41.005 ================================================================================
2023-11-30T18:55:41.005 ================================================================================
2023-11-30T18:55:41.005 START: q53 - iteration 2
2023-11-30T18:55:41.005 SQL:  select  * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id limit 100
23/11/30 18:55:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1591:>                                                   (0 + 114) / 114][Stage 1591:==========================================>         (94 + 20) / 114]                                                                                2023-11-30T18:55:43.170 END took 2165 ms: q53 - iteration 2
2023-11-30T18:55:43.170 ================================================================================
2023-11-30T18:55:43.170 ================================================================================
2023-11-30T18:55:43.170 START: q54 - iteration 2
2023-11-30T18:55:43.170 SQL:  with my_customers as ( select distinct c_customer_sk , c_current_addr_sk from ( select cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk from   catalog_sales union all select ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk from   web_sales ) cs_or_ws_sales, item, date_dim, customer where   sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'pants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 2002 ) , my_revenue as ( select c_customer_sk, sum(ss_ext_sales_price) as revenue from   my_customers, store_sales, customer_address, store, date_dim where  c_current_addr_sk = ca_address_sk and ca_county = s_county and ca_state = s_state and ss_sold_date_sk = d_date_sk and c_customer_sk = ss_customer_sk and d_month_seq between (select distinct d_month_seq+1 from   date_dim where d_year = 2002 and d_moy = 5) and  (select distinct d_month_seq+3 from   date_dim where d_year = 2002 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from   my_revenue ) select  segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1602:>           (1 + 114) / 115][Stage 1604:>            (0 + 86) / 114][Stage 1602:===========>(109 + 6) / 115][Stage 1604:=======>    (73 + 41) / 114][Stage 1604:=======================================>            (86 + 28) / 114][Stage 1604:==========================================>         (93 + 21) / 114]                                                                                2023-11-30T18:55:47.274 END took 4103 ms: q54 - iteration 2
2023-11-30T18:55:47.274 ================================================================================
2023-11-30T18:55:47.274 ================================================================================
2023-11-30T18:55:47.274 START: q55 - iteration 2
2023-11-30T18:55:47.274 SQL:  select  i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=67 and d_moy=11 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 
23/11/30 18:55:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1609:>                                                   (0 + 114) / 114][Stage 1609:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:55:49.170 END took 1896 ms: q55 - iteration 2
2023-11-30T18:55:49.170 ================================================================================
2023-11-30T18:55:49.170 ================================================================================
2023-11-30T18:55:49.170 START: q56 - iteration 2
2023-11-30T18:55:49.170 SQL:  with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id) select  i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales, i_item_id limit 100
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1615:(1 + 57) / 58][Stage 1616:(0 + 57) / 57][Stage 1617:(0 + 86) / 114][Stage 1616:==========>  (47 + 10) / 57][Stage 1617:======>     (64 + 50) / 114][Stage 1617:=======================================>            (86 + 28) / 114][Stage 1617:==============================================>    (104 + 10) / 114]                                                                                2023-11-30T18:55:53.352 END took 4181 ms: q56 - iteration 2
2023-11-30T18:55:53.352 ================================================================================
2023-11-30T18:55:53.352 ================================================================================
2023-11-30T18:55:53.352 START: q57 - iteration 2
2023-11-30T18:55:53.352 SQL:  with v1 as( select i_category, i_brand, cc_name, d_year, d_moy, sum(cs_sales_price) sum_sales, avg(sum(cs_sales_price)) over (partition by i_category, i_brand, cc_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, cc_name order by d_year, d_moy) rn from item, catalog_sales, date_dim, call_center where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and cc_call_center_sk= cs_call_center_sk and ( d_year = 2000 or ( d_year = 2000-1 and d_moy =12) or ( d_year = 2000+1 and d_moy =1) ) group by i_category, i_brand, cc_name , d_year, d_moy), v2 as( select v1.i_category, v1.i_brand ,v1.d_year ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1. cc_name = v1_lag. cc_name and v1. cc_name = v1_lead. cc_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 2000 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales, sum_sales limit 100
23/11/30 18:55:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1623:>                                                     (1 + 57) / 58][Stage 1623:=======================>                             (26 + 32) / 58]                                                                                2023-11-30T18:55:57.152 END took 3799 ms: q57 - iteration 2
2023-11-30T18:55:57.152 ================================================================================
2023-11-30T18:55:57.152 ================================================================================
2023-11-30T18:55:57.152 START: q58 - iteration 2
2023-11-30T18:55:57.152 SQL:  with ss_items as (select i_item_id item_id ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '2000-05-24')) and ss_sold_date_sk   = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '2000-05-24')) and  cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq =(select d_week_seq from date_dim where d_date = '2000-05-24')) and ws_sold_date_sk   = d_date_sk group by i_item_id) select  ss_items.item_id ,ss_item_rev ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev ,cs_item_rev ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev ,ws_item_rev ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id ,ss_item_rev limit 100
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:55:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1639:(0 + 57) / 57][Stage 1640:(0 + 114) / 114][Stage 1641:(0 + 29) / 58][Stage 1639:(14 + 43) / 57][Stage 1640:(0 + 114) / 114][Stage 1641:(0 + 43) / 58][Stage 1641:=========================>                           (28 + 30) / 58][Stage 1641:===========================>                         (30 + 28) / 58][Stage 1641:===================================================>  (55 + 3) / 58]                                                                                2023-11-30T18:56:01.122 END took 3969 ms: q58 - iteration 2
2023-11-30T18:56:01.122 ================================================================================
2023-11-30T18:56:01.122 ================================================================================
2023-11-30T18:56:01.122 START: q59 - iteration 2
2023-11-30T18:56:01.122 SQL:  with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select  s_store_name1,s_store_id1,d_week_seq1 ,sun_sales1/sun_sales2,mon_sales1/mon_sales2 ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2 ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1 ,s_store_id s_store_id1,sun_sales sun_sales1 ,mon_sales mon_sales1,tue_sales tue_sales1 ,wed_sales wed_sales1,thu_sales thu_sales1 ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1197 and 1197 + 11) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2 ,s_store_id s_store_id2,sun_sales sun_sales2 ,mon_sales mon_sales2,tue_sales tue_sales2 ,wed_sales wed_sales2,thu_sales thu_sales2 ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1197+ 12 and 1197 + 23) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1648:>                                                   (0 + 114) / 114][Stage 1648:>                                                   (1 + 113) / 114]                                                                                2023-11-30T18:56:04.006 END took 2883 ms: q59 - iteration 2
2023-11-30T18:56:04.006 ================================================================================
2023-11-30T18:56:04.006 ================================================================================
2023-11-30T18:56:04.006 START: q6 - iteration 2
2023-11-30T18:56:04.006 SQL:  select  a.ca_state state, count(*) cnt from customer_address a ,customer c ,store_sales s ,date_dim d ,item i where       a.ca_address_sk = c.c_current_addr_sk and c.c_customer_sk = s.ss_customer_sk and s.ss_sold_date_sk = d.d_date_sk and s.ss_item_sk = i.i_item_sk and d.d_month_seq = (select distinct (d_month_seq) from date_dim where d_year = 2002 and d_moy = 3 ) and i.i_current_price > 1.2 * (select avg(j.i_current_price) from item j where j.i_category = i.i_category) group by a.ca_state having count(*) >= 10 order by cnt, a.ca_state limit 100
23/11/30 18:56:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1656:>                                                   (0 + 114) / 114][Stage 1656:==================================================> (111 + 3) / 114][Stage 1658:=======================================>           (155 + 11) / 200]                                                                                2023-11-30T18:56:07.320 END took 3313 ms: q6 - iteration 2
2023-11-30T18:56:07.320 ================================================================================
2023-11-30T18:56:07.320 ================================================================================
2023-11-30T18:56:07.320 START: q60 - iteration 2
2023-11-30T18:56:07.320 SQL:  with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_category in ('Shoes')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in ('Shoes')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in ('Shoes')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by i_item_id ,total_sales limit 100
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1666:(0 + 57) / 57][Stage 1667:(1 + 57) / 58][Stage 1668:(0 + 86) / 114][Stage 1666:(1 + 56) / 57][Stage 1667:(1 + 57) / 58][Stage 1668:(0 + 87) / 114][Stage 1667:===========>  (49 + 9) / 58][Stage 1668:========>   (77 + 37) / 114][Stage 1668:=======================================>            (86 + 28) / 114][Stage 1668:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:56:11.241 END took 3920 ms: q60 - iteration 2
2023-11-30T18:56:11.241 ================================================================================
2023-11-30T18:56:11.241 ================================================================================
2023-11-30T18:56:11.241 START: q61 - iteration 2
2023-11-30T18:56:11.241 SQL:  select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from  store_sales ,store ,promotion ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_promo_sk = p_promo_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -7 and   i_category = 'Jewelry' and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and   s_gmt_offset = -7 and   d_year = 2002 and   d_moy  = 11) promotional_sales, (select sum(ss_ext_sales_price) total from  store_sales ,store ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -7 and   i_category = 'Jewelry' and   s_gmt_offset = -7 and   d_year = 2002 and   d_moy  = 11) all_sales order by promotions, total limit 100
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1676:>                                                   (0 + 114) / 114][Stage 1676:=============================================>      (99 + 15) / 114]                                                                                [Stage 1678:>                                                   (0 + 114) / 114][Stage 1678:============================>                       (63 + 51) / 114]                                                                                2023-11-30T18:56:14.976 END took 3734 ms: q61 - iteration 2
2023-11-30T18:56:14.976 ================================================================================
2023-11-30T18:56:14.976 ================================================================================
2023-11-30T18:56:14.976 START: q62 - iteration 2
2023-11-30T18:56:14.976 SQL:  select substr(w_warehouse_name,1,20) ,sm_type ,web_name ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from web_sales ,warehouse ,ship_mode ,web_site ,date_dim where d_month_seq between 1194 and 1194 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by substr(w_warehouse_name,1,20) ,sm_type ,web_name order by substr(w_warehouse_name,1,20) ,sm_type ,web_name limit 100
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1684:>                                                     (0 + 57) / 57][Stage 1684:================>                                    (18 + 39) / 57]                                                                                2023-11-30T18:56:17.287 END took 2311 ms: q62 - iteration 2
2023-11-30T18:56:17.287 ================================================================================
2023-11-30T18:56:17.287 ================================================================================
2023-11-30T18:56:17.287 START: q63 - iteration 2
2023-11-30T18:56:17.287 SQL:  select  * from (select i_manager_id ,sum(ss_sales_price) sum_sales ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from item ,store_sales ,date_dim ,store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1222,1222+1,1222+2,1222+3,1222+4,1222+5,1222+6,1222+7,1222+8,1222+9,1222+10,1222+11) and ((    i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(    i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id ,avg_monthly_sales ,sum_sales limit 100
23/11/30 18:56:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1689:>                                                   (0 + 114) / 114][Stage 1689:=================================================>  (108 + 6) / 114]                                                                                2023-11-30T18:56:19.415 END took 2127 ms: q63 - iteration 2
2023-11-30T18:56:19.415 ================================================================================
2023-11-30T18:56:19.415 ================================================================================
2023-11-30T18:56:19.415 START: q64 - iteration 2
2023-11-30T18:56:19.415 SQL:  with cs_ui as (select cs_item_sk ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM   store_sales ,store_returns ,cs_ui ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,customer ,customer_demographics cd1 ,customer_demographics cd2 ,promotion ,household_demographics hd1 ,household_demographics hd2 ,customer_address ad1 ,customer_address ad2 ,income_band ib1 ,income_band ib2 ,item WHERE  ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_color in ('ivory','purple','almond','bisque','lawn','azure') and i_current_price between 60 and 60 + 10 and i_current_price between 60 + 1 and 60 + 15 group by i_product_name ,i_item_sk ,s_store_name ,s_zip ,ad1.ca_street_number ,ad1.ca_street_name ,ad1.ca_city ,ad1.ca_zip ,ad2.ca_street_number ,ad2.ca_street_name ,ad2.ca_city ,ad2.ca_zip ,d1.d_year ,d2.d_year ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name ,cs1.store_name ,cs2.cnt ,cs1.s1 ,cs2.s1
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1693:>             (1 + 62) / 63][Stage 1696:>             (1 + 64) / 65][Stage 1693:==>          (12 + 51) / 63][Stage 1696:>             (1 + 64) / 65][Stage 1693:=============>(62 + 1) / 63][Stage 1696:============> (57 + 8) / 65]                                                                                23/11/30 18:56:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1704:(0 + 114) / 114][Stage 1705:(0 + 58) / 58][Stage 1706:> (0 + 1) / 1][Stage 1704:>           (0 + 114) / 114][Stage 1705:>             (1 + 57) / 58][Stage 1704:=>         (11 + 103) / 114][Stage 1705:>             (1 + 57) / 58][Stage 1704:===========>(111 + 3) / 114][Stage 1705:=============>(57 + 1) / 58][Stage 1712:=====>                                               (19 + 0) / 200][Stage 1708:========>  (157 + 11) / 200][Stage 1712:=>           (19 + 0) / 200][Stage 1712:=========>                                           (35 + 7) / 200][Stage 1712:===========>                                         (42 + 0) / 200][Stage 1712:=============>                                      (51 + 11) / 200][Stage 1712:==========================>                        (105 + 11) / 200][Stage 1712:=============================================>     (179 + 12) / 200]                                                                                2023-11-30T18:56:29.594 END took 10178 ms: q64 - iteration 2
2023-11-30T18:56:29.594 ================================================================================
2023-11-30T18:56:29.594 ================================================================================
2023-11-30T18:56:29.594 START: q65 - iteration 2
2023-11-30T18:56:29.594 SQL:  select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc limit 100
23/11/30 18:56:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1732:>           (0 + 114) / 114][Stage 1734:>            (0 + 86) / 114][Stage 1732:==>         (19 + 95) / 114][Stage 1734:>           (0 + 106) / 114][Stage 1732:===========>(113 + 1) / 114][Stage 1734:========>   (85 + 29) / 114][Stage 1734:=======================================>            (86 + 28) / 114]                                                                                2023-11-30T18:56:33.026 END took 3431 ms: q65 - iteration 2
2023-11-30T18:56:33.026 ================================================================================
2023-11-30T18:56:33.026 ================================================================================
2023-11-30T18:56:33.026 START: q66 - iteration 2
2023-11-30T18:56:33.026 SQL:  select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year ,sum(jan_sales) as jan_sales ,sum(feb_sales) as feb_sales ,sum(mar_sales) as mar_sales ,sum(apr_sales) as apr_sales ,sum(may_sales) as may_sales ,sum(jun_sales) as jun_sales ,sum(jul_sales) as jul_sales ,sum(aug_sales) as aug_sales ,sum(sep_sales) as sep_sales ,sum(oct_sales) as oct_sales ,sum(nov_sales) as nov_sales ,sum(dec_sales) as dec_sales ,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot ,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot ,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot ,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot ,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot ,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot ,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot ,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot ,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot ,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot ,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot ,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot ,sum(jan_net) as jan_net ,sum(feb_net) as feb_net ,sum(mar_net) as mar_net ,sum(apr_net) as apr_net ,sum(may_net) as may_net ,sum(jun_net) as jun_net ,sum(jul_net) as jul_net ,sum(aug_net) as aug_net ,sum(sep_net) as sep_net ,sum(oct_net) as oct_net ,sum(nov_net) as nov_net ,sum(dec_net) as dec_net from ( select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,'FEDEX' || ',' || 'MSC' as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then ws_ext_list_price* ws_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then ws_ext_list_price* ws_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then ws_ext_list_price* ws_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then ws_ext_list_price* ws_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then ws_ext_list_price* ws_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then ws_ext_list_price* ws_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then ws_ext_list_price* ws_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then ws_ext_list_price* ws_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then ws_ext_list_price* ws_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then ws_ext_list_price* ws_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then ws_ext_list_price* ws_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then ws_ext_list_price* ws_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then ws_net_profit * ws_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then ws_net_profit * ws_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then ws_net_profit * ws_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then ws_net_profit * ws_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then ws_net_profit * ws_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then ws_net_profit * ws_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then ws_net_profit * ws_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then ws_net_profit * ws_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then ws_net_profit * ws_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then ws_net_profit * ws_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then ws_net_profit * ws_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then ws_net_profit * ws_quantity else 0 end) as dec_net from web_sales ,warehouse ,date_dim ,time_dim ,ship_mode where ws_warehouse_sk =  w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2002 and t_time between 2662 and 2662+28800 and sm_carrier in ('FEDEX','MSC') group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year union all select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,'FEDEX' || ',' || 'MSC' as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then cs_ext_list_price* cs_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then cs_ext_list_price* cs_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then cs_ext_list_price* cs_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then cs_ext_list_price* cs_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then cs_ext_list_price* cs_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then cs_ext_list_price* cs_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then cs_ext_list_price* cs_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then cs_ext_list_price* cs_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then cs_ext_list_price* cs_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then cs_ext_list_price* cs_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then cs_ext_list_price* cs_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then cs_ext_list_price* cs_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then cs_net_profit * cs_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then cs_net_profit * cs_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then cs_net_profit * cs_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then cs_net_profit * cs_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then cs_net_profit * cs_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then cs_net_profit * cs_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then cs_net_profit * cs_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then cs_net_profit * cs_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then cs_net_profit * cs_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then cs_net_profit * cs_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then cs_net_profit * cs_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then cs_net_profit * cs_quantity else 0 end) as dec_net from catalog_sales ,warehouse ,date_dim ,time_dim ,ship_mode where cs_warehouse_sk =  w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2002 and t_time between 2662 AND 2662+28800 and sm_carrier in ('FEDEX','MSC') group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year ) x group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year order by w_warehouse_name limit 100
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1741:>             (0 + 57) / 57][Stage 1742:>             (1 + 57) / 58][Stage 1741:=====>       (22 + 35) / 57][Stage 1742:=>            (8 + 50) / 58]                                                                                2023-11-30T18:56:36.425 END took 3399 ms: q66 - iteration 2
2023-11-30T18:56:36.425 ================================================================================
2023-11-30T18:56:36.425 ================================================================================
2023-11-30T18:56:36.425 START: q67 - iteration 2
2023-11-30T18:56:36.425 SQL:  select  * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1177 and 1177+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100
23/11/30 18:56:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1748:>                                                   (0 + 114) / 114][Stage 1748:>                                                   (1 + 113) / 114][Stage 1748:===========================================>        (95 + 19) / 114][Stage 1748:==================================================> (110 + 4) / 114][Stage 1748:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:56:39.461 END took 3035 ms: q67 - iteration 2
2023-11-30T18:56:39.461 ================================================================================
2023-11-30T18:56:39.461 ================================================================================
2023-11-30T18:56:39.461 START: q68 - iteration 2
2023-11-30T18:56:39.461 SQL:  select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,extended_price ,extended_tax ,list_price from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_ext_sales_price) extended_price ,sum(ss_ext_list_price) list_price ,sum(ss_ext_tax) extended_tax from store_sales ,date_dim ,store ,household_demographics ,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count= 4) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in ('Lodi','Richmond') group by ss_ticket_number ,ss_customer_sk ,ss_addr_sk,ca_city) dn ,customer ,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ,ss_ticket_number limit 100
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1756:>                                                   (0 + 114) / 114][Stage 1756:=>                                                  (3 + 111) / 114]                                                                                2023-11-30T18:56:41.918 END took 2456 ms: q68 - iteration 2
2023-11-30T18:56:41.918 ================================================================================
2023-11-30T18:56:41.918 ================================================================================
2023-11-30T18:56:41.918 START: q69 - iteration 2
2023-11-30T18:56:41.918 SQL:  select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','FL','SD') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2) and (not exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2) and not exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100
23/11/30 18:56:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1761:(0 + 114) / 114][Stage 1762:(1 + 57) / 58][Stage 1763:(0 + 28) / 57][Stage 1761:(106 + 8) / 114][Stage 1762:(16 + 42) / 58][Stage 1763:(17 + 40) / 57][Stage 1763:=========================>                           (27 + 30) / 57][Stage 1763:==========================>                          (28 + 29) / 57]                                                                                2023-11-30T18:56:46.399 END took 4481 ms: q69 - iteration 2
2023-11-30T18:56:46.400 ================================================================================
2023-11-30T18:56:46.400 ================================================================================
2023-11-30T18:56:46.400 START: q7 - iteration 2
2023-11-30T18:56:46.400 SQL:  select  i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, item, promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id limit 100
23/11/30 18:56:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1771:>                                                   (0 + 114) / 114][Stage 1771:>                                                   (1 + 113) / 114]                                                                                2023-11-30T18:56:48.928 END took 2528 ms: q7 - iteration 2
2023-11-30T18:56:48.928 ================================================================================
2023-11-30T18:56:48.928 ================================================================================
2023-11-30T18:56:48.928 START: q70 - iteration 2
2023-11-30T18:56:48.928 SQL:  select sum(ss_net_profit) as total_sum ,s_state ,s_county ,grouping(s_state)+grouping(s_county) as lochierarchy ,rank() over ( partition by grouping(s_state)+grouping(s_county), case when grouping(s_county) = 0 then s_state end order by sum(ss_net_profit) desc) as rank_within_parent from store_sales ,date_dim       d1 ,store where d1.d_month_seq between 1206 and 1206+11 and d1.d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk and s_state in ( select s_state from  (select s_state as s_state, rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking from   store_sales, store, date_dim where  d_month_seq between 1206 and 1206+11 and d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk group by s_state ) tmp1 where ranking <= 5 ) group by rollup(s_state,s_county) order by lochierarchy desc ,case when lochierarchy = 0 then s_state end ,rank_within_parent limit 100
23/11/30 18:56:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1777:>                                                   (0 + 114) / 114][Stage 1777:===================================================>(112 + 2) / 114]                                                                                23/11/30 18:56:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1782:>                                                   (0 + 114) / 114][Stage 1782:======>                                            (14 + 100) / 114]                                                                                2023-11-30T18:56:53.125 END took 4197 ms: q70 - iteration 2
2023-11-30T18:56:53.125 ================================================================================
2023-11-30T18:56:53.125 ================================================================================
2023-11-30T18:56:53.125 START: q71 - iteration 2
2023-11-30T18:56:53.125 SQL:  select i_brand_id brand_id, i_brand brand,t_hour,t_minute, sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price, ws_sold_date_sk as sold_date_sk, ws_item_sk as sold_item_sk, ws_sold_time_sk as time_sk from web_sales,date_dim where d_date_sk = ws_sold_date_sk and d_moy=11 and d_year=1999 union all select cs_ext_sales_price as ext_price, cs_sold_date_sk as sold_date_sk, cs_item_sk as sold_item_sk, cs_sold_time_sk as time_sk from catalog_sales,date_dim where d_date_sk = cs_sold_date_sk and d_moy=11 and d_year=1999 union all select ss_ext_sales_price as ext_price, ss_sold_date_sk as sold_date_sk, ss_item_sk as sold_item_sk, ss_sold_time_sk as time_sk from store_sales,date_dim where d_date_sk = ss_sold_date_sk and d_moy=11 and d_year=1999 ) tmp,time_dim where sold_item_sk = i_item_sk and i_manager_id=1 and time_sk = t_time_sk and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id 
23/11/30 18:56:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1788:>                                                   (1 + 200) / 229][Stage 1788:===============>                                   (69 + 160) / 229][Stage 1788:============================================>      (199 + 30) / 229][Stage 1788:============================================>      (201 + 28) / 229]                                                                                2023-11-30T18:56:56.688 END took 3563 ms: q71 - iteration 2
2023-11-30T18:56:56.688 ================================================================================
2023-11-30T18:56:56.688 ================================================================================
2023-11-30T18:56:56.688 START: q72 - iteration 2
2023-11-30T18:56:56.688 SQL:  select  i_item_desc ,w_warehouse_name ,d1.d_week_seq ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo ,sum(case when p_promo_sk is not null then 1 else 0 end) promo ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand < cs_quantity and d3.d_date > d1.d_date + interval 5 days and hd_buy_potential = '1001-5000' and d1.d_year = 2000 and cd_marital_status = 'S' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq limit 100
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1800:>                                                     (1 + 64) / 65][Stage 1800:==>                                                   (3 + 62) / 65][Stage 1800:====================================================> (63 + 2) / 65]                                                                                23/11/30 18:56:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:56:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1801:>             (1 + 57) / 58][Stage 1802:=>              (1 + 8) / 9][Stage 1801:==>          (11 + 47) / 58][Stage 1802:=>              (1 + 8) / 9][Stage 1801:=============>(57 + 1) / 58][Stage 1802:=>              (1 + 8) / 9][Stage 1802:======>                                                 (1 + 8) / 9][Stage 1802:=================================================>      (8 + 1) / 9][Stage 1804:==================================================> (195 + 5) / 200][Stage 1805:=====>                                              (22 + 11) / 200][Stage 1805:==========>                                         (39 + 11) / 200][Stage 1805:================>                                   (64 + 11) / 200][Stage 1805:======================>                             (88 + 11) / 200][Stage 1805:============================>                      (111 + 11) / 200][Stage 1805:==================================>                (135 + 11) / 200][Stage 1805:=========================================>         (161 + 11) / 200][Stage 1805:==============================================>    (183 + 11) / 200]                                                                                2023-11-30T18:57:03.988 END took 7299 ms: q72 - iteration 2
2023-11-30T18:57:03.988 ================================================================================
2023-11-30T18:57:03.988 ================================================================================
2023-11-30T18:57:03.988 START: q73 - iteration 2
2023-11-30T18:57:03.988 SQL:  select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = 'Unknown') and household_demographics.hd_vehicle_count > 0 and case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_county in ('Humboldt County','Hickman County','Galax city','Abbeville County') group by ss_ticket_number,ss_customer_sk) dj,customer where ss_customer_sk = c_customer_sk and cnt between 1 and 5 order by cnt desc, c_last_name asc
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1811:>                                                   (0 + 114) / 114][Stage 1811:============>                                       (27 + 87) / 114]                                                                                2023-11-30T18:57:06.566 END took 2577 ms: q73 - iteration 2
2023-11-30T18:57:06.566 ================================================================================
2023-11-30T18:57:06.566 ================================================================================
2023-11-30T18:57:06.566 START: q74 - iteration 2
2023-11-30T18:57:06.566 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,max(ss_net_paid) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2001,2001+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,max(ws_net_paid) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year in (2001,2001+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year ) select t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.year = 2001 and t_s_secyear.year = 2001+1 and t_w_firstyear.year = 2001 and t_w_secyear.year = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end order by 3,1,2 limit 100
23/11/30 18:57:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1819:(0 + 57) / 57][Stage 1821:(0 + 114) / 114][Stage 1823:(0 + 29) / 114][Stage 1819:(50 + 7) / 57][Stage 1821:(78 + 36) / 114][Stage 1823:(18 + 96) / 114][Stage 1823:===>        (29 + 85) / 114][Stage 1825:>             (0 + 57) / 57][Stage 1820:(196 + 0) / 200][Stage 1823:(29 + 85) / 114][Stage 1825:(0 + 57) / 57][Stage 1825:==========================>                          (28 + 29) / 57]                                                                                2023-11-30T18:57:11.219 END took 4652 ms: q74 - iteration 2
2023-11-30T18:57:11.219 ================================================================================
2023-11-30T18:57:11.219 ================================================================================
2023-11-30T18:57:11.219 START: q75 - iteration 2
2023-11-30T18:57:11.219 SQL:  WITH all_sales AS ( SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,SUM(sales_cnt) AS sales_cnt ,SUM(sales_amt) AS sales_amt FROM (SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk JOIN date_dim ON d_date_sk=cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number AND cs_item_sk=cr_item_sk) WHERE i_category='Books' UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk=ss_item_sk JOIN date_dim ON d_date_sk=ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number AND ss_item_sk=sr_item_sk) WHERE i_category='Books' UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk=ws_item_sk JOIN date_dim ON d_date_sk=ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number=wr_order_number AND ws_item_sk=wr_item_sk) WHERE i_category='Books') sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT  prev_yr.d_year AS prev_year ,curr_yr.d_year AS year ,curr_yr.i_brand_id ,curr_yr.i_class_id ,curr_yr.i_category_id ,curr_yr.i_manufact_id ,prev_yr.sales_cnt AS prev_yr_cnt ,curr_yr.sales_cnt AS curr_yr_cnt ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff FROM all_sales curr_yr, all_sales prev_yr WHERE curr_yr.i_brand_id=prev_yr.i_brand_id AND curr_yr.i_class_id=prev_yr.i_class_id AND curr_yr.i_category_id=prev_yr.i_category_id AND curr_yr.i_manufact_id=prev_yr.i_manufact_id AND curr_yr.d_year=2001 AND prev_yr.d_year=2001-1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9 ORDER BY sales_cnt_diff,sales_amt_diff limit 100
23/11/30 18:57:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1828:(1 + 64) / 65][Stage 1829:(1 + 66) / 67][Stage 1831:(1 + 62) / 63][Stage 1828:(11 + 54) / 65][Stage 1829:(1 + 66) / 67][Stage 1831:(4 + 59) / 63][Stage 1828:(64 + 1) / 65][Stage 1829:(57 + 10) / 67][Stage 1831:(61 + 2) / 63]                                                                                23/11/30 18:57:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1834:>           (0 + 200) / 229][Stage 1837:>             (0 + 0) / 229][Stage 1834:>           (1 + 200) / 229][Stage 1837:>             (0 + 0) / 229][Stage 1834:>          (16 + 200) / 229][Stage 1837:>             (0 + 0) / 229][Stage 1834:=========> (190 + 39) / 229][Stage 1837:>           (0 + 162) / 229][Stage 1834:=========> (201 + 28) / 229][Stage 1837:>           (1 + 172) / 229][Stage 1834:===========>(228 + 1) / 229][Stage 1837:>           (8 + 199) / 229][Stage 1837:==================================>                (157 + 72) / 229][Stage 1837:======================================>            (173 + 56) / 229][Stage 1837:======================================>            (175 + 54) / 229][Stage 1837:=============================================>     (206 + 23) / 229]                                                                                2023-11-30T18:57:19.960 END took 8740 ms: q75 - iteration 2
2023-11-30T18:57:19.960 ================================================================================
2023-11-30T18:57:19.960 ================================================================================
2023-11-30T18:57:19.960 START: q76 - iteration 2
2023-11-30T18:57:19.960 SQL:  select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM ( SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price FROM store_sales, item, date_dim WHERE ss_promo_sk IS NULL AND ss_sold_date_sk=d_date_sk AND ss_item_sk=i_item_sk UNION ALL SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price FROM web_sales, item, date_dim WHERE ws_ship_addr_sk IS NULL AND ws_sold_date_sk=d_date_sk AND ws_item_sk=i_item_sk UNION ALL SELECT 'catalog' as channel, 'cs_ship_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price FROM catalog_sales, item, date_dim WHERE cs_ship_customer_sk IS NULL AND cs_sold_date_sk=d_date_sk AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100
23/11/30 18:57:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1843:>                                                   (2 + 161) / 163][Stage 1843:>                                                   (3 + 160) / 163][Stage 1843:=============================================>     (146 + 17) / 163]                                                                                2023-11-30T18:57:22.363 END took 2403 ms: q76 - iteration 2
2023-11-30T18:57:22.363 ================================================================================
2023-11-30T18:57:22.363 ================================================================================
2023-11-30T18:57:22.363 START: q77 - iteration 2
2023-11-30T18:57:22.363 SQL:  with ss as (select s_store_sk, sum(ss_ext_sales_price) as sales, sum(ss_net_profit) as profit from store_sales, date_dim, store where ss_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and ss_store_sk = s_store_sk group by s_store_sk) , sr as (select s_store_sk, sum(sr_return_amt) as returns, sum(sr_net_loss) as profit_loss from store_returns, date_dim, store where sr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and sr_store_sk = s_store_sk group by s_store_sk), cs as (select cs_call_center_sk, sum(cs_ext_sales_price) as sales, sum(cs_net_profit) as profit from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) group by cs_call_center_sk ), cr as (select cr_call_center_sk, sum(cr_return_amount) as returns, sum(cr_net_loss) as profit_loss from catalog_returns, date_dim where cr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) group by cr_call_center_sk ), ws as ( select wp_web_page_sk, sum(ws_ext_sales_price) as sales, sum(ws_net_profit) as profit from web_sales, date_dim, web_page where ws_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and ws_web_page_sk = wp_web_page_sk group by wp_web_page_sk), wr as (select wp_web_page_sk, sum(wr_return_amt) as returns, sum(wr_net_loss) as profit_loss from web_returns, date_dim, web_page where wr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and wr_web_page_sk = wp_web_page_sk group by wp_web_page_sk) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , ss.s_store_sk as id , sales , coalesce(returns, 0) as returns , (profit - coalesce(profit_loss,0)) as profit from   ss left join sr on  ss.s_store_sk = sr.s_store_sk union all select 'catalog channel' as channel , cs_call_center_sk as id , sales , returns , (profit - profit_loss) as profit from  cs , cr union all select 'web channel' as channel , ws.wp_web_page_sk as id , sales , coalesce(returns, 0) returns , (profit - coalesce(profit_loss,0)) as profit from   ws left join wr on  ws.wp_web_page_sk = wr.wp_web_page_sk ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 18:57:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1848:(1 + 57) / 58][Stage 1849:(0 + 57) / 57][Stage 1850:(0 + 86) / 114][Stage 1848:(14 + 44) / 58][Stage 1849:(0 + 57) / 57][Stage 1850:(0 + 99) / 114][Stage 1849:(55 + 2) / 57][Stage 1850:(80 + 34) / 114][Stage 1851:(0 + 66) / 66][Stage 1850:(86 + 28) / 114][Stage 1851:(0 + 66) / 66][Stage 1852:(0 + 65) / 65][Stage 1850:(86 + 28) / 114][Stage 1851:(0 + 66) / 66][Stage 1852:(1 + 64) / 65][Stage 1850:(111 + 3) / 114][Stage 1851:(0 + 66) / 66][Stage 1852:(1 + 64) / 65][Stage 1851:(60 + 6) / 66][Stage 1852:(50 + 15) / 65][Stage 1853:(20 + 43) / 63][Stage 1853:==================================>                  (41 + 22) / 63][Stage 1853:===================================>                 (42 + 21) / 63][Stage 1853:====================================>                (43 + 20) / 63][Stage 1854:=>                                             (1526 + 202) / 40400][Stage 1854:==>                                            (2331 + 308) / 40400][Stage 1854:===>                                           (3052 + 204) / 40400][Stage 1854:====>                                          (3771 + 214) / 40400][Stage 1854:=====>                                         (4544 + 202) / 40400][Stage 1854:=====>                                         (5145 + 225) / 40400][Stage 1854:======>                                        (5918 + 214) / 40400][Stage 1854:=======>                                       (6491 + 204) / 40400][Stage 1854:========>                                      (7225 + 201) / 40400][Stage 1854:=========>                                     (7953 + 207) / 40400]23/11/30 18:57:30 WARN AsyncEventQueue: Dropped 34484 events from eventLog since Thu Nov 30 18:50:14 IST 2023.
[Stage 1854:=========>                                     (8460 + 239) / 40400][Stage 1854:==========>                                    (9211 + 233) / 40400][Stage 1854:===========>                                   (9707 + 209) / 40400][Stage 1854:===========>                                  (10234 + 259) / 40400][Stage 1854:============>                                 (10727 + 244) / 40400]23/11/30 18:57:32 ERROR AsyncEventQueue: Dropping event from queue executorManagement. This likely means one of the listeners is too slow and cannot keep up with the rate at which tasks are being started by the scheduler.
23/11/30 18:57:32 WARN AsyncEventQueue: Dropped 1 events from executorManagement since the application started.
[Stage 1854:============>                                 (11321 + 275) / 40400][Stage 1854:=============>                                (11967 + 203) / 40400][Stage 1854:==============>                               (12583 + 227) / 40400][Stage 1854:===============>                              (13198 + 202) / 40400][Stage 1854:===============>                              (13704 + 314) / 40400][Stage 1854:================>                             (14419 + 233) / 40400][Stage 1854:================>                             (14782 + 257) / 40400][Stage 1854:=================>                            (15516 + 210) / 40400][Stage 1854:==================>                           (15894 + 260) / 40400][Stage 1854:==================>                           (16501 + 221) / 40400][Stage 1854:===================>                          (17096 + 202) / 40400][Stage 1854:====================>                         (17903 + 215) / 40400][Stage 1854:=====================>                        (18533 + 211) / 40400][Stage 1854:=====================>                        (19288 + 214) / 40400][Stage 1854:======================>                       (19891 + 203) / 40400][Stage 1854:=======================>                      (20625 + 293) / 40400][Stage 1854:========================>                     (21259 + 206) / 40400][Stage 1854:=========================>                    (22037 + 235) / 40400][Stage 1854:=========================>                    (22743 + 214) / 40400][Stage 1854:==========================>                   (23558 + 204) / 40400][Stage 1854:===========================>                  (24342 + 223) / 40400][Stage 1854:============================>                 (25196 + 226) / 40400][Stage 1854:=============================>                (25813 + 258) / 40400][Stage 1854:==============================>               (26645 + 206) / 40400][Stage 1854:===============================>              (27381 + 218) / 40400][Stage 1854:================================>             (28176 + 207) / 40400][Stage 1854:================================>             (28971 + 215) / 40400][Stage 1854:=================================>            (29664 + 206) / 40400][Stage 1854:==================================>           (30453 + 206) / 40400][Stage 1854:===================================>          (31138 + 202) / 40400][Stage 1854:====================================>         (31933 + 204) / 40400][Stage 1854:====================================>         (32229 + 236) / 40400][Stage 1854:=====================================>        (33045 + 222) / 40400][Stage 1854:======================================>       (33725 + 202) / 40400][Stage 1854:=======================================>      (34497 + 201) / 40400][Stage 1854:========================================>     (35235 + 255) / 40400][Stage 1854:========================================>     (35829 + 281) / 40400][Stage 1854:=========================================>    (36614 + 241) / 40400][Stage 1854:==========================================>   (37399 + 207) / 40400][Stage 1854:===========================================>  (38005 + 228) / 40400][Stage 1854:============================================> (38856 + 203) / 40400][Stage 1854:=============================================>(39623 + 207) / 40400][Stage 1854:=============================================>(40295 + 105) / 40400]                                                                                2023-11-30T18:57:42.137 END took 19773 ms: q77 - iteration 2
2023-11-30T18:57:42.137 ================================================================================
2023-11-30T18:57:42.137 ================================================================================
2023-11-30T18:57:42.137 START: q78 - iteration 2
2023-11-30T18:57:42.137 SQL:  with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from web_sales left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from catalog_sales left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from store_sales left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_item_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000 order by ss_item_sk, ss_qty desc, ss_wc desc, ss_sp desc, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio limit 100
23/11/30 18:57:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1856:(1 + 64) / 65][Stage 1859:(1 + 62) / 63][Stage 1860:(1 + 66) / 67][Stage 1856:(2 + 63) / 65][Stage 1859:(1 + 62) / 63][Stage 1860:(1 + 66) / 67][Stage 1856:(64 + 1) / 65][Stage 1859:(60 + 3) / 63][Stage 1860:(52 + 15) / 67]                                                                                23/11/30 18:57:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1861:(1 + 57) / 58][Stage 1862:(0 + 114) / 114][Stage 1863:(0 + 29) / 57][Stage 1861:(36 + 22) / 58][Stage 1862:(4 + 110) / 114][Stage 1863:(9 + 48) / 57][Stage 1862:===========>(109 + 5) / 114][Stage 1863:======>      (28 + 29) / 57][Stage 1863:==========================>                          (29 + 28) / 57][Stage 1863:=====================================================>(56 + 1) / 57]                                                                                2023-11-30T18:57:47.665 END took 5528 ms: q78 - iteration 2
2023-11-30T18:57:47.665 ================================================================================
2023-11-30T18:57:47.665 ================================================================================
2023-11-30T18:57:47.665 START: q79 - iteration 2
2023-11-30T18:57:47.665 SQL:  select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number ,ss_customer_sk ,store.s_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > -1) and date_dim.d_dow = 1 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1869:>                                                   (0 + 114) / 114][Stage 1869:==========================================>         (94 + 20) / 114]                                                                                2023-11-30T18:57:50.060 END took 2394 ms: q79 - iteration 2
2023-11-30T18:57:50.060 ================================================================================
2023-11-30T18:57:50.060 ================================================================================
2023-11-30T18:57:50.060 START: q8 - iteration 2
2023-11-30T18:57:50.060 SQL:  select  s_store_name ,sum(ss_net_profit) from store_sales ,date_dim ,store, (select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( '47602','16704','35863','28577','83910','36201', '58412','48162','28055','41419','80332', '38607','77817','24891','16226','18410', '21231','59345','13918','51089','20317', '17167','54585','67881','78366','47770', '18360','51717','73108','14440','21800', '89338','45859','65501','34948','25973', '73219','25333','17291','10374','18829', '60736','82620','41351','52094','19326', '25214','54207','40936','21814','79077', '25178','75742','77454','30621','89193', '27369','41232','48567','83041','71948', '37119','68341','14073','16891','62878', '49130','19833','24286','27700','40979', '50412','81504','94835','84844','71954', '39503','57649','18434','24987','12350', '86379','27413','44529','98569','16515', '27287','24255','21094','16005','56436', '91110','68293','56455','54558','10298', '83647','32754','27052','51766','19444', '13869','45645','94791','57631','20712', '37788','41807','46507','21727','71836', '81070','50632','88086','63991','20244', '31655','51782','29818','63792','68605', '94898','36430','57025','20601','82080', '33869','22728','35834','29086','92645', '98584','98072','11652','78093','57553', '43830','71144','53565','18700','90209', '71256','38353','54364','28571','96560', '57839','56355','50679','45266','84680', '34306','34972','48530','30106','15371', '92380','84247','92292','68852','13338', '34594','82602','70073','98069','85066', '47289','11686','98862','26217','47529', '63294','51793','35926','24227','14196', '24594','32489','99060','49472','43432', '49211','14312','88137','47369','56877', '20534','81755','15794','12318','21060', '73134','41255','63073','81003','73873', '66057','51184','51195','45676','92696', '70450','90669','98338','25264','38919', '59226','58581','60298','17895','19489', '52301','80846','95464','68770','51634', '19988','18367','18421','11618','67975', '25494','41352','95430','15734','62585', '97173','33773','10425','75675','53535', '17879','41967','12197','67998','79658', '59130','72592','14851','43933','68101', '50636','25717','71286','24660','58058', '72991','95042','15543','33122','69280', '11912','59386','27642','65177','17672', '33467','64592','36335','54010','18767', '63193','42361','49254','33113','33159', '36479','59080','11855','81963','31016', '49140','29392','41836','32958','53163', '13844','73146','23952','65148','93498', '14530','46131','58454','13376','13378', '83986','12320','17193','59852','46081', '98533','52389','13086','68843','31013', '13261','60560','13443','45533','83583', '11489','58218','19753','22911','25115', '86709','27156','32669','13123','51933', '39214','41331','66943','14155','69998', '49101','70070','35076','14242','73021', '59494','15782','29752','37914','74686', '83086','34473','15751','81084','49230', '91894','60624','17819','28810','63180', '56224','39459','55233','75752','43639', '55349','86057','62361','50788','31830', '58062','18218','85761','60083','45484', '21204','90229','70041','41162','35390', '16364','39500','68908','26689','52868', '81335','40146','11340','61527','61794', '71997','30415','59004','29450','58117', '69952','33562','83833','27385','61860', '96435','48333','23065','32961','84919', '61997','99132','22815','56600','68730', '48017','95694','32919','88217','27116', '28239','58032','18884','16791','21343', '97462','18569','75660','15475') intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100
23/11/30 18:57:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1875:>                                                   (0 + 114) / 114][Stage 1875:===================>                                (42 + 72) / 114]                                                                                2023-11-30T18:57:52.626 END took 2566 ms: q8 - iteration 2
2023-11-30T18:57:52.626 ================================================================================
2023-11-30T18:57:52.626 ================================================================================
2023-11-30T18:57:52.626 START: q80 - iteration 2
2023-11-30T18:57:52.626 SQL:  with ssr as (select  s_store_id as store_id, sum(ss_ext_sales_price) as sales, sum(coalesce(sr_return_amt, 0)) as returns, sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit from store_sales left outer join store_returns on (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion where ss_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and ss_store_sk = s_store_sk and ss_item_sk = i_item_sk and i_current_price > 50 and ss_promo_sk = p_promo_sk and p_channel_tv = 'N' group by s_store_id) , csr as (select  cp_catalog_page_id as catalog_page_id, sum(cs_ext_sales_price) as sales, sum(coalesce(cr_return_amount, 0)) as returns, sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit from catalog_sales left outer join catalog_returns on (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion where cs_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and cs_catalog_page_sk = cp_catalog_page_sk and cs_item_sk = i_item_sk and i_current_price > 50 and cs_promo_sk = p_promo_sk and p_channel_tv = 'N' group by cp_catalog_page_id) , wsr as (select  web_site_id, sum(ws_ext_sales_price) as sales, sum(coalesce(wr_return_amt, 0)) as returns, sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit from web_sales left outer join web_returns on (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number), date_dim, web_site, item, promotion where ws_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and ws_web_site_sk = web_site_sk and ws_item_sk = i_item_sk and i_current_price > 50 and ws_promo_sk = p_promo_sk and p_channel_tv = 'N' group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || store_id as id , sales , returns , profit from   ssr union all select 'catalog channel' as channel , 'catalog_page' || catalog_page_id as id , sales , returns , profit from  csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1878:(1 + 62) / 63][Stage 1881:(1 + 64) / 65][Stage 1885:(1 + 66) / 67][Stage 1878:(28 + 35) / 63][Stage 1881:(3 + 62) / 65][Stage 1885:(1 + 66) / 67]                                                                                23/11/30 18:57:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1886:(0 + 57) / 57][Stage 1887:(0 + 58) / 58][Stage 1888:(0 + 85) / 114][Stage 1886:(0 + 57) / 57][Stage 1887:(1 + 57) / 58][Stage 1888:(0 + 86) / 114][Stage 1886:(3 + 54) / 57][Stage 1887:(1 + 57) / 58][Stage 1888:(0 + 89) / 114][Stage 1886:(56 + 1) / 57][Stage 1887:(1 + 57) / 58][Stage 1888:(0 + 114) / 114][Stage 1887:============> (51 + 7) / 58][Stage 1888:====>       (45 + 69) / 114][Stage 1888:=======================================>            (86 + 28) / 114][Stage 1888:===========================================>        (95 + 19) / 114]                                                                                2023-11-30T18:57:59.087 END took 6461 ms: q80 - iteration 2
2023-11-30T18:57:59.087 ================================================================================
2023-11-30T18:57:59.087 ================================================================================
2023-11-30T18:57:59.087 START: q81 - iteration 2
2023-11-30T18:57:59.087 SQL:  with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'MO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return limit 100
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:57:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1895:>             (1 + 64) / 65][Stage 1896:>             (1 + 64) / 65][Stage 1895:==>          (14 + 51) / 65][Stage 1896:=====>       (26 + 39) / 65]                                                                                2023-11-30T18:58:02.326 END took 3238 ms: q81 - iteration 2
2023-11-30T18:58:02.326 ================================================================================
2023-11-30T18:58:02.326 ================================================================================
2023-11-30T18:58:02.326 START: q82 - iteration 2
2023-11-30T18:58:02.326 SQL:  select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, store_sales where i_current_price between 68 and 68+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-08' as date) and (cast('2002-05-08' as date) +  INTERVAL 60 days) and i_manufact_id in (562,370,230,182) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100
23/11/30 18:58:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1904:>           (0 + 114) / 114][Stage 1905:=>              (1 + 8) / 9][Stage 1905:======>                                                 (1 + 8) / 9][Stage 1905:===========================================>            (7 + 2) / 9]                                                                                2023-11-30T18:58:04.850 END took 2524 ms: q82 - iteration 2
2023-11-30T18:58:04.850 ================================================================================
2023-11-30T18:58:04.851 ================================================================================
2023-11-30T18:58:04.851 START: q83 - iteration 2
2023-11-30T18:58:04.851 SQL:  with sr_items as (select i_item_id item_id, sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   sr_returned_date_sk   = d_date_sk group by i_item_id), cr_items as (select i_item_id item_id, sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   cr_returned_date_sk   = d_date_sk group by i_item_id), wr_items as (select i_item_id item_id, sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   wr_returned_date_sk   = d_date_sk group by i_item_id) select  sr_items.item_id ,sr_item_qty ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev ,cr_item_qty ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev ,wr_item_qty ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100
23/11/30 18:58:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1912:(1 + 66) / 67][Stage 1913:(0 + 63) / 63][Stage 1914:(0 + 65) / 65][Stage 1912:(1 + 66) / 67][Stage 1913:(0 + 63) / 63][Stage 1914:(1 + 64) / 65][Stage 1912:(1 + 66) / 67][Stage 1913:(1 + 62) / 63][Stage 1914:(1 + 64) / 65][Stage 1912:(23 + 44) / 67][Stage 1913:(2 + 61) / 63][Stage 1914:(4 + 61) / 65][Stage 1914:=====================================================>(64 + 1) / 65]                                                                                2023-11-30T18:58:08.100 END took 3249 ms: q83 - iteration 2
2023-11-30T18:58:08.100 ================================================================================
2023-11-30T18:58:08.100 ================================================================================
2023-11-30T18:58:08.101 START: q84 - iteration 2
2023-11-30T18:58:08.101 SQL:  select  c_customer_id as customer_id , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city	        =  'Buena Vista' and c_current_addr_sk = ca_address_sk and ib_lower_bound   >=  49786 and ib_upper_bound   <=  49786 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100
23/11/30 18:58:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1917:>                                                     (1 + 62) / 63][Stage 1917:=>                                                    (2 + 61) / 63]                                                                                23/11/30 18:58:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T18:58:10.403 END took 2302 ms: q84 - iteration 2
2023-11-30T18:58:10.403 ================================================================================
2023-11-30T18:58:10.403 ================================================================================
2023-11-30T18:58:10.403 START: q85 - iteration 2
2023-11-30T18:58:10.403 SQL:  select  substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'ND', 'FL') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OH', 'MS', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MN', 'LA', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) limit 100
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1925:>                                                     (0 + 66) / 66][Stage 1925:=======>                                              (9 + 57) / 66][Stage 1925:=====================================================>(65 + 1) / 66]                                                                                23/11/30 18:58:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1927:>             (0 + 57) / 57][Stage 1930:>               (0 + 1) / 1][Stage 1927:>                                                     (0 + 57) / 57][Stage 1927:==========================================>          (46 + 11) / 57]                                                                                2023-11-30T18:58:15.217 END took 4813 ms: q85 - iteration 2
2023-11-30T18:58:15.217 ================================================================================
2023-11-30T18:58:15.217 ================================================================================
2023-11-30T18:58:15.217 START: q86 - iteration 2
2023-11-30T18:58:15.217 SQL:  select sum(ws_net_paid) as total_sum ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ws_net_paid) desc) as rank_within_parent from web_sales ,date_dim       d1 ,item where d1.d_month_seq between 1217 and 1217+11 and d1.d_date_sk = ws_sold_date_sk and i_item_sk  = ws_item_sk group by rollup(i_category,i_class) order by lochierarchy desc, case when lochierarchy = 0 then i_category end, rank_within_parent limit 100
23/11/30 18:58:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1935:>                                                     (0 + 57) / 57][Stage 1935:===========================================>         (47 + 10) / 57]                                                                                2023-11-30T18:58:17.223 END took 2005 ms: q86 - iteration 2
2023-11-30T18:58:17.223 ================================================================================
2023-11-30T18:58:17.223 ================================================================================
2023-11-30T18:58:17.223 START: q87 - iteration 2
2023-11-30T18:58:17.223 SQL:  select count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) ) cool_cust
23/11/30 18:58:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1940:(0 + 57) / 57][Stage 1941:(0 + 29) / 58][Stage 1942:(0 + 114) / 114][Stage 1940:(2 + 55) / 57][Stage 1941:(0 + 58) / 58][Stage 1942:(51 + 63) / 114][Stage 1941:==========================>                          (29 + 29) / 58][Stage 1941:===========================>                         (30 + 28) / 58][Stage 1941:=================================================>    (53 + 5) / 58]                                                                                2023-11-30T18:58:21.441 END took 4218 ms: q87 - iteration 2
2023-11-30T18:58:21.441 ================================================================================
2023-11-30T18:58:21.441 ================================================================================
2023-11-30T18:58:21.441 START: q88 - iteration 2
2023-11-30T18:58:21.441 SQL:  select  * from (select count(*) h8_30_to_9 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 8 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s1, (select count(*) h9_to_9_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s2, (select count(*) h9_30_to_10 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s3, (select count(*) h10_to_10_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s4, (select count(*) h10_30_to_11 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s5, (select count(*) h11_to_11_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s6, (select count(*) h11_30_to_12 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s7, (select count(*) h12_to_12_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 12 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s8
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1958:(0 + 114) / 114][Stage 1960:(0 + 86) / 114][Stage 1962:(0 + 0) / 114][Stage 1958:(81 + 33) / 114][Stage 1960:(14 + 100) / 114][Stage 1962:(0 + 67) / 114]                                                                                [Stage 1960:(86 + 28) / 114][Stage 1962:(0 + 114) / 114][Stage 1964:(0 + 58) / 114][Stage 1960:(92 + 22) / 114][Stage 1962:(0 + 114) / 114][Stage 1964:(0 + 64) / 114]                                                                                [Stage 1964:(58 + 56) / 114][Stage 1966:(0 + 114) / 114][Stage 1968:(0 + 30) / 114][Stage 1964:(104 + 10) / 114][Stage 1966:(2 + 112) / 114][Stage 1968:(0 + 79) / 114]                                                                                [Stage 1968:===>        (30 + 84) / 114][Stage 1970:>           (0 + 114) / 114][Stage 1968:===>        (34 + 80) / 114][Stage 1970:>           (0 + 114) / 114][Stage 1970:========>                                           (18 + 96) / 114]                                                                                [Stage 1972:>                                                   (0 + 114) / 114][Stage 1972:>                                                   (1 + 113) / 114]                                                                                2023-11-30T18:58:30.155 END took 8714 ms: q88 - iteration 2
2023-11-30T18:58:30.155 ================================================================================
2023-11-30T18:58:30.155 ================================================================================
2023-11-30T18:58:30.155 START: q89 - iteration 2
2023-11-30T18:58:30.155 SQL:  select  * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (2001) and ((i_category in ('Children','Home','Women') and i_class in ('toddlers','flatware','fragrances') ) or (i_category in ('Music','Electronics','Shoes') and i_class in ('country','dvd/vcr players','mens') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100
23/11/30 18:58:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 1977:>                                                   (0 + 114) / 114][Stage 1977:=====================================>              (82 + 32) / 114]                                                                                2023-11-30T18:58:32.421 END took 2266 ms: q89 - iteration 2
2023-11-30T18:58:32.421 ================================================================================
2023-11-30T18:58:32.421 ================================================================================
2023-11-30T18:58:32.421 START: q9 - iteration 2
2023-11-30T18:58:32.421 SQL:  select case when (select count(*) from store_sales where ss_quantity between 1 and 20) > 4502397049 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from store_sales where ss_quantity between 21 and 40) > 4756228269 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from store_sales where ss_quantity between 41 and 60) > 4101835064 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from store_sales where ss_quantity between 61 and 80) > 4583261513 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from store_sales where ss_quantity between 81 and 100) > 4208819283 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from store_sales where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1
[Stage 1980:(0 + 114) / 114][Stage 1982:(0 + 86) / 114][Stage 1984:(0 + 0) / 114][Stage 1980:(107 + 7) / 114][Stage 1982:(61 + 53) / 114][Stage 1984:(0 + 114) / 114][Stage 1982:(86 + 28) / 114][Stage 1984:(0 + 114) / 114][Stage 1986:(0 + 58) / 114][Stage 1981:> (0 + 0) / 1][Stage 1982:(86 + 28) / 114][Stage 1984:(0 + 114) / 114]                                                                                [Stage 1986:(58 + 56) / 114][Stage 1988:(0 + 114) / 114][Stage 1990:(0 + 30) / 114]                                                                                [Stage 1990:(30 + 84) / 114][Stage 1992:(0 + 114) / 114][Stage 1994:(0 + 2) / 114][Stage 1990:(91 + 23) / 114][Stage 1992:(0 + 114) / 114][Stage 1994:(0 + 63) / 114]                                                                                [Stage 1994:(2 + 112) / 114][Stage 1996:(0 + 88) / 114][Stage 1998:(0 + 0) / 114]                                                                                [Stage 1996:(88 + 26) / 114][Stage 1998:(0 + 114) / 114][Stage 2000:(0 + 60) / 114]                                                                                [Stage 2000:(60 + 54) / 114][Stage 2002:(0 + 114) / 114][Stage 2004:(0 + 32) / 114][Stage 2000:(85 + 29) / 114][Stage 2002:(0 + 114) / 114][Stage 2004:(0 + 57) / 114]                                                                                [Stage 2004:(34 + 80) / 114][Stage 2006:(0 + 114) / 114][Stage 2008:(0 + 6) / 114][Stage 2004:(104 + 10) / 114][Stage 2006:(3 + 111) / 114][Stage 2008:(0 + 79) / 114]                                                                                [Stage 2008:================>                                   (37 + 77) / 114][Stage 2008:==================================================> (111 + 3) / 114]                                                                                2023-11-30T18:58:44.655 END took 12233 ms: q9 - iteration 2
2023-11-30T18:58:44.656 ================================================================================
2023-11-30T18:58:44.656 ================================================================================
2023-11-30T18:58:44.656 START: q90 - iteration 2
2023-11-30T18:58:44.656 SQL:  select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 7 and 7+1 and household_demographics.hd_dep_count = 1 and web_page.wp_char_count between 5000 and 5200) at, ( select count(*) pmc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 20 and 20+1 and household_demographics.hd_dep_count = 1 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio limit 100
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2015:>                                                     (0 + 57) / 57][Stage 2015:====================================================> (55 + 2) / 57]                                                                                [Stage 2017:>                                                     (0 + 57) / 57][Stage 2017:====================================>                (39 + 18) / 57]                                                                                2023-11-30T18:58:48.233 END took 3577 ms: q90 - iteration 2
2023-11-30T18:58:48.233 ================================================================================
2023-11-30T18:58:48.233 ================================================================================
2023-11-30T18:58:48.233 START: q91 - iteration 2
2023-11-30T18:58:48.233 SQL:  select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics where cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1998 and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown') or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like 'Unknown%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2024:>                                                     (0 + 65) / 65][Stage 2024:>                                                     (1 + 64) / 65][Stage 2024:============================================>        (54 + 11) / 65]                                                                                2023-11-30T18:58:51.740 END took 3507 ms: q91 - iteration 2
2023-11-30T18:58:51.741 ================================================================================
2023-11-30T18:58:51.741 ================================================================================
2023-11-30T18:58:51.741 START: q92 - iteration 2
2023-11-30T18:58:51.741 SQL:  select sum(ws_ext_discount_amt)  as `Excess Discount Amount` from web_sales ,item ,date_dim where i_manufact_id = 172 and i_item_sk = ws_item_sk and d_date between '1999-01-12' and (cast('1999-01-12' as date) + INTERVAL 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales ,date_dim WHERE ws_item_sk = i_item_sk and d_date between '1999-01-12' and (cast('1999-01-12' as date) + INTERVAL 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) limit 100
23/11/30 18:58:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2035:>             (0 + 57) / 57][Stage 2036:>             (0 + 57) / 57][Stage 2035:=============>(56 + 1) / 57][Stage 2036:=========>   (42 + 15) / 57]                                                                                2023-11-30T18:58:53.813 END took 2072 ms: q92 - iteration 2
2023-11-30T18:58:53.813 ================================================================================
2023-11-30T18:58:53.813 ================================================================================
2023-11-30T18:58:53.813 START: q93 - iteration 2
2023-11-30T18:58:53.813 SQL:  select  ss_customer_sk ,sum(act_sales) sumsales from (select ss_item_sk ,ss_ticket_number ,ss_customer_sk ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number) ,reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 58') t group by ss_customer_sk order by sumsales, ss_customer_sk limit 100
23/11/30 18:58:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2039:>                                                     (0 + 63) / 63][Stage 2039:>                                                     (1 + 62) / 63][Stage 2039:===>                                                  (4 + 59) / 63]                                                                                23/11/30 18:58:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2041:>                                                   (0 + 114) / 114][Stage 2041:===========================================>        (96 + 18) / 114]                                                                                2023-11-30T18:58:57.523 END took 3710 ms: q93 - iteration 2
2023-11-30T18:58:57.523 ================================================================================
2023-11-30T18:58:57.523 ================================================================================
2023-11-30T18:58:57.524 START: q94 - iteration 2
2023-11-30T18:58:57.524 SQL:  select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between '2002-3-01' and (cast('2002-3-01' as date) + INTERVAL 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'GA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select * from web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select * from web_returns wr1 where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100
23/11/30 18:58:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:58:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2044:>                                                     (1 + 66) / 67][Stage 2044:=======>                                              (9 + 58) / 67][Stage 2044:=====================================================>(66 + 1) / 67]                                                                                23/11/30 18:58:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:58:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2047:>             (0 + 57) / 57][Stage 2048:>             (0 + 57) / 57][Stage 2048:====================================================> (55 + 2) / 57]                                                                                2023-11-30T18:59:01.465 END took 3940 ms: q94 - iteration 2
2023-11-30T18:59:01.465 ================================================================================
2023-11-30T18:59:01.465 ================================================================================
2023-11-30T18:59:01.465 START: q95 - iteration 2
2023-11-30T18:59:01.465 SQL:  with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2 from web_sales ws1,web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between '2001-3-01' and (cast('2001-3-01' as date) + INTERVAL 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'NE' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number from ws_wh) and ws1.ws_order_number in (select wr_order_number from web_returns,ws_wh where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100
23/11/30 18:59:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2051:>             (0 + 57) / 57][Stage 2053:>             (1 + 66) / 67][Stage 2051:=============>(56 + 1) / 57][Stage 2053:=======>     (37 + 30) / 67]                                                                                23/11/30 18:59:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2056:(0 + 57) / 57][Stage 2057:(0 + 57) / 57][Stage 2058:(0 + 57) / 57][Stage 2056:(50 + 7) / 57][Stage 2057:(0 + 57) / 57][Stage 2058:(0 + 57) / 57][Stage 2057:=====>       (26 + 31) / 57][Stage 2058:=======>     (35 + 22) / 57]                                                                                2023-11-30T18:59:05.659 END took 4194 ms: q95 - iteration 2
2023-11-30T18:59:05.659 ================================================================================
2023-11-30T18:59:05.659 ================================================================================
2023-11-30T18:59:05.659 START: q96 - iteration 2
2023-11-30T18:59:05.659 SQL:  select  count(*) from store_sales ,household_demographics ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 16 and time_dim.t_minute >= 30 and household_demographics.hd_dep_count = 0 and store.s_store_name = 'ese' order by count(*) limit 100
23/11/30 18:59:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2064:>                                                   (0 + 114) / 114][Stage 2064:======================>                             (50 + 64) / 114]                                                                                2023-11-30T18:59:07.485 END took 1826 ms: q96 - iteration 2
2023-11-30T18:59:07.485 ================================================================================
2023-11-30T18:59:07.485 ================================================================================
2023-11-30T18:59:07.485 START: q97 - iteration 2
2023-11-30T18:59:07.485 SQL:  with ssci as ( select ss_customer_sk customer_sk ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219 + 11 group by ss_customer_sk ,ss_item_sk), csci as( select cs_bill_customer_sk customer_sk ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219 + 11 group by cs_bill_customer_sk ,cs_item_sk) select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk and ssci.item_sk = csci.item_sk) limit 100
23/11/30 18:59:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2067:>             (1 + 57) / 58][Stage 2068:>           (0 + 114) / 114][Stage 2067:=============>(56 + 2) / 58][Stage 2068:===========>(106 + 8) / 114]                                                                                2023-11-30T18:59:09.770 END took 2284 ms: q97 - iteration 2
2023-11-30T18:59:09.770 ================================================================================
2023-11-30T18:59:09.770 ================================================================================
2023-11-30T18:59:09.770 START: q98 - iteration 2
2023-11-30T18:59:09.770 SQL:  select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ss_ext_sales_price) as itemrevenue ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over (partition by i_class) as revenueratio from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and i_category in ('Books', 'Children', 'Sports') and ss_sold_date_sk = d_date_sk and d_date between cast('2001-03-10' as date) and (cast('2001-03-10' as date) + interval 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio
23/11/30 18:59:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2073:>                                                   (0 + 114) / 114][Stage 2073:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:59:12.024 END took 2253 ms: q98 - iteration 2
2023-11-30T18:59:12.024 ================================================================================
2023-11-30T18:59:12.024 ================================================================================
2023-11-30T18:59:12.024 START: q99 - iteration 2
2023-11-30T18:59:12.024 SQL:  select substr(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20) ,sm_type ,cc_name order by substr(w_warehouse_name,1,20) ,sm_type ,cc_name limit 100
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2084:>                                                     (1 + 57) / 58][Stage 2084:=====================================================>(57 + 1) / 58]                                                                                2023-11-30T18:59:14.272 END took 2248 ms: q99 - iteration 2
2023-11-30T18:59:14.272 ================================================================================
2023-11-30T18:59:14.272 ================================================================================
2023-11-30T18:59:14.272 START: q1 - iteration 3
2023-11-30T18:59:14.272 SQL:  with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 group by sr_customer_sk ,sr_store_sk) select  c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'MO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id limit 100
23/11/30 18:59:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2089:>             (0 + 63) / 63][Stage 2091:>             (0 + 63) / 63][Stage 2089:>             (1 + 62) / 63][Stage 2091:>             (1 + 62) / 63][Stage 2091:==========================================>          (51 + 12) / 63]                                                                                2023-11-30T18:59:16.494 END took 2222 ms: q1 - iteration 3
2023-11-30T18:59:16.495 ================================================================================
2023-11-30T18:59:16.495 ================================================================================
2023-11-30T18:59:16.495 START: q10 - iteration 3
2023-11-30T18:59:16.495 SQL:  select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Grady County','Marion County','Decatur County','Lyman County','Beaver County') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 and 2+3) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 ANd 2+3) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 2 and 2+3)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100
23/11/30 18:59:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2096:(1 + 57) / 58][Stage 2097:(0 + 57) / 57][Stage 2098:(0 + 85) / 114][Stage 2096:(50 + 8) / 58][Stage 2097:(38 + 19) / 57][Stage 2098:(50 + 64) / 114][Stage 2098:======================================>             (85 + 29) / 114][Stage 2098:=========================================>          (91 + 23) / 114]                                                                                2023-11-30T18:59:20.791 END took 4296 ms: q10 - iteration 3
2023-11-30T18:59:20.791 ================================================================================
2023-11-30T18:59:20.791 ================================================================================
2023-11-30T18:59:20.791 START: q11 - iteration 3
2023-11-30T18:59:20.791 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_preferred_cust_flag from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 2001 and t_s_secyear.dyear = 2001+1 and t_w_firstyear.dyear = 2001 and t_w_secyear.dyear = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_preferred_cust_flag limit 100
23/11/30 18:59:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2107:>           (0 + 114) / 114][Stage 2110:>             (0 + 57) / 57][Stage 2107:===========>(108 + 6) / 114][Stage 2110:=========>   (43 + 14) / 57][Stage 2108:=================>                                  (69 + 11) / 200][Stage 2108:(121 + 11) / 200][Stage 2111:(0 + 0) / 200][Stage 2113:(0 + 0) / 200][Stage 2108:(184 + 11) / 200][Stage 2111:(0 + 0) / 200][Stage 2113:(0 + 0) / 200][Stage 2111:(15 + 9) / 200][Stage 2113:(0 + 0) / 200][Stage 2115:(0 + 0) / 200][Stage 2111:(91 + 11) / 200][Stage 2113:(0 + 0) / 200][Stage 2115:(0 + 0) / 200][Stage 2111:(169 + 12) / 200][Stage 2113:(0 + 0) / 200][Stage 2115:(0 + 0) / 200][Stage 2113:>            (10 + 1) / 200][Stage 2115:>             (0 + 0) / 200][Stage 2113:====>       (77 + 11) / 200][Stage 2115:>             (0 + 0) / 200][Stage 2113:========>  (150 + 11) / 200][Stage 2115:>             (0 + 0) / 200][Stage 2115:>                                                     (2 + 9) / 200][Stage 2115:========>                                           (34 + 11) / 200][Stage 2115:====================>                               (80 + 11) / 200][Stage 2115:====================================>              (143 + 11) / 200]                                                                                2023-11-30T18:59:26.860 END took 6068 ms: q11 - iteration 3
2023-11-30T18:59:26.860 ================================================================================
2023-11-30T18:59:26.860 ================================================================================
2023-11-30T18:59:26.860 START: q12 - iteration 3
2023-11-30T18:59:26.860 SQL:  select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Children', 'Jewelry', 'Music') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-05-11' as date) and (cast('2001-05-11' as date) + INTERVAL 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100
23/11/30 18:59:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2120:>                                                     (0 + 57) / 57][Stage 2120:================================================>     (51 + 6) / 57]                                                                                2023-11-30T18:59:28.846 END took 1985 ms: q12 - iteration 3
2023-11-30T18:59:28.846 ================================================================================
2023-11-30T18:59:28.846 ================================================================================
2023-11-30T18:59:28.846 START: q13 - iteration 3
2023-11-30T18:59:28.846 SQL:  select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'Primary' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('SC', 'WY', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'NE', 'GA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'AR', 'MI') and ss_net_profit between 50 and 250 ))
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2127:>                                                   (0 + 114) / 114][Stage 2127:===================================================>(112 + 2) / 114]                                                                                2023-11-30T18:59:30.989 END took 2143 ms: q13 - iteration 3
2023-11-30T18:59:30.989 ================================================================================
2023-11-30T18:59:30.989 ================================================================================
2023-11-30T18:59:30.989 START: q14a - iteration 3
2023-11-30T18:59:30.989 SQL:  with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales) from( select 'store' channel, i_brand_id,i_class_id ,i_category_id,sum(ss_quantity*ss_list_price) sales , count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales) union all select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales from catalog_sales ,item ,date_dim where cs_item_sk in (select ss_item_sk from cross_items) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales) union all select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales from web_sales ,item ,date_dim where ws_item_sk in (select ss_item_sk from cross_items) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales) ) y group by rollup (channel, i_brand_id,i_class_id,i_category_id) order by channel,i_brand_id,i_class_id,i_category_id limit 100
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2136:(1 + 200) / 229][Stage 2138:> (0 + 0) / 1][Stage 2139:>(0 + 0) / 58][Stage 2136:(19 + 200) / 229][Stage 2138:> (0 + 0) / 1][Stage 2139:>(0 + 0) / 58][Stage 2136:(199 + 30) / 229][Stage 2139:(0 + 58) / 58][Stage 2140:(0 + 57) / 57][Stage 2136:(201 + 28) / 229][Stage 2139:(1 + 57) / 58][Stage 2140:(0 + 57) / 57][Stage 2139:==========>  (46 + 12) / 58][Stage 2140:=======>     (32 + 25) / 57]                                                                                [Stage 2141:================================================>  (190 + 10) / 200]                                                                                23/11/30 18:59:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2143:>                                                   (0 + 114) / 114][Stage 2143:======>                                            (14 + 100) / 114]                                                                                23/11/30 18:59:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2148:(0 + 114) / 114][Stage 2149:(0 + 29) / 58][Stage 2150:(0 + 57) / 57][Stage 2148:===========>(105 + 9) / 114][Stage 2149:=====>       (26 + 32) / 58][Stage 2149:===========================>                         (30 + 28) / 58][Stage 2149:=================================================>    (53 + 5) / 58]                                                                                2023-11-30T18:59:43.398 END took 12408 ms: q14a - iteration 3
2023-11-30T18:59:43.398 ================================================================================
2023-11-30T18:59:43.398 ================================================================================
2023-11-30T18:59:43.398 START: q14b - iteration 3
2023-11-30T18:59:43.398 SQL:  with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select  this_year.channel ty_channel ,this_year.i_brand_id ty_brand ,this_year.i_class_id ty_class ,this_year.i_category_id ty_category ,this_year.sales ty_sales ,this_year.number_sales ty_number_sales ,last_year.channel ly_channel ,last_year.i_brand_id ly_brand ,last_year.i_class_id ly_class ,last_year.i_category_id ly_category ,last_year.sales ly_sales ,last_year.number_sales ly_number_sales from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 5) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 5) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2162:>           (1 + 200) / 229][Stage 2164:>               (0 + 0) / 1][Stage 2162:(1 + 200) / 229][Stage 2164:> (0 + 0) / 1][Stage 2165:> (0 + 0) / 1][Stage 2162:(27 + 201) / 229][Stage 2164:> (0 + 0) / 1][Stage 2165:> (0 + 0) / 1]                                                                                23/11/30 18:59:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2162:(201 + 28) / 229][Stage 2167:(0 + 57) / 57][Stage 2168:(1 + 57) / 58][Stage 2162:(202 + 27) / 229][Stage 2167:(0 + 57) / 57][Stage 2168:(1 + 57) / 58]                                                                                [Stage 2169:===============================>                   (125 + 11) / 200]                                                                                23/11/30 18:59:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2171:>                                                   (0 + 114) / 114][Stage 2171:================================================>   (107 + 7) / 114]                                                                                23/11/30 18:59:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2176:>                                                   (0 + 114) / 114][Stage 2176:==================================================> (111 + 3) / 114]                                                                                2023-11-30T18:59:53.114 END took 9715 ms: q14b - iteration 3
2023-11-30T18:59:53.114 ================================================================================
2023-11-30T18:59:53.114 ================================================================================
2023-11-30T18:59:53.114 START: q15 - iteration 3
2023-11-30T18:59:53.114 SQL:  select  ca_zip ,sum(cs_sales_price) from catalog_sales ,customer ,customer_address ,date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip limit 100
23/11/30 18:59:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2183:>                                                     (1 + 57) / 58][Stage 2183:=============================>                       (32 + 26) / 58]                                                                                2023-11-30T18:59:55.091 END took 1977 ms: q15 - iteration 3
2023-11-30T18:59:55.092 ================================================================================
2023-11-30T18:59:55.092 ================================================================================
2023-11-30T18:59:55.092 START: q16 - iteration 3
2023-11-30T18:59:55.092 SQL:  select count(distinct cs_order_number) as `order count` ,sum(cs_ext_ship_cost) as `total shipping cost` ,sum(cs_net_profit) as `total net profit` from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2000-3-01' and (cast('2000-3-01' as date) + INTERVAL 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Luce County','Wadena County','Jefferson Davis Parish','Daviess County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100
23/11/30 18:59:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 18:59:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2188:>                                                     (1 + 64) / 65][Stage 2188:=============================>                       (36 + 29) / 65]                                                                                23/11/30 18:59:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 18:59:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2189:>             (1 + 57) / 58][Stage 2190:>             (1 + 57) / 58][Stage 2189:====>        (18 + 40) / 58][Stage 2190:>             (4 + 54) / 58][Stage 2190:=====================================================>(57 + 1) / 58]                                                                                2023-11-30T18:59:59.113 END took 4020 ms: q16 - iteration 3
2023-11-30T18:59:59.113 ================================================================================
2023-11-30T18:59:59.113 ================================================================================
2023-11-30T18:59:59.113 START: q17 - iteration 3
2023-11-30T18:59:59.113 SQL:  select  i_item_id ,i_item_desc ,s_state ,count(ss_quantity) as store_sales_quantitycount ,avg(ss_quantity) as store_sales_quantityave ,stddev_samp(ss_quantity) as store_sales_quantitystdev ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov ,count(sr_return_quantity) as store_returns_quantitycount ,avg(sr_return_quantity) as store_returns_quantityave ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_quarter_name = '1999Q1' and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_quarter_name in ('1999Q1','1999Q2','1999Q3') and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_quarter_name in ('1999Q1','1999Q2','1999Q3') group by i_item_id ,i_item_desc ,s_state order by i_item_id ,i_item_desc ,s_state limit 100
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:00 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2193:>                                                     (1 + 62) / 63][Stage 2193:=>                                                    (2 + 61) / 63]                                                                                23/11/30 19:00:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2198:>             (1 + 57) / 58][Stage 2199:>           (0 + 114) / 114][Stage 2198:=========>   (44 + 14) / 58][Stage 2199:>           (0 + 114) / 114][Stage 2198:=============>(57 + 1) / 58][Stage 2199:=====>      (52 + 62) / 114][Stage 2199:================================================>   (106 + 8) / 114]                                                                                2023-11-30T19:00:03.749 END took 4636 ms: q17 - iteration 3
2023-11-30T19:00:03.749 ================================================================================
2023-11-30T19:00:03.749 ================================================================================
2023-11-30T19:00:03.749 START: q18 - iteration 3
2023-11-30T19:00:03.749 SQL:  select  i_item_id, ca_country, ca_state, ca_county, avg( cast(cs_quantity as decimal(12,2))) agg1, avg( cast(cs_list_price as decimal(12,2))) agg2, avg( cast(cs_coupon_amt as decimal(12,2))) agg3, avg( cast(cs_sales_price as decimal(12,2))) agg4, avg( cast(cs_net_profit as decimal(12,2))) agg5, avg( cast(c_birth_year as decimal(12,2))) agg6, avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7 from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd1.cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd1.cd_gender = 'F' and cd1.cd_education_status = 'Unknown' and c_current_cdemo_sk = cd2.cd_demo_sk and c_current_addr_sk = ca_address_sk and c_birth_month in (4,8,12,10,11,9) and d_year = 2001 and ca_state in ('AR','IA','TX' ,'KS','LA','NC','SD') group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country, ca_state, ca_county, i_item_id limit 100
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2208:>                                                     (1 + 57) / 58][Stage 2208:===============================>                     (35 + 23) / 58][Stage 2209:==========================================>        (168 + 11) / 200]                                                                                2023-11-30T19:00:07.547 END took 3797 ms: q18 - iteration 3
2023-11-30T19:00:07.547 ================================================================================
2023-11-30T19:00:07.547 ================================================================================
2023-11-30T19:00:07.547 START: q19 - iteration 3
2023-11-30T19:00:07.547 SQL:  select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=63 and d_moy=11 and d_year=2002 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip,1,5) <> substr(s_zip,1,5) and ss_store_sk = s_store_sk group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100 
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2216:>                                                   (0 + 114) / 114][Stage 2216:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:00:09.779 END took 2232 ms: q19 - iteration 3
2023-11-30T19:00:09.779 ================================================================================
2023-11-30T19:00:09.780 ================================================================================
2023-11-30T19:00:09.780 START: q2 - iteration 3
2023-11-30T19:00:09.780 SQL:  with wscs as (select sold_date_sk ,sales_price from (select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales)), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1
23/11/30 19:00:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2221:>                                                   (1 + 114) / 115][Stage 2221:==================================================> (112 + 3) / 115]                                                                                2023-11-30T19:00:12.528 END took 2748 ms: q2 - iteration 3
2023-11-30T19:00:12.528 ================================================================================
2023-11-30T19:00:12.528 ================================================================================
2023-11-30T19:00:12.528 START: q20 - iteration 3
2023-11-30T19:00:12.528 SQL:  select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from	catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Electronics', 'Children', 'Home') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-03-19' as date) and (cast('2002-03-19' as date) + INTERVAL 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100
23/11/30 19:00:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2230:>                                                     (1 + 57) / 58][Stage 2230:=====================================>               (41 + 17) / 58]                                                                                2023-11-30T19:00:14.611 END took 2082 ms: q20 - iteration 3
2023-11-30T19:00:14.611 ================================================================================
2023-11-30T19:00:14.611 ================================================================================
2023-11-30T19:00:14.611 START: q21 - iteration 3
2023-11-30T19:00:14.611 SQL:  select  * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-04-12' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-04-12' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = inv_item_sk and inv_warehouse_sk   = w_warehouse_sk and inv_date_sk    = d_date_sk and d_date between (cast ('1999-04-12' as date) - INTERVAL 30 days) and (cast ('1999-04-12' as date) + INTERVAL 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id limit 100
23/11/30 19:00:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2236:======>                                                 (1 + 8) / 9][Stage 2236:==================>                                     (3 + 6) / 9][Stage 2236:===========================================>            (7 + 2) / 9]                                                                                2023-11-30T19:00:17.075 END took 2464 ms: q21 - iteration 3
2023-11-30T19:00:17.075 ================================================================================
2023-11-30T19:00:17.075 ================================================================================
2023-11-30T19:00:17.075 START: q22 - iteration 3
2023-11-30T19:00:17.075 SQL:  select  i_product_name ,i_brand ,i_class ,i_category ,avg(inv_quantity_on_hand) qoh from inventory ,date_dim ,item where inv_date_sk=d_date_sk and inv_item_sk=i_item_sk and d_month_seq between 1188 and 1188 + 11 group by rollup(i_product_name ,i_brand ,i_class ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category limit 100
23/11/30 19:00:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2240:======>                                                 (1 + 8) / 9][Stage 2240:============>                                           (2 + 7) / 9][Stage 2240:========================>                               (4 + 5) / 9][Stage 2240:=====================================>                  (6 + 3) / 9]                                                                                2023-11-30T19:00:19.610 END took 2534 ms: q22 - iteration 3
2023-11-30T19:00:19.610 ================================================================================
2023-11-30T19:00:19.610 ================================================================================
2023-11-30T19:00:19.610 START: q23a - iteration 3
2023-11-30T19:00:19.610 SQL:  with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (1998,1998+1,1998+2,1998+3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1,1998+2,1998+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select  sum(sales) from (select cs_quantity*cs_list_price sales from catalog_sales ,date_dim where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) union all select ws_quantity*ws_list_price sales from web_sales ,date_dim where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) limit 100
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2248:>                                                   (0 + 114) / 114][Stage 2248:================================================>   (107 + 7) / 114]                                                                                [Stage 2251:(0 + 114) / 114][Stage 2253:(1 + 57) / 58][Stage 2254:(0 + 29) / 57][Stage 2251:(2 + 112) / 114][Stage 2253:(2 + 56) / 58][Stage 2254:(4 + 32) / 57][Stage 2251:(104 + 10) / 114][Stage 2254:(28 + 29) / 57][Stage 2256:(0 + 114) / 114][Stage 2254:======>      (29 + 28) / 57][Stage 2256:>           (0 + 114) / 114][Stage 2254:=============>(55 + 2) / 57][Stage 2256:==>         (23 + 91) / 114]                                                                                2023-11-30T19:00:26.178 END took 6567 ms: q23a - iteration 3
2023-11-30T19:00:26.178 ================================================================================
2023-11-30T19:00:26.178 ================================================================================
2023-11-30T19:00:26.178 START: q23b - iteration 3
2023-11-30T19:00:26.178 SQL:  with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (1998,1998 + 1,1998 + 2,1998 + 3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1,1998+2,1998+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select  c_last_name,c_first_name,sales from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales from catalog_sales ,customer ,date_dim where d_year = 1998 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name union all select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales from web_sales ,customer ,date_dim where d_year = 1998 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name) order by c_last_name,c_first_name,sales limit 100
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:27 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2266:>                                                   (0 + 114) / 114][Stage 2266:===================================================>(112 + 2) / 114]                                                                                [Stage 2269:>                                                   (0 + 114) / 114][Stage 2269:>                                                   (1 + 113) / 114]                                                                                23/11/30 19:00:31 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:31 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:31 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:31 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2273:(0 + 114) / 114][Stage 2275:(0 + 57) / 57][Stage 2279:(0 + 29) / 58][Stage 2273:(82 + 32) / 114][Stage 2275:(45 + 12) / 57][Stage 2279:(19 + 39) / 58][Stage 2273:(113 + 1) / 114][Stage 2275:(55 + 2) / 57][Stage 2279:(29 + 29) / 58][Stage 2279:===========================>                         (30 + 28) / 58][Stage 2279:=============================>                       (32 + 26) / 58]                                                                                2023-11-30T19:00:34.997 END took 8818 ms: q23b - iteration 3
2023-11-30T19:00:34.997 ================================================================================
2023-11-30T19:00:34.997 ================================================================================
2023-11-30T19:00:34.997 START: q24a - iteration 3
2023-11-30T19:00:34.997 SQL:  with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id=7 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'goldenrod' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2283:>             (1 + 62) / 63][Stage 2284:>             (1 + 62) / 63][Stage 2283:======>      (33 + 30) / 63][Stage 2284:====>        (20 + 43) / 63]                                                                                23/11/30 19:00:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2293:>                                                   (0 + 114) / 114][Stage 2293:>                                                   (2 + 112) / 114][Stage 2293:=============================================>     (101 + 13) / 114]                                                                                [Stage 2296:>                                                   (0 + 114) / 114][Stage 2296:==========================================>         (94 + 20) / 114]                                                                                2023-11-30T19:00:41.426 END took 6428 ms: q24a - iteration 3
2023-11-30T19:00:41.426 ================================================================================
2023-11-30T19:00:41.426 ================================================================================
2023-11-30T19:00:41.426 START: q24b - iteration 3
2023-11-30T19:00:41.426 SQL:  with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id = 7 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'magenta' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2304:>             (1 + 62) / 63][Stage 2306:>             (1 + 62) / 63][Stage 2304:>             (2 + 61) / 63][Stage 2306:>             (2 + 61) / 63]                                                                                23/11/30 19:00:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:43 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:43 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2313:>                                                   (0 + 114) / 114][Stage 2313:=======>                                            (17 + 97) / 114][Stage 2313:==================================================> (110 + 4) / 114]                                                                                [Stage 2316:>                                                   (0 + 114) / 114][Stage 2316:=======>                                            (17 + 97) / 114][Stage 2316:=================================================>  (109 + 5) / 114]                                                                                2023-11-30T19:00:47.480 END took 6054 ms: q24b - iteration 3
2023-11-30T19:00:47.480 ================================================================================
2023-11-30T19:00:47.480 ================================================================================
2023-11-30T19:00:47.480 START: q25 - iteration 3
2023-11-30T19:00:47.480 SQL:  select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,min(ss_net_profit) as store_sales_profit ,min(sr_net_loss) as store_returns_loss ,min(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy               between 4 and  10 and d2.d_year              = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy               between 4 and  10 and d3.d_year              = 2002 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:48 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2325:>                                                     (1 + 62) / 63][Stage 2325:=====================================================>(62 + 1) / 63]                                                                                23/11/30 19:00:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2328:>           (0 + 114) / 114][Stage 2329:>             (1 + 57) / 58][Stage 2328:=====>      (51 + 63) / 114][Stage 2329:========>    (37 + 21) / 58][Stage 2328:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:00:51.844 END took 4364 ms: q25 - iteration 3
2023-11-30T19:00:51.844 ================================================================================
2023-11-30T19:00:51.844 ================================================================================
2023-11-30T19:00:51.844 START: q26 - iteration 3
2023-11-30T19:00:51.844 SQL:  select  i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from catalog_sales, customer_demographics, date_dim, item, promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = '4 yr Degree' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id limit 100
23/11/30 19:00:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2336:>                                                     (1 + 57) / 58][Stage 2336:==========>                                          (12 + 46) / 58]                                                                                2023-11-30T19:00:54.658 END took 2813 ms: q26 - iteration 3
2023-11-30T19:00:54.658 ================================================================================
2023-11-30T19:00:54.658 ================================================================================
2023-11-30T19:00:54.658 START: q27 - iteration 3
2023-11-30T19:00:54.658 SQL:  select  i_item_id, s_state, grouping(s_state) g_state, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'M' and cd_education_status = 'Secondary' and d_year = 1999 and s_state in ('AL','FL', 'TX', 'NM', 'MI', 'GA') group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100
23/11/30 19:00:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:00:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:00:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2342:>                                                   (0 + 114) / 114][Stage 2342:==>                                                 (5 + 109) / 114]                                                                                2023-11-30T19:00:57.258 END took 2600 ms: q27 - iteration 3
2023-11-30T19:00:57.258 ================================================================================
2023-11-30T19:00:57.258 ================================================================================
2023-11-30T19:00:57.258 START: q28 - iteration 3
2023-11-30T19:00:57.258 SQL:  select  * from (select avg(ss_list_price) B1_LP ,count(ss_list_price) B1_CNT ,count(distinct ss_list_price) B1_CNTD from store_sales where ss_quantity between 0 and 5 and (ss_list_price between 74 and 74+10 or ss_coupon_amt between 2949 and 2949+1000 or ss_wholesale_cost between 49 and 49+20)) B1, (select avg(ss_list_price) B2_LP ,count(ss_list_price) B2_CNT ,count(distinct ss_list_price) B2_CNTD from store_sales where ss_quantity between 6 and 10 and (ss_list_price between 136 and 136+10 or ss_coupon_amt between 10027 and 10027+1000 or ss_wholesale_cost between 53 and 53+20)) B2, (select avg(ss_list_price) B3_LP ,count(ss_list_price) B3_CNT ,count(distinct ss_list_price) B3_CNTD from store_sales where ss_quantity between 11 and 15 and (ss_list_price between 73 and 73+10 or ss_coupon_amt between 1451 and 1451+1000 or ss_wholesale_cost between 78 and 78+20)) B3, (select avg(ss_list_price) B4_LP ,count(ss_list_price) B4_CNT ,count(distinct ss_list_price) B4_CNTD from store_sales where ss_quantity between 16 and 20 and (ss_list_price between 87 and 87+10 or ss_coupon_amt between 17007 and 17007+1000 or ss_wholesale_cost between 55 and 55+20)) B4, (select avg(ss_list_price) B5_LP ,count(ss_list_price) B5_CNT ,count(distinct ss_list_price) B5_CNTD from store_sales where ss_quantity between 21 and 25 and (ss_list_price between 112 and 112+10 or ss_coupon_amt between 17243 and 17243+1000 or ss_wholesale_cost between 2 and 2+20)) B5, (select avg(ss_list_price) B6_LP ,count(ss_list_price) B6_CNT ,count(distinct ss_list_price) B6_CNTD from store_sales where ss_quantity between 26 and 30 and (ss_list_price between 119 and 119+10 or ss_coupon_amt between 4954 and 4954+1000 or ss_wholesale_cost between 22 and 22+20)) B6 limit 100
[Stage 2346:(0 + 114) / 114][Stage 2349:(0 + 86) / 114][Stage 2352:(0 + 0) / 114][Stage 2346:(83 + 31) / 114][Stage 2349:(27 + 87) / 114][Stage 2352:(0 + 82) / 114][Stage 2349:(86 + 28) / 114][Stage 2352:(0 + 114) / 114][Stage 2355:(0 + 57) / 114][Stage 2347:(54 + 1) / 200][Stage 2349:(86 + 28) / 114][Stage 2352:(0 + 114) / 114][Stage 2347:(70 + 3) / 200][Stage 2349:(88 + 26) / 114][Stage 2352:(0 + 114) / 114][Stage 2352:(103 + 11) / 114][Stage 2355:(8 + 106) / 114][Stage 2358:(0 + 77) / 114]                                                                                [Stage 2355:======>     (57 + 57) / 114][Stage 2358:>           (0 + 114) / 114][Stage 2355:===========>(113 + 1) / 114][Stage 2358:=======>    (71 + 43) / 114]                                                                                [Stage 2361:>                                                   (0 + 114) / 114][Stage 2361:==>                                                 (5 + 109) / 114]                                                                                2023-11-30T19:01:04.015 END took 6756 ms: q28 - iteration 3
2023-11-30T19:01:04.015 ================================================================================
2023-11-30T19:01:04.015 ================================================================================
2023-11-30T19:01:04.015 START: q29 - iteration 3
2023-11-30T19:01:04.015 SQL:  select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_quantity)        as store_sales_quantity ,stddev_samp(sr_return_quantity) as store_returns_quantity ,stddev_samp(cs_quantity)        as catalog_sales_quantity from store_sales ,store_returns ,catalog_sales ,date_dim             d1 ,date_dim             d2 ,date_dim             d3 ,store ,item where d1.d_moy               = 4 and d1.d_year              = 2000 and d1.d_date_sk           = ss_sold_date_sk and i_item_sk              = ss_item_sk and s_store_sk             = ss_store_sk and ss_customer_sk         = sr_customer_sk and ss_item_sk             = sr_item_sk and ss_ticket_number       = sr_ticket_number and sr_returned_date_sk    = d2.d_date_sk and d2.d_moy               between 4 and  4 + 3 and d2.d_year              = 2000 and sr_customer_sk         = cs_bill_customer_sk and sr_item_sk             = cs_item_sk and cs_sold_date_sk        = d3.d_date_sk and d3.d_year              in (2000,2000+1,2000+2) group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2369:>                                                     (1 + 62) / 63][Stage 2369:=========================>                           (30 + 33) / 63]                                                                                23/11/30 19:01:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2370:>             (1 + 57) / 58][Stage 2371:>           (0 + 114) / 114][Stage 2370:>             (2 + 56) / 58][Stage 2371:>           (0 + 114) / 114][Stage 2371:=>                                                  (4 + 110) / 114][Stage 2371:==========================================>         (94 + 20) / 114]                                                                                2023-11-30T19:01:08.044 END took 4028 ms: q29 - iteration 3
2023-11-30T19:01:08.044 ================================================================================
2023-11-30T19:01:08.044 ================================================================================
2023-11-30T19:01:08.044 START: q3 - iteration 3
2023-11-30T19:01:08.044 SQL:  select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_sales_price) sum_agg from  date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,sum_agg desc ,brand_id limit 100
23/11/30 19:01:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2376:>                                                   (0 + 114) / 114][Stage 2376:======>                                            (14 + 100) / 114][Stage 2376:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:01:09.989 END took 1944 ms: q3 - iteration 3
2023-11-30T19:01:09.989 ================================================================================
2023-11-30T19:01:09.989 ================================================================================
2023-11-30T19:01:09.989 START: q30 - iteration 3
2023-11-30T19:01:09.989 SQL:  with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2001 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'MI' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return limit 100
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:10 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2383:>             (0 + 66) / 66][Stage 2384:>             (0 + 66) / 66][Stage 2383:====>        (22 + 44) / 66][Stage 2384:=======>     (36 + 30) / 66][Stage 2383:=====================================================>(65 + 1) / 66]                                                                                2023-11-30T19:01:13.186 END took 3197 ms: q30 - iteration 3
2023-11-30T19:01:13.186 ================================================================================
2023-11-30T19:01:13.186 ================================================================================
2023-11-30T19:01:13.186 START: q31 - iteration 3
2023-11-30T19:01:13.186 SQL:  with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year) select ss1.ca_county ,ss1.d_year ,ws2.web_sales/ws1.web_sales web_q1_q2_increase ,ss2.store_sales/ss1.store_sales store_q1_q2_increase ,ws3.web_sales/ws2.web_sales web_q2_q3_increase ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from ss ss1 ,ss ss2 ,ss ss3 ,ws ws1 ,ws ws2 ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 2000 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 2000 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 2000 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 2000 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 2000 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =2000 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by store_q1_q2_increase
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:14 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2393:(0 + 57) / 57][Stage 2395:(0 + 114) / 114][Stage 2397:(0 + 29) / 57][Stage 2393:(47 + 10) / 57][Stage 2395:(17 + 97) / 114][Stage 2397:(1 + 56) / 57][Stage 2395:(112 + 2) / 114][Stage 2397:(28 + 29) / 57][Stage 2399:(0 + 114) / 114][Stage 2397:(29 + 28) / 57][Stage 2399:(0 + 114) / 114][Stage 2401:(0 + 57) / 57][Stage 2394:(1 + 0) / 200][Stage 2396:(46 + 1) / 200][Stage 2397:(29 + 28) / 57][Stage 2394:(1 + 0) / 200][Stage 2396:(59 + 1) / 200][Stage 2397:(29 + 28) / 57][Stage 2394:(158 + 28) / 200][Stage 2396:(173 + 1) / 200][Stage 2399:(107 + 7) / 114][Stage 2401:=============>(55 + 2) / 57][Stage 2403:>           (0 + 114) / 114][Stage 2403:>                                                   (0 + 114) / 114][Stage 2403:===>                                                (7 + 107) / 114]                                                                                2023-11-30T19:01:19.918 END took 6731 ms: q31 - iteration 3
2023-11-30T19:01:19.918 ================================================================================
2023-11-30T19:01:19.918 ================================================================================
2023-11-30T19:01:19.918 START: q32 - iteration 3
2023-11-30T19:01:19.918 SQL:  select  sum(cs_ext_discount_amt)  as `excess discount amount` from catalog_sales ,item ,date_dim where i_manufact_id = 490 and i_item_sk = cs_item_sk and d_date between '1999-01-27' and (cast('1999-01-27' as date) + INTERVAL 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '1999-01-27' and (cast('1999-01-27' as date) + INTERVAL 90 days) and d_date_sk = cs_sold_date_sk ) limit 100
23/11/30 19:01:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2422:>             (1 + 57) / 58][Stage 2423:>             (1 + 57) / 58]                                                                                2023-11-30T19:01:22.082 END took 2163 ms: q32 - iteration 3
2023-11-30T19:01:22.082 ================================================================================
2023-11-30T19:01:22.082 ================================================================================
2023-11-30T19:01:22.082 START: q33 - iteration 3
2023-11-30T19:01:22.082 SQL:  with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_manufact_id in (select i_manufact_id from item where i_category in ('Electronics')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in ('Electronics')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in ('Electronics')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 1 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id) select  i_manufact_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:23 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2430:>           (0 + 114) / 114][Stage 2431:>             (0 + 57) / 57][Stage 2430:(0 + 114) / 114][Stage 2431:(0 + 57) / 57][Stage 2432:(0 + 29) / 58][Stage 2430:(113 + 1) / 114][Stage 2431:(51 + 6) / 57][Stage 2432:(27 + 31) / 58][Stage 2432:===========================>                         (30 + 28) / 58][Stage 2432:===================================>                 (39 + 19) / 58]                                                                                2023-11-30T19:01:26.148 END took 4065 ms: q33 - iteration 3
2023-11-30T19:01:26.148 ================================================================================
2023-11-30T19:01:26.148 ================================================================================
2023-11-30T19:01:26.148 START: q34 - iteration 3
2023-11-30T19:01:26.148 SQL:  select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28) and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = 'Unknown') and household_demographics.hd_vehicle_count > 0 and (case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end)  > 1.2 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_county in ('Nez Perce County','Murray County','Surry County','Calhoun County', 'Wilkinson County','Brown County','Wallace County','Carter County') group by ss_ticket_number,ss_customer_sk) dn,customer where ss_customer_sk = c_customer_sk and cnt between 15 and 20 order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2439:>                                                   (0 + 114) / 114][Stage 2439:===================================>                (78 + 36) / 114]                                                                                2023-11-30T19:01:28.819 END took 2671 ms: q34 - iteration 3
2023-11-30T19:01:28.819 ================================================================================
2023-11-30T19:01:28.819 ================================================================================
2023-11-30T19:01:28.819 START: q35 - iteration 3
2023-11-30T19:01:28.819 SQL:  select ca_state, cd_gender, cd_marital_status, cd_dep_count, count(*) cnt1, stddev_samp(cd_dep_count), sum(cd_dep_count), min(cd_dep_count), cd_dep_employed_count, count(*) cnt2, stddev_samp(cd_dep_employed_count), sum(cd_dep_employed_count), min(cd_dep_employed_count), cd_dep_college_count, count(*) cnt3, stddev_samp(cd_dep_college_count), sum(cd_dep_college_count), min(cd_dep_college_count) from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_qoy < 4)) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100
23/11/30 19:01:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:29 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:29 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2446:(0 + 57) / 57][Stage 2448:(1 + 57) / 58][Stage 2449:(0 + 85) / 114][Stage 2446:(0 + 57) / 57][Stage 2448:(1 + 57) / 58][Stage 2449:(0 + 86) / 114][Stage 2446:(29 + 28) / 57][Stage 2448:(2 + 56) / 58][Stage 2449:(10 + 104) / 114][Stage 2448:=============>(57 + 1) / 58][Stage 2449:========>   (82 + 32) / 114][Stage 2449:======================================>             (85 + 29) / 114][Stage 2449:=======================================>            (86 + 28) / 114][Stage 2452:================================================>   (187 + 3) / 200]                                                                                2023-11-30T19:01:33.949 END took 5129 ms: q35 - iteration 3
2023-11-30T19:01:33.949 ================================================================================
2023-11-30T19:01:33.949 ================================================================================
2023-11-30T19:01:33.949 START: q36 - iteration 3
2023-11-30T19:01:33.949 SQL:  select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent from store_sales ,date_dim       d1 ,item ,store where d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk  = ss_item_sk and s_store_sk  = ss_store_sk and s_state in ('MN','TX','TX','IN', 'CA','LA','NM','TX') group by rollup(i_category,i_class) order by lochierarchy desc ,case when lochierarchy = 0 then i_category end ,rank_within_parent limit 100
23/11/30 19:01:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:34 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:34 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2457:>                                                   (0 + 114) / 114][Stage 2457:=====>                                             (12 + 102) / 114]                                                                                2023-11-30T19:01:36.146 END took 2196 ms: q36 - iteration 3
2023-11-30T19:01:36.146 ================================================================================
2023-11-30T19:01:36.146 ================================================================================
2023-11-30T19:01:36.146 START: q37 - iteration 3
2023-11-30T19:01:36.146 SQL:  select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 16 and 16 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-06-05' as date) and (cast('2002-06-05' as date) + interval 60 days) and i_manufact_id in (841,790,796,739) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100
23/11/30 19:01:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2460:>             (1 + 57) / 58][Stage 2463:=>              (1 + 8) / 9]                                                                                23/11/30 19:01:37 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:37 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T19:01:38.291 END took 2144 ms: q37 - iteration 3
2023-11-30T19:01:38.291 ================================================================================
2023-11-30T19:01:38.291 ================================================================================
2023-11-30T19:01:38.291 START: q38 - iteration 3
2023-11-30T19:01:38.291 SQL:  select  count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1203 and 1203 + 11 ) hot_cust limit 100
23/11/30 19:01:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:39 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:39 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2467:(1 + 57) / 58][Stage 2468:(0 + 29) / 57][Stage 2469:(0 + 114) / 114][Stage 2467:(1 + 57) / 58][Stage 2468:(0 + 31) / 57][Stage 2469:(2 + 112) / 114][Stage 2468:==========================>                          (28 + 29) / 57][Stage 2468:==========================>                          (29 + 28) / 57][Stage 2468:=====================================================>(56 + 1) / 57]                                                                                2023-11-30T19:01:42.259 END took 3968 ms: q38 - iteration 3
2023-11-30T19:01:42.259 ================================================================================
2023-11-30T19:01:42.259 ================================================================================
2023-11-30T19:01:42.259 START: q39a - iteration 3
2023-11-30T19:01:42.259 SQL:  with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =1999 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=3 and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:42 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2479:=>              (1 + 8) / 9][Stage 2481:=>              (1 + 8) / 9][Stage 2481:===========================================>            (7 + 2) / 9]                                                                                2023-11-30T19:01:45.684 END took 3425 ms: q39a - iteration 3
2023-11-30T19:01:45.684 ================================================================================
2023-11-30T19:01:45.684 ================================================================================
2023-11-30T19:01:45.685 START: q39b - iteration 3
2023-11-30T19:01:45.685 SQL:  with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =1999 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=3 and inv2.d_moy=3+1 and inv1.cov > 1.5 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:46 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2494:=>              (1 + 8) / 9][Stage 2496:=>              (1 + 8) / 9][Stage 2496:===========================================>            (7 + 2) / 9]                                                                                2023-11-30T19:01:48.619 END took 2934 ms: q39b - iteration 3
2023-11-30T19:01:48.619 ================================================================================
2023-11-30T19:01:48.619 ================================================================================
2023-11-30T19:01:48.619 START: q4 - iteration 3
2023-11-30T19:01:48.619 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total ,'c' sale_type from customer ,catalog_sales ,date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_c_firstyear ,year_total t_c_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = 's' and t_c_firstyear.sale_type = 'c' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_c_secyear.sale_type = 'c' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear =  1999 and t_s_secyear.dyear = 1999+1 and t_c_firstyear.dyear =  1999 and t_c_secyear.dyear =  1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total > 0 and t_c_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country limit 100
23/11/30 19:01:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:50 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:50 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2508:(1 + 57) / 58][Stage 2513:(0 + 114) / 114][Stage 2516:(0 + 29) / 57][Stage 2508:(18 + 40) / 58][Stage 2513:(1 + 113) / 114][Stage 2516:(0 + 47) / 57][Stage 2513:===========>(111 + 3) / 114][Stage 2516:=====>       (26 + 31) / 57][Stage 2516:==========================>                          (29 + 28) / 57][Stage 2509:(77 + 10) / 200][Stage 2511:(0 + 0) / 200][Stage 2514:(0 + 0) / 200][Stage 2509:(126 + 10) / 200][Stage 2511:(0 + 0) / 200][Stage 2514:(0 + 0) / 200][Stage 2509:(177 + 10) / 200][Stage 2511:(0 + 0) / 200][Stage 2514:(0 + 0) / 200][Stage 2511:(4 + 11) / 200][Stage 2514:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2511:(30 + 11) / 200][Stage 2514:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2511:(73 + 11) / 200][Stage 2514:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2511:(120 + 11) / 200][Stage 2514:(0 + 0) / 200][Stage 2517:(0 + 0) / 200][Stage 2511:(180 + 11) / 200][Stage 2514:(0 + 0) / 200][Stage 2517:(0 + 0) / 200][Stage 2514:(3 + 11) / 200][Stage 2517:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2514:(37 + 11) / 200][Stage 2517:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2514:(73 + 11) / 200][Stage 2517:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2514:(105 + 11) / 200][Stage 2517:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2514:(154 + 11) / 200][Stage 2517:(0 + 0) / 200][Stage 2519:(0 + 0) / 200][Stage 2514:(196 + 4) / 200][Stage 2517:(0 + 7) / 200][Stage 2519:(0 + 28) / 200][Stage 2517:(11 + 0) / 200][Stage 2519:(41 + 148) / 200][Stage 2521:(0 + 0) / 200][Stage 2517:==>         (44 + 12) / 200][Stage 2521:>             (0 + 0) / 200][Stage 2517:======>    (120 + 11) / 200][Stage 2521:>             (0 + 0) / 200][Stage 2517:===========>(193 + 7) / 200][Stage 2521:>             (0 + 4) / 200][Stage 2521:===>                                                (14 + 76) / 200]                                                                                2023-11-30T19:01:57.373 END took 8754 ms: q4 - iteration 3
2023-11-30T19:01:57.373 ================================================================================
2023-11-30T19:01:57.373 ================================================================================
2023-11-30T19:01:57.373 START: q40 - iteration 3
2023-11-30T19:01:57.373 SQL:  select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-04-27' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('1999-04-27' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = cs_item_sk and cs_warehouse_sk    = w_warehouse_sk and cs_sold_date_sk    = d_date_sk and d_date between (cast ('1999-04-27' as date) - INTERVAL 30 days) and (cast ('1999-04-27' as date) + INTERVAL 30 days) group by w_state,i_item_id order by w_state,i_item_id limit 100
23/11/30 19:01:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:01:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2525:>                                                     (1 + 64) / 65][Stage 2525:=====================================================>(64 + 1) / 65]                                                                                23/11/30 19:01:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:01:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2528:>                                                     (1 + 57) / 58][Stage 2528:==========================>                          (29 + 29) / 58]                                                                                2023-11-30T19:02:00.928 END took 3554 ms: q40 - iteration 3
2023-11-30T19:02:00.928 ================================================================================
2023-11-30T19:02:00.928 ================================================================================
2023-11-30T19:02:00.928 START: q41 - iteration 3
2023-11-30T19:02:00.928 SQL:  select  distinct(i_product_name) from item i1 where i_manufact_id between 841 and 841+40 and (select count(*) as item_cnt from item where (i_manufact = i1.i_manufact and ((i_category = 'Women' and (i_color = 'bisque' or i_color = 'khaki') and (i_units = 'Carton' or i_units = 'Box') and (i_size = 'large' or i_size = 'extra large') ) or (i_category = 'Women' and (i_color = 'antique' or i_color = 'sandy') and (i_units = 'Pallet' or i_units = 'Cup') and (i_size = 'petite' or i_size = 'small') ) or (i_category = 'Men' and (i_color = 'forest' or i_color = 'brown') and (i_units = 'Dram' or i_units = 'Ton') and (i_size = 'economy' or i_size = 'medium') ) or (i_category = 'Men' and (i_color = 'chartreuse' or i_color = 'light') and (i_units = 'Pound' or i_units = 'Dozen') and (i_size = 'large' or i_size = 'extra large') ))) or (i_manufact = i1.i_manufact and ((i_category = 'Women' and (i_color = 'turquoise' or i_color = 'chocolate') and (i_units = 'Bundle' or i_units = 'Unknown') and (i_size = 'large' or i_size = 'extra large') ) or (i_category = 'Women' and (i_color = 'maroon' or i_color = 'pale') and (i_units = 'Each' or i_units = 'Tbl') and (i_size = 'petite' or i_size = 'small') ) or (i_category = 'Men' and (i_color = 'almond' or i_color = 'floral') and (i_units = 'Gross' or i_units = 'N/A') and (i_size = 'economy' or i_size = 'medium') ) or (i_category = 'Men' and (i_color = 'drab' or i_color = 'plum') and (i_units = 'Bunch' or i_units = 'Case') and (i_size = 'large' or i_size = 'extra large') )))) > 0 order by i_product_name limit 100
23/11/30 19:02:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T19:02:01.447 END took 519 ms: q41 - iteration 3
2023-11-30T19:02:01.447 ================================================================================
2023-11-30T19:02:01.447 ================================================================================
2023-11-30T19:02:01.448 START: q42 - iteration 3
2023-11-30T19:02:01.448 SQL:  select  dt.d_year ,item.i_category_id ,item.i_category ,sum(ss_ext_sales_price) from 	date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=2002 group by 	dt.d_year ,item.i_category_id ,item.i_category order by       sum(ss_ext_sales_price) desc,dt.d_year ,item.i_category_id ,item.i_category limit 100 
23/11/30 19:02:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2534:>                                                   (0 + 114) / 114][Stage 2534:==============================>                     (66 + 48) / 114]                                                                                2023-11-30T19:02:03.219 END took 1771 ms: q42 - iteration 3
2023-11-30T19:02:03.219 ================================================================================
2023-11-30T19:02:03.219 ================================================================================
2023-11-30T19:02:03.219 START: q43 - iteration 3
2023-11-30T19:02:03.219 SQL:  select  s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from date_dim, store_sales, store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -5 and d_year = 2002 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales limit 100
23/11/30 19:02:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2538:>                                                   (0 + 114) / 114][Stage 2538:====>                                               (9 + 105) / 114][Stage 2538:===================================================>(112 + 2) / 114]                                                                                2023-11-30T19:02:05.188 END took 1969 ms: q43 - iteration 3
2023-11-30T19:02:05.188 ================================================================================
2023-11-30T19:02:05.188 ================================================================================
2023-11-30T19:02:05.188 START: q44 - iteration 3
2023-11-30T19:02:05.188 SQL:  select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select * from (select item_sk,rank() over (order by rank_col asc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 709 group by ss_item_sk having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 709 and ss_addr_sk is null group by ss_store_sk))V1)V11 where rnk  < 11) asceding, (select * from (select item_sk,rank() over (order by rank_col desc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 709 group by ss_item_sk having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 709 and ss_addr_sk is null group by ss_store_sk))V2)V21 where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk and i1.i_item_sk=asceding.item_sk and i2.i_item_sk=descending.item_sk order by asceding.rnk limit 100
23/11/30 19:02:05 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:05 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T19:02:06.883 END took 1694 ms: q44 - iteration 3
2023-11-30T19:02:06.883 ================================================================================
2023-11-30T19:02:06.883 ================================================================================
2023-11-30T19:02:06.883 START: q45 - iteration 3
2023-11-30T19:02:06.883 SQL:  select  ca_zip, ca_state, sum(ws_sales_price) from web_sales, customer, customer_address, date_dim, item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 2002 group by ca_zip, ca_state order by ca_zip, ca_state limit 100
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2563:>                                                     (0 + 57) / 57][Stage 2563:====================================================> (55 + 2) / 57]                                                                                2023-11-30T19:02:09.027 END took 2143 ms: q45 - iteration 3
2023-11-30T19:02:09.027 ================================================================================
2023-11-30T19:02:09.027 ================================================================================
2023-11-30T19:02:09.027 START: q46 - iteration 3
2023-11-30T19:02:09.027 SQL:  select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,amt,profit from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count= 1) and date_dim.d_dow in (6,0) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in ('Johnson','Norwood','Cambridge','Klondike','Rock Hill') group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number limit 100
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2570:>                                                   (0 + 114) / 114][Stage 2570:==================================================> (110 + 4) / 114]                                                                                2023-11-30T19:02:11.413 END took 2386 ms: q46 - iteration 3
2023-11-30T19:02:11.413 ================================================================================
2023-11-30T19:02:11.413 ================================================================================
2023-11-30T19:02:11.413 START: q47 - iteration 3
2023-11-30T19:02:11.413 SQL:  with v1 as( select i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, s_store_name, s_company_name order by d_year, d_moy) rn from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ( d_year = 2001 or ( d_year = 2001-1 and d_moy =12) or ( d_year = 2001+1 and d_moy =1) ) group by i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 as( select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name ,v1.d_year, v1.d_moy ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1.s_store_name = v1_lag.s_store_name and v1.s_store_name = v1_lead.s_store_name and v1.s_company_name = v1_lag.s_company_name and v1.s_company_name = v1_lead.s_company_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 2001 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales, psum limit 100
23/11/30 19:02:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2575:>                                                   (0 + 114) / 114][Stage 2575:=========>                                          (20 + 94) / 114][Stage 2575:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:02:15.260 END took 3847 ms: q47 - iteration 3
2023-11-30T19:02:15.260 ================================================================================
2023-11-30T19:02:15.260 ================================================================================
2023-11-30T19:02:15.260 START: q48 - iteration 3
2023-11-30T19:02:15.260 SQL:  select sum (ss_quantity) from store_sales, store, customer_demographics, customer_address, date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2000 and ( ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and ss_sales_price between 100.00 and 150.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '4 yr Degree' and ss_sales_price between 150.00 and 200.00 ) ) and ( ( ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MT', 'OH', 'GA') and ss_net_profit between 0 and 2000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('WV', 'AZ', 'NM') and ss_net_profit between 150 and 3000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NY', 'PA', 'KY') and ss_net_profit between 50 and 25000 ) )
23/11/30 19:02:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2586:>                                                   (0 + 114) / 114][Stage 2586:====>                                              (10 + 104) / 114]                                                                                2023-11-30T19:02:17.647 END took 2387 ms: q48 - iteration 3
2023-11-30T19:02:17.647 ================================================================================
2023-11-30T19:02:17.647 ================================================================================
2023-11-30T19:02:17.647 START: q49 - iteration 3
2023-11-30T19:02:17.647 SQL:  select  channel, item, return_ratio, return_rank, currency_rank from (select 'web' as channel ,web.item ,web.return_ratio ,web.return_rank ,web.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select ws.ws_item_sk as item ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio from web_sales ws left outer join web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk) ,date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel ,catalog.item ,catalog.return_ratio ,catalog.return_rank ,catalog.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select cs.cs_item_sk as item ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio from catalog_sales cs left outer join catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk) ,date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel ,store.item ,store.return_ratio ,store.return_rank ,store.currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select sts.ss_item_sk as item ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio from store_sales sts left outer join store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk) ,date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where  ( store.return_rank <= 10 or store.currency_rank <= 10 ) ) order by 1,4,5,2 limit 100
23/11/30 19:02:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:18 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
23/11/30 19:02:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2591:(1 + 16) / 17][Stage 2592:(1 + 27) / 28][Stage 2593:(0 + 14) / 14][Stage 2591:(1 + 16) / 17][Stage 2592:(1 + 27) / 28][Stage 2593:(1 + 13) / 14]                                                                                23/11/30 19:02:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2594:(0 + 57) / 57][Stage 2595:(0 + 86) / 114][Stage 2596:(1 + 57) / 58][Stage 2594:(24 + 33) / 57][Stage 2595:(31 + 83) / 114][Stage 2596:(56 + 2) / 58][Stage 2595:=======================================>            (86 + 28) / 114][Stage 2595:=========================================>          (90 + 24) / 114]                                                                                2023-11-30T19:02:23.205 END took 5557 ms: q49 - iteration 3
2023-11-30T19:02:23.205 ================================================================================
2023-11-30T19:02:23.205 ================================================================================
2023-11-30T19:02:23.205 START: q5 - iteration 3
2023-11-30T19:02:23.205 SQL:  with ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ss_store_sk as store_sk, ss_sold_date_sk  as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  cs_catalog_page_sk as page_sk, cs_sold_date_sk  as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk  as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) +  INTERVAL 14 days) and wsr_web_site_sk = web_site_sk group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from   ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from  csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:24 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2606:>                                                     (1 + 66) / 67][Stage 2606:=================>                                   (22 + 45) / 67]                                                                                23/11/30 19:02:25 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:25 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2607:(0 + 114) / 114][Stage 2608:(1 + 86) / 123][Stage 2609:(0 + 0) / 177][Stage 2607:(4 + 110) / 114][Stage 2608:(1 + 90) / 123][Stage 2609:(0 + 0) / 177][Stage 2608:========>   (86 + 37) / 123][Stage 2609:>           (0 + 163) / 177][Stage 2608:========>   (87 + 36) / 123][Stage 2609:>           (0 + 164) / 177][Stage 2608:========>   (88 + 35) / 123][Stage 2609:>           (0 + 165) / 177][Stage 2608:===========>(116 + 7) / 123][Stage 2609:==>        (35 + 142) / 177][Stage 2609:==============================================>    (162 + 15) / 177][Stage 2609:===============================================>   (164 + 13) / 177][Stage 2609:===============================================>   (165 + 12) / 177][Stage 2609:===============================================>   (166 + 11) / 177]                                                                                2023-11-30T19:02:29.709 END took 6504 ms: q5 - iteration 3
2023-11-30T19:02:29.709 ================================================================================
2023-11-30T19:02:29.710 ================================================================================
2023-11-30T19:02:29.710 START: q50 - iteration 3
2023-11-30T19:02:29.710 SQL:  select s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from store_sales ,store_returns ,store ,date_dim d1 ,date_dim d2 where d2.d_year = 2000 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip order by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip limit 100
23/11/30 19:02:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:30 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:30 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2612:>                                                     (1 + 62) / 63][Stage 2612:==========================================>          (51 + 12) / 63]                                                                                23/11/30 19:02:31 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:31 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2616:>                                                   (0 + 114) / 114][Stage 2616:================>                                   (36 + 78) / 114][Stage 2616:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:02:33.370 END took 3660 ms: q50 - iteration 3
2023-11-30T19:02:33.370 ================================================================================
2023-11-30T19:02:33.370 ================================================================================
2023-11-30T19:02:33.370 START: q51 - iteration 3
2023-11-30T19:02:33.370 SQL:  WITH web_v1 as ( select ws_item_sk item_sk, d_date, sum(sum(ws_sales_price)) over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales ,date_dim where ws_sold_date_sk=d_date_sk and d_month_seq between 1177 and 1177+11 and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select ss_item_sk item_sk, d_date, sum(sum(ss_sales_price)) over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales ,date_dim where ss_sold_date_sk=d_date_sk and d_month_seq between 1177 and 1177+11 and ss_item_sk is not NULL group by ss_item_sk, d_date) select  * from (select item_sk ,d_date ,web_sales ,store_sales ,max(web_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative ,max(store_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk ,case when web.d_date is not null then web.d_date else store.d_date end d_date ,web.cume_sales web_sales ,store.cume_sales store_sales from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk and web.d_date = store.d_date) )x )y where web_cumulative > store_cumulative order by item_sk ,d_date limit 100
23/11/30 19:02:33 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:33 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2619:>           (0 + 114) / 114][Stage 2621:>             (0 + 57) / 57][Stage 2619:>           (0 + 114) / 114][Stage 2621:=>            (7 + 50) / 57][Stage 2619:=======================================>            (87 + 27) / 114]                                                                                2023-11-30T19:02:36.409 END took 3038 ms: q51 - iteration 3
2023-11-30T19:02:36.409 ================================================================================
2023-11-30T19:02:36.409 ================================================================================
2023-11-30T19:02:36.409 START: q52 - iteration 3
2023-11-30T19:02:36.409 SQL:  select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_ext_sales_price) ext_price from date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=2001 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,ext_price desc ,brand_id limit 100 
23/11/30 19:02:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:36 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:36 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2629:>                                                   (0 + 114) / 114][Stage 2629:==========================================>         (94 + 20) / 114]                                                                                2023-11-30T19:02:38.210 END took 1801 ms: q52 - iteration 3
2023-11-30T19:02:38.210 ================================================================================
2023-11-30T19:02:38.211 ================================================================================
2023-11-30T19:02:38.211 START: q53 - iteration 3
2023-11-30T19:02:38.211 SQL:  select  * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1188,1188+1,1188+2,1188+3,1188+4,1188+5,1188+6,1188+7,1188+8,1188+9,1188+10,1188+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id limit 100
23/11/30 19:02:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2634:>                                                   (0 + 114) / 114][Stage 2634:===>                                                (7 + 107) / 114]                                                                                2023-11-30T19:02:40.437 END took 2226 ms: q53 - iteration 3
2023-11-30T19:02:40.437 ================================================================================
2023-11-30T19:02:40.437 ================================================================================
2023-11-30T19:02:40.437 START: q54 - iteration 3
2023-11-30T19:02:40.437 SQL:  with my_customers as ( select distinct c_customer_sk , c_current_addr_sk from ( select cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk from   catalog_sales union all select ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk from   web_sales ) cs_or_ws_sales, item, date_dim, customer where   sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Men' and i_class = 'pants' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 5 and d_year = 2002 ) , my_revenue as ( select c_customer_sk, sum(ss_ext_sales_price) as revenue from   my_customers, store_sales, customer_address, store, date_dim where  c_current_addr_sk = ca_address_sk and ca_county = s_county and ca_state = s_state and ss_sold_date_sk = d_date_sk and c_customer_sk = ss_customer_sk and d_month_seq between (select distinct d_month_seq+1 from   date_dim where d_year = 2002 and d_moy = 5) and  (select distinct d_month_seq+3 from   date_dim where d_year = 2002 and d_moy = 5) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from   my_revenue ) select  segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2645:>           (1 + 114) / 115][Stage 2647:>            (0 + 86) / 114][Stage 2645:=====>      (48 + 67) / 115][Stage 2647:>          (10 + 104) / 114][Stage 2647:======================================>             (85 + 29) / 114][Stage 2647:=======================================>            (86 + 28) / 114]                                                                                2023-11-30T19:02:44.367 END took 3929 ms: q54 - iteration 3
2023-11-30T19:02:44.367 ================================================================================
2023-11-30T19:02:44.367 ================================================================================
2023-11-30T19:02:44.367 START: q55 - iteration 3
2023-11-30T19:02:44.367 SQL:  select  i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=67 and d_moy=11 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 
23/11/30 19:02:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2652:>                                                   (0 + 114) / 114][Stage 2652:================================================>   (107 + 7) / 114]                                                                                2023-11-30T19:02:46.224 END took 1856 ms: q55 - iteration 3
2023-11-30T19:02:46.224 ================================================================================
2023-11-30T19:02:46.224 ================================================================================
2023-11-30T19:02:46.224 START: q56 - iteration 3
2023-11-30T19:02:46.224 SQL:  with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in ('blanched','spring','seashell')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1999 and     d_moy                   = 6 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -7 group by i_item_id) select  i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales, i_item_id limit 100
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2658:(0 + 57) / 57][Stage 2659:(1 + 57) / 58][Stage 2660:(0 + 86) / 114][Stage 2659:==========>  (47 + 11) / 58][Stage 2660:======>     (57 + 57) / 114][Stage 2660:======================================>             (85 + 29) / 114][Stage 2660:=======================================>            (86 + 28) / 114][Stage 2660:==================================================> (110 + 4) / 114]                                                                                2023-11-30T19:02:50.331 END took 4107 ms: q56 - iteration 3
2023-11-30T19:02:50.331 ================================================================================
2023-11-30T19:02:50.331 ================================================================================
2023-11-30T19:02:50.331 START: q57 - iteration 3
2023-11-30T19:02:50.331 SQL:  with v1 as( select i_category, i_brand, cc_name, d_year, d_moy, sum(cs_sales_price) sum_sales, avg(sum(cs_sales_price)) over (partition by i_category, i_brand, cc_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, cc_name order by d_year, d_moy) rn from item, catalog_sales, date_dim, call_center where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and cc_call_center_sk= cs_call_center_sk and ( d_year = 2000 or ( d_year = 2000-1 and d_moy =12) or ( d_year = 2000+1 and d_moy =1) ) group by i_category, i_brand, cc_name , d_year, d_moy), v2 as( select v1.i_category, v1.i_brand ,v1.d_year ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1. cc_name = v1_lag. cc_name and v1. cc_name = v1_lead. cc_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 2000 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales, sum_sales limit 100
23/11/30 19:02:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2666:>                                                     (1 + 57) / 58][Stage 2666:=========================>                           (28 + 30) / 58]                                                                                2023-11-30T19:02:54.299 END took 3967 ms: q57 - iteration 3
2023-11-30T19:02:54.299 ================================================================================
2023-11-30T19:02:54.299 ================================================================================
2023-11-30T19:02:54.299 START: q58 - iteration 3
2023-11-30T19:02:54.299 SQL:  with ss_items as (select i_item_id item_id ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '2000-05-24')) and ss_sold_date_sk   = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '2000-05-24')) and  cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq =(select d_week_seq from date_dim where d_date = '2000-05-24')) and ws_sold_date_sk   = d_date_sk group by i_item_id) select  ss_items.item_id ,ss_item_rev ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev ,cs_item_rev ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev ,ws_item_rev ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id ,ss_item_rev limit 100
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:55 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2682:(0 + 114) / 114][Stage 2683:(1 + 57) / 58][Stage 2684:(0 + 29) / 57][Stage 2682:(19 + 95) / 114][Stage 2683:(1 + 57) / 58][Stage 2684:(0 + 48) / 57][Stage 2683:=============>(57 + 1) / 58][Stage 2684:======>      (27 + 30) / 57][Stage 2684:==========================>                          (29 + 28) / 57]                                                                                2023-11-30T19:02:58.491 END took 4191 ms: q58 - iteration 3
2023-11-30T19:02:58.491 ================================================================================
2023-11-30T19:02:58.491 ================================================================================
2023-11-30T19:02:58.491 START: q59 - iteration 3
2023-11-30T19:02:58.491 SQL:  with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select  s_store_name1,s_store_id1,d_week_seq1 ,sun_sales1/sun_sales2,mon_sales1/mon_sales2 ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2 ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1 ,s_store_id s_store_id1,sun_sales sun_sales1 ,mon_sales mon_sales1,tue_sales tue_sales1 ,wed_sales wed_sales1,thu_sales thu_sales1 ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1197 and 1197 + 11) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2 ,s_store_id s_store_id2,sun_sales sun_sales2 ,mon_sales mon_sales2,tue_sales tue_sales2 ,wed_sales wed_sales2,thu_sales thu_sales2 ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1197+ 12 and 1197 + 23) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:02:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2691:>                                                   (0 + 114) / 114][Stage 2691:==========>                                         (23 + 91) / 114]                                                                                2023-11-30T19:03:01.411 END took 2919 ms: q59 - iteration 3
2023-11-30T19:03:01.411 ================================================================================
2023-11-30T19:03:01.411 ================================================================================
2023-11-30T19:03:01.411 START: q6 - iteration 3
2023-11-30T19:03:01.411 SQL:  select  a.ca_state state, count(*) cnt from customer_address a ,customer c ,store_sales s ,date_dim d ,item i where       a.ca_address_sk = c.c_current_addr_sk and c.c_customer_sk = s.ss_customer_sk and s.ss_sold_date_sk = d.d_date_sk and s.ss_item_sk = i.i_item_sk and d.d_month_seq = (select distinct (d_month_seq) from date_dim where d_year = 2002 and d_moy = 3 ) and i.i_current_price > 1.2 * (select avg(j.i_current_price) from item j where j.i_category = i.i_category) group by a.ca_state having count(*) >= 10 order by cnt, a.ca_state limit 100
23/11/30 19:03:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2699:>                                                   (0 + 114) / 114][Stage 2699:==================================================> (111 + 3) / 114][Stage 2701:===================================>               (139 + 10) / 200]                                                                                2023-11-30T19:03:04.770 END took 3359 ms: q6 - iteration 3
2023-11-30T19:03:04.770 ================================================================================
2023-11-30T19:03:04.770 ================================================================================
2023-11-30T19:03:04.770 START: q60 - iteration 3
2023-11-30T19:03:04.770 SQL:  with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_category in ('Shoes')) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in ('Shoes')) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in ('Shoes')) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by i_item_id ,total_sales limit 100
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2709:(1 + 57) / 58][Stage 2710:(0 + 57) / 57][Stage 2711:(0 + 86) / 114][Stage 2709:(57 + 1) / 58][Stage 2710:(41 + 16) / 57][Stage 2711:(60 + 54) / 114][Stage 2711:=======================================>            (86 + 28) / 114][Stage 2711:==============================================>    (104 + 10) / 114]                                                                                2023-11-30T19:03:08.764 END took 3993 ms: q60 - iteration 3
2023-11-30T19:03:08.764 ================================================================================
2023-11-30T19:03:08.764 ================================================================================
2023-11-30T19:03:08.764 START: q61 - iteration 3
2023-11-30T19:03:08.764 SQL:  select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from  store_sales ,store ,promotion ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_promo_sk = p_promo_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -7 and   i_category = 'Jewelry' and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and   s_gmt_offset = -7 and   d_year = 2002 and   d_moy  = 11) promotional_sales, (select sum(ss_ext_sales_price) total from  store_sales ,store ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -7 and   i_category = 'Jewelry' and   s_gmt_offset = -7 and   d_year = 2002 and   d_moy  = 11) all_sales order by promotions, total limit 100
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:09 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2719:>                                                   (0 + 114) / 114]                                                                                [Stage 2721:>                                                   (0 + 114) / 114][Stage 2721:=============================================>     (102 + 12) / 114]                                                                                2023-11-30T19:03:12.357 END took 3593 ms: q61 - iteration 3
2023-11-30T19:03:12.357 ================================================================================
2023-11-30T19:03:12.357 ================================================================================
2023-11-30T19:03:12.357 START: q62 - iteration 3
2023-11-30T19:03:12.357 SQL:  select substr(w_warehouse_name,1,20) ,sm_type ,web_name ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from web_sales ,warehouse ,ship_mode ,web_site ,date_dim where d_month_seq between 1194 and 1194 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by substr(w_warehouse_name,1,20) ,sm_type ,web_name order by substr(w_warehouse_name,1,20) ,sm_type ,web_name limit 100
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2727:>                                                     (0 + 57) / 57][Stage 2727:====>                                                 (5 + 52) / 57][Stage 2727:=====================================================>(56 + 1) / 57]                                                                                2023-11-30T19:03:14.985 END took 2628 ms: q62 - iteration 3
2023-11-30T19:03:14.985 ================================================================================
2023-11-30T19:03:14.985 ================================================================================
2023-11-30T19:03:14.985 START: q63 - iteration 3
2023-11-30T19:03:14.985 SQL:  select  * from (select i_manager_id ,sum(ss_sales_price) sum_sales ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from item ,store_sales ,date_dim ,store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1222,1222+1,1222+2,1222+3,1222+4,1222+5,1222+6,1222+7,1222+8,1222+9,1222+10,1222+11) and ((    i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(    i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id ,avg_monthly_sales ,sum_sales limit 100
23/11/30 19:03:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:15 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:15 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2732:>                                                   (0 + 114) / 114][Stage 2732:=================>                                  (38 + 76) / 114]                                                                                2023-11-30T19:03:17.177 END took 2191 ms: q63 - iteration 3
2023-11-30T19:03:17.177 ================================================================================
2023-11-30T19:03:17.177 ================================================================================
2023-11-30T19:03:17.177 START: q64 - iteration 3
2023-11-30T19:03:17.177 SQL:  with cs_ui as (select cs_item_sk ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM   store_sales ,store_returns ,cs_ui ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,customer ,customer_demographics cd1 ,customer_demographics cd2 ,promotion ,household_demographics hd1 ,household_demographics hd2 ,customer_address ad1 ,customer_address ad2 ,income_band ib1 ,income_band ib2 ,item WHERE  ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_color in ('ivory','purple','almond','bisque','lawn','azure') and i_current_price between 60 and 60 + 10 and i_current_price between 60 + 1 and 60 + 15 group by i_product_name ,i_item_sk ,s_store_name ,s_zip ,ad1.ca_street_number ,ad1.ca_street_name ,ad1.ca_city ,ad1.ca_zip ,ad2.ca_street_number ,ad2.ca_street_name ,ad2.ca_city ,ad2.ca_zip ,d1.d_year ,d2.d_year ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name ,cs1.store_name ,cs2.cnt ,cs1.s1 ,cs2.s1
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:20 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2735:>             (1 + 64) / 65][Stage 2741:>             (1 + 62) / 63][Stage 2735:==>          (14 + 51) / 65][Stage 2741:==>          (12 + 51) / 63]                                                                                23/11/30 19:03:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:22 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:22 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2747:>           (0 + 114) / 114][Stage 2750:>               (0 + 1) / 1][Stage 2747:>           (0 + 114) / 114][Stage 2748:>             (0 + 58) / 58][Stage 2747:>           (0 + 114) / 114][Stage 2748:>             (1 + 57) / 58][Stage 2747:>           (3 + 111) / 114][Stage 2748:>             (1 + 57) / 58][Stage 2747:===========>(107 + 7) / 114][Stage 2748:=============>(54 + 4) / 58][Stage 2751:========>  (162 + 11) / 200][Stage 2755:>             (0 + 0) / 200][Stage 2755:==>                                                  (11 + 0) / 200][Stage 2755:=====>                                               (22 + 7) / 200][Stage 2755:======================>                             (85 + 11) / 200][Stage 2755:========================================>          (160 + 12) / 200]                                                                                2023-11-30T19:03:27.917 END took 10740 ms: q64 - iteration 3
2023-11-30T19:03:27.917 ================================================================================
2023-11-30T19:03:27.917 ================================================================================
2023-11-30T19:03:27.917 START: q65 - iteration 3
2023-11-30T19:03:27.917 SQL:  select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1185 and 1185+11 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc limit 100
23/11/30 19:03:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:28 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:28 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2775:>           (0 + 114) / 114][Stage 2777:>            (0 + 86) / 114][Stage 2775:=========>  (93 + 21) / 114][Stage 2777:====>       (38 + 76) / 114][Stage 2777:=======================================>            (86 + 28) / 114][Stage 2777:========================================>           (88 + 26) / 114]                                                                                2023-11-30T19:03:31.308 END took 3391 ms: q65 - iteration 3
2023-11-30T19:03:31.308 ================================================================================
2023-11-30T19:03:31.308 ================================================================================
2023-11-30T19:03:31.308 START: q66 - iteration 3
2023-11-30T19:03:31.308 SQL:  select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year ,sum(jan_sales) as jan_sales ,sum(feb_sales) as feb_sales ,sum(mar_sales) as mar_sales ,sum(apr_sales) as apr_sales ,sum(may_sales) as may_sales ,sum(jun_sales) as jun_sales ,sum(jul_sales) as jul_sales ,sum(aug_sales) as aug_sales ,sum(sep_sales) as sep_sales ,sum(oct_sales) as oct_sales ,sum(nov_sales) as nov_sales ,sum(dec_sales) as dec_sales ,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot ,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot ,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot ,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot ,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot ,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot ,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot ,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot ,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot ,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot ,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot ,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot ,sum(jan_net) as jan_net ,sum(feb_net) as feb_net ,sum(mar_net) as mar_net ,sum(apr_net) as apr_net ,sum(may_net) as may_net ,sum(jun_net) as jun_net ,sum(jul_net) as jul_net ,sum(aug_net) as aug_net ,sum(sep_net) as sep_net ,sum(oct_net) as oct_net ,sum(nov_net) as nov_net ,sum(dec_net) as dec_net from ( select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,'FEDEX' || ',' || 'MSC' as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then ws_ext_list_price* ws_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then ws_ext_list_price* ws_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then ws_ext_list_price* ws_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then ws_ext_list_price* ws_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then ws_ext_list_price* ws_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then ws_ext_list_price* ws_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then ws_ext_list_price* ws_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then ws_ext_list_price* ws_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then ws_ext_list_price* ws_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then ws_ext_list_price* ws_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then ws_ext_list_price* ws_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then ws_ext_list_price* ws_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then ws_net_profit * ws_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then ws_net_profit * ws_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then ws_net_profit * ws_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then ws_net_profit * ws_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then ws_net_profit * ws_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then ws_net_profit * ws_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then ws_net_profit * ws_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then ws_net_profit * ws_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then ws_net_profit * ws_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then ws_net_profit * ws_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then ws_net_profit * ws_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then ws_net_profit * ws_quantity else 0 end) as dec_net from web_sales ,warehouse ,date_dim ,time_dim ,ship_mode where ws_warehouse_sk =  w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2002 and t_time between 2662 and 2662+28800 and sm_carrier in ('FEDEX','MSC') group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year union all select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,'FEDEX' || ',' || 'MSC' as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then cs_ext_list_price* cs_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then cs_ext_list_price* cs_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then cs_ext_list_price* cs_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then cs_ext_list_price* cs_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then cs_ext_list_price* cs_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then cs_ext_list_price* cs_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then cs_ext_list_price* cs_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then cs_ext_list_price* cs_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then cs_ext_list_price* cs_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then cs_ext_list_price* cs_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then cs_ext_list_price* cs_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then cs_ext_list_price* cs_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then cs_net_profit * cs_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then cs_net_profit * cs_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then cs_net_profit * cs_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then cs_net_profit * cs_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then cs_net_profit * cs_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then cs_net_profit * cs_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then cs_net_profit * cs_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then cs_net_profit * cs_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then cs_net_profit * cs_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then cs_net_profit * cs_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then cs_net_profit * cs_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then cs_net_profit * cs_quantity else 0 end) as dec_net from catalog_sales ,warehouse ,date_dim ,time_dim ,ship_mode where cs_warehouse_sk =  w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2002 and t_time between 2662 AND 2662+28800 and sm_carrier in ('FEDEX','MSC') group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year ) x group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year order by w_warehouse_name limit 100
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:32 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2784:>             (1 + 57) / 58][Stage 2785:>             (0 + 57) / 57][Stage 2784:======>      (29 + 29) / 58][Stage 2785:=====>       (24 + 33) / 57]                                                                                2023-11-30T19:03:34.605 END took 3296 ms: q66 - iteration 3
2023-11-30T19:03:34.605 ================================================================================
2023-11-30T19:03:34.605 ================================================================================
2023-11-30T19:03:34.605 START: q67 - iteration 3
2023-11-30T19:03:34.605 SQL:  select  * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1177 and 1177+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100
23/11/30 19:03:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:35 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:35 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2791:>                                                   (0 + 114) / 114][Stage 2791:====>                                              (11 + 103) / 114][Stage 2791:============================================>       (98 + 16) / 114][Stage 2791:=================================================>  (109 + 5) / 114][Stage 2791:===================================================>(112 + 2) / 114]                                                                                2023-11-30T19:03:37.604 END took 2998 ms: q67 - iteration 3
2023-11-30T19:03:37.604 ================================================================================
2023-11-30T19:03:37.604 ================================================================================
2023-11-30T19:03:37.604 START: q68 - iteration 3
2023-11-30T19:03:37.604 SQL:  select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,extended_price ,extended_tax ,list_price from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_ext_sales_price) extended_price ,sum(ss_ext_list_price) list_price ,sum(ss_ext_tax) extended_tax from store_sales ,date_dim ,store ,household_demographics ,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count= 4) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in ('Lodi','Richmond') group by ss_ticket_number ,ss_customer_sk ,ss_addr_sk,ca_city) dn ,customer ,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ,ss_ticket_number limit 100
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:38 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2799:>                                                   (0 + 114) / 114][Stage 2799:===============================>                    (68 + 46) / 114]                                                                                2023-11-30T19:03:39.941 END took 2337 ms: q68 - iteration 3
2023-11-30T19:03:39.941 ================================================================================
2023-11-30T19:03:39.941 ================================================================================
2023-11-30T19:03:39.941 START: q69 - iteration 3
2023-11-30T19:03:39.941 SQL:  select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in ('IL','FL','SD') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2) and (not exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2) and not exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 1+2)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100
23/11/30 19:03:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2804:(0 + 114) / 114][Stage 2805:(0 + 57) / 57][Stage 2806:(0 + 28) / 58][Stage 2804:(1 + 113) / 114][Stage 2805:(0 + 57) / 57][Stage 2806:(0 + 30) / 58][Stage 2804:(111 + 3) / 114][Stage 2805:(48 + 9) / 57][Stage 2806:(23 + 35) / 58][Stage 2806:==========================>                          (29 + 29) / 58][Stage 2806:==================================>                  (38 + 20) / 58]                                                                                2023-11-30T19:03:44.523 END took 4582 ms: q69 - iteration 3
2023-11-30T19:03:44.523 ================================================================================
2023-11-30T19:03:44.523 ================================================================================
2023-11-30T19:03:44.523 START: q7 - iteration 3
2023-11-30T19:03:44.523 SQL:  select  i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, item, promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id limit 100
23/11/30 19:03:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2814:>                                                   (0 + 114) / 114][Stage 2814:>                                                   (1 + 113) / 114][Stage 2814:===================================================>(113 + 1) / 114][Stage 2816:==========================================>        (165 + 11) / 200]                                                                                2023-11-30T19:03:47.247 END took 2724 ms: q7 - iteration 3
2023-11-30T19:03:47.247 ================================================================================
2023-11-30T19:03:47.248 ================================================================================
2023-11-30T19:03:47.248 START: q70 - iteration 3
2023-11-30T19:03:47.248 SQL:  select sum(ss_net_profit) as total_sum ,s_state ,s_county ,grouping(s_state)+grouping(s_county) as lochierarchy ,rank() over ( partition by grouping(s_state)+grouping(s_county), case when grouping(s_county) = 0 then s_state end order by sum(ss_net_profit) desc) as rank_within_parent from store_sales ,date_dim       d1 ,store where d1.d_month_seq between 1206 and 1206+11 and d1.d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk and s_state in ( select s_state from  (select s_state as s_state, rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking from   store_sales, store, date_dim where  d_month_seq between 1206 and 1206+11 and d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk group by s_state ) tmp1 where ranking <= 5 ) group by rollup(s_state,s_county) order by lochierarchy desc ,case when lochierarchy = 0 then s_state end ,rank_within_parent limit 100
23/11/30 19:03:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2820:>                                                   (0 + 114) / 114][Stage 2820:==========>                                         (22 + 92) / 114]                                                                                23/11/30 19:03:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2825:>                                                   (0 + 114) / 114][Stage 2825:>                                                   (1 + 113) / 114]                                                                                2023-11-30T19:03:51.503 END took 4254 ms: q70 - iteration 3
2023-11-30T19:03:51.503 ================================================================================
2023-11-30T19:03:51.503 ================================================================================
2023-11-30T19:03:51.503 START: q71 - iteration 3
2023-11-30T19:03:51.503 SQL:  select i_brand_id brand_id, i_brand brand,t_hour,t_minute, sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price, ws_sold_date_sk as sold_date_sk, ws_item_sk as sold_item_sk, ws_sold_time_sk as time_sk from web_sales,date_dim where d_date_sk = ws_sold_date_sk and d_moy=11 and d_year=1999 union all select cs_ext_sales_price as ext_price, cs_sold_date_sk as sold_date_sk, cs_item_sk as sold_item_sk, cs_sold_time_sk as time_sk from catalog_sales,date_dim where d_date_sk = cs_sold_date_sk and d_moy=11 and d_year=1999 union all select ss_ext_sales_price as ext_price, ss_sold_date_sk as sold_date_sk, ss_item_sk as sold_item_sk, ss_sold_time_sk as time_sk from store_sales,date_dim where d_date_sk = ss_sold_date_sk and d_moy=11 and d_year=1999 ) tmp,time_dim where sold_item_sk = i_item_sk and i_manager_id=1 and time_sk = t_time_sk and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id 
23/11/30 19:03:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2831:>                                                   (1 + 200) / 229][Stage 2831:==================================>                (153 + 76) / 229][Stage 2831:============================================>      (199 + 30) / 229][Stage 2831:============================================>      (201 + 28) / 229][Stage 2831:==============================================>    (209 + 20) / 229]                                                                                2023-11-30T19:03:55.142 END took 3639 ms: q71 - iteration 3
2023-11-30T19:03:55.142 ================================================================================
2023-11-30T19:03:55.142 ================================================================================
2023-11-30T19:03:55.142 START: q72 - iteration 3
2023-11-30T19:03:55.142 SQL:  select  i_item_desc ,w_warehouse_name ,d1.d_week_seq ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo ,sum(case when p_promo_sk is not null then 1 else 0 end) promo ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand < cs_quantity and d3.d_date > d1.d_date + interval 5 days and hd_buy_potential = '1001-5000' and d1.d_year = 2000 and cd_marital_status = 'S' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq limit 100
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2841:>                                                     (1 + 64) / 65][Stage 2841:=====================================================>(64 + 1) / 65]                                                                                23/11/30 19:03:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:03:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2844:>             (1 + 57) / 58][Stage 2845:=>              (1 + 8) / 9][Stage 2844:=========>   (44 + 14) / 58][Stage 2845:=>              (1 + 8) / 9][Stage 2845:======>                                                 (1 + 8) / 9][Stage 2845:===========================================>            (7 + 2) / 9][Stage 2848:======>                                             (25 + 11) / 200][Stage 2848:==========>                                         (42 + 12) / 200][Stage 2848:=================>                                  (67 + 11) / 200][Stage 2848:=======================>                            (92 + 11) / 200][Stage 2848:=============================>                     (117 + 11) / 200][Stage 2848:===================================>               (140 + 11) / 200][Stage 2848:=========================================>         (164 + 11) / 200][Stage 2848:================================================>  (189 + 11) / 200]                                                                                2023-11-30T19:04:02.241 END took 7098 ms: q72 - iteration 3
2023-11-30T19:04:02.241 ================================================================================
2023-11-30T19:04:02.241 ================================================================================
2023-11-30T19:04:02.241 START: q73 - iteration 3
2023-11-30T19:04:02.241 SQL:  select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = 'Unknown') and household_demographics.hd_vehicle_count > 0 and case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_county in ('Humboldt County','Hickman County','Galax city','Abbeville County') group by ss_ticket_number,ss_customer_sk) dj,customer where ss_customer_sk = c_customer_sk and cnt between 1 and 5 order by cnt desc, c_last_name asc
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2854:>                                                   (0 + 114) / 114][Stage 2854:==============================================>    (103 + 11) / 114]                                                                                2023-11-30T19:04:04.808 END took 2567 ms: q73 - iteration 3
2023-11-30T19:04:04.808 ================================================================================
2023-11-30T19:04:04.808 ================================================================================
2023-11-30T19:04:04.808 START: q74 - iteration 3
2023-11-30T19:04:04.809 SQL:  with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,max(ss_net_paid) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2001,2001+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,max(ws_net_paid) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year in (2001,2001+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year ) select t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.year = 2001 and t_s_secyear.year = 2001+1 and t_w_firstyear.year = 2001 and t_w_secyear.year = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end order by 3,1,2 limit 100
23/11/30 19:04:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2862:(0 + 57) / 57][Stage 2864:(0 + 114) / 114][Stage 2866:(0 + 29) / 114][Stage 2862:(56 + 1) / 57][Stage 2864:(95 + 19) / 114][Stage 2866:(27 + 87) / 114][Stage 2866:===>        (29 + 85) / 114][Stage 2868:>             (0 + 57) / 57][Stage 2866:=====>      (48 + 66) / 114][Stage 2868:>             (0 + 57) / 57]                                                                                2023-11-30T19:04:09.220 END took 4410 ms: q74 - iteration 3
2023-11-30T19:04:09.220 ================================================================================
2023-11-30T19:04:09.220 ================================================================================
2023-11-30T19:04:09.220 START: q75 - iteration 3
2023-11-30T19:04:09.220 SQL:  WITH all_sales AS ( SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,SUM(sales_cnt) AS sales_cnt ,SUM(sales_amt) AS sales_amt FROM (SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk JOIN date_dim ON d_date_sk=cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number AND cs_item_sk=cr_item_sk) WHERE i_category='Books' UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk=ss_item_sk JOIN date_dim ON d_date_sk=ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number AND ss_item_sk=sr_item_sk) WHERE i_category='Books' UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk=ws_item_sk JOIN date_dim ON d_date_sk=ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number=wr_order_number AND ws_item_sk=wr_item_sk) WHERE i_category='Books') sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT  prev_yr.d_year AS prev_year ,curr_yr.d_year AS year ,curr_yr.i_brand_id ,curr_yr.i_class_id ,curr_yr.i_category_id ,curr_yr.i_manufact_id ,prev_yr.sales_cnt AS prev_yr_cnt ,curr_yr.sales_cnt AS curr_yr_cnt ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff FROM all_sales curr_yr, all_sales prev_yr WHERE curr_yr.i_brand_id=prev_yr.i_brand_id AND curr_yr.i_class_id=prev_yr.i_class_id AND curr_yr.i_category_id=prev_yr.i_category_id AND curr_yr.i_manufact_id=prev_yr.i_manufact_id AND curr_yr.d_year=2001 AND prev_yr.d_year=2001-1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9 ORDER BY sales_cnt_diff,sales_amt_diff limit 100
23/11/30 19:04:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2871:(1 + 62) / 63][Stage 2874:(1 + 64) / 65][Stage 2875:(1 + 66) / 67][Stage 2871:(18 + 45) / 63][Stage 2874:(1 + 64) / 65][Stage 2875:(1 + 66) / 67]                                                                                23/11/30 19:04:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:12 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:12 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2877:>           (1 + 200) / 229][Stage 2880:>             (0 + 0) / 229][Stage 2877:>           (2 + 200) / 229][Stage 2880:>             (0 + 0) / 229][Stage 2877:========>  (184 + 45) / 229][Stage 2880:>           (0 + 155) / 229][Stage 2877:=========> (201 + 28) / 229][Stage 2880:>           (1 + 172) / 229][Stage 2877:===========>(223 + 6) / 229][Stage 2880:>          (12 + 194) / 229][Stage 2880:==================================>                (157 + 72) / 229][Stage 2880:======================================>            (173 + 56) / 229]                                                                                2023-11-30T19:04:17.324 END took 8104 ms: q75 - iteration 3
2023-11-30T19:04:17.324 ================================================================================
2023-11-30T19:04:17.324 ================================================================================
2023-11-30T19:04:17.324 START: q76 - iteration 3
2023-11-30T19:04:17.324 SQL:  select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM ( SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price FROM store_sales, item, date_dim WHERE ss_promo_sk IS NULL AND ss_sold_date_sk=d_date_sk AND ss_item_sk=i_item_sk UNION ALL SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price FROM web_sales, item, date_dim WHERE ws_ship_addr_sk IS NULL AND ws_sold_date_sk=d_date_sk AND ws_item_sk=i_item_sk UNION ALL SELECT 'catalog' as channel, 'cs_ship_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price FROM catalog_sales, item, date_dim WHERE cs_ship_customer_sk IS NULL AND cs_sold_date_sk=d_date_sk AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100
23/11/30 19:04:17 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:17 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:18 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:18 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2886:>                                                   (2 + 161) / 163][Stage 2886:>                                                   (3 + 160) / 163][Stage 2886:==============================================>    (149 + 14) / 163]                                                                                2023-11-30T19:04:19.766 END took 2442 ms: q76 - iteration 3
2023-11-30T19:04:19.766 ================================================================================
2023-11-30T19:04:19.766 ================================================================================
2023-11-30T19:04:19.766 START: q77 - iteration 3
2023-11-30T19:04:19.766 SQL:  with ss as (select s_store_sk, sum(ss_ext_sales_price) as sales, sum(ss_net_profit) as profit from store_sales, date_dim, store where ss_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and ss_store_sk = s_store_sk group by s_store_sk) , sr as (select s_store_sk, sum(sr_return_amt) as returns, sum(sr_net_loss) as profit_loss from store_returns, date_dim, store where sr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and sr_store_sk = s_store_sk group by s_store_sk), cs as (select cs_call_center_sk, sum(cs_ext_sales_price) as sales, sum(cs_net_profit) as profit from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) group by cs_call_center_sk ), cr as (select cr_call_center_sk, sum(cr_return_amount) as returns, sum(cr_net_loss) as profit_loss from catalog_returns, date_dim where cr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) group by cr_call_center_sk ), ws as ( select wp_web_page_sk, sum(ws_ext_sales_price) as sales, sum(ws_net_profit) as profit from web_sales, date_dim, web_page where ws_sold_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and ws_web_page_sk = wp_web_page_sk group by wp_web_page_sk), wr as (select wp_web_page_sk, sum(wr_return_amt) as returns, sum(wr_net_loss) as profit_loss from web_returns, date_dim, web_page where wr_returned_date_sk = d_date_sk and d_date between cast('2001-08-16' as date) and (cast('2001-08-16' as date) +  INTERVAL 30 days) and wr_web_page_sk = wp_web_page_sk group by wp_web_page_sk) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , ss.s_store_sk as id , sales , coalesce(returns, 0) as returns , (profit - coalesce(profit_loss,0)) as profit from   ss left join sr on  ss.s_store_sk = sr.s_store_sk union all select 'catalog channel' as channel , cs_call_center_sk as id , sales , returns , (profit - profit_loss) as profit from  cs , cr union all select 'web channel' as channel , ws.wp_web_page_sk as id , sales , coalesce(returns, 0) returns , (profit - coalesce(profit_loss,0)) as profit from   ws left join wr on  ws.wp_web_page_sk = wr.wp_web_page_sk ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 19:04:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:21 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:21 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2891:(1 + 64) / 65][Stage 2892:(1 + 57) / 58][Stage 2893:(0 + 57) / 57][Stage 2891:(59 + 6) / 65][Stage 2892:(39 + 19) / 58][Stage 2893:(38 + 19) / 57][Stage 2894:(20 + 94) / 114][Stage 2895:(0 + 66) / 66][Stage 2896:(0 + 40) / 63][Stage 2894:(22 + 92) / 114][Stage 2895:(0 + 66) / 66][Stage 2896:(0 + 42) / 63][Stage 2894:(28 + 86) / 114][Stage 2895:(0 + 66) / 66][Stage 2896:(0 + 48) / 63][Stage 2894:(113 + 1) / 114][Stage 2895:(59 + 7) / 66][Stage 2896:(29 + 34) / 63][Stage 2896:==================================>                  (41 + 22) / 63][Stage 2896:===================================>                 (42 + 21) / 63][Stage 2896:====================================>                (43 + 20) / 63][Stage 2896:=====================================================>(62 + 1) / 63][Stage 2897:=>                                             (1276 + 261) / 40400][Stage 2897:==>                                            (2063 + 215) / 40400][Stage 2897:===>                                           (2802 + 216) / 40400][Stage 2897:====>                                          (3476 + 216) / 40400][Stage 2897:====>                                          (4185 + 292) / 40400][Stage 2897:=====>                                         (4838 + 270) / 40400][Stage 2897:======>                                        (5698 + 213) / 40400][Stage 2897:=======>                                       (6490 + 232) / 40400][Stage 2897:========>                                      (7025 + 263) / 40400]23/11/30 19:04:27 WARN AsyncEventQueue: Dropped 35767 events from eventLog since Thu Nov 30 18:57:30 IST 2023.
[Stage 2897:=========>                                     (7837 + 202) / 40400][Stage 2897:==========>                                    (8623 + 285) / 40400][Stage 2897:==========>                                    (9169 + 203) / 40400][Stage 2897:===========>                                   (9933 + 216) / 40400][Stage 2897:============>                                 (10607 + 204) / 40400]23/11/30 19:04:28 WARN AsyncEventQueue: Dropped 22650 events from executorManagement since Thu Nov 30 18:57:32 IST 2023.
[Stage 2897:=============>                                (11428 + 246) / 40400][Stage 2897:=============>                                (12030 + 218) / 40400][Stage 2897:==============>                               (12808 + 218) / 40400][Stage 2897:===============>                              (13374 + 206) / 40400][Stage 2897:================>                             (14079 + 232) / 40400][Stage 2897:================>                             (14615 + 211) / 40400][Stage 2897:=================>                            (15390 + 211) / 40400][Stage 2897:==================>                           (15948 + 205) / 40400][Stage 2897:==================>                           (16537 + 207) / 40400][Stage 2897:===================>                          (17255 + 217) / 40400][Stage 2897:====================>                         (17803 + 219) / 40400][Stage 2897:=====================>                        (18541 + 272) / 40400][Stage 2897:=====================>                        (19081 + 202) / 40400][Stage 2897:======================>                       (19843 + 202) / 40400][Stage 2897:=======================>                      (20392 + 227) / 40400][Stage 2897:========================>                     (21136 + 214) / 40400][Stage 2897:========================>                     (21833 + 266) / 40400][Stage 2897:=========================>                    (22617 + 251) / 40400][Stage 2897:==========================>                   (23325 + 203) / 40400][Stage 2897:===========================>                  (24114 + 209) / 40400][Stage 2897:============================>                 (24782 + 205) / 40400][Stage 2897:=============================>                (25552 + 264) / 40400][Stage 2897:=============================>                (26203 + 209) / 40400][Stage 2897:==============================>               (26910 + 236) / 40400][Stage 2897:===============================>              (27496 + 316) / 40400][Stage 2897:================================>             (28108 + 200) / 40400][Stage 2897:================================>             (28701 + 320) / 40400][Stage 2897:=================================>            (29279 + 205) / 40400][Stage 2897:=================================>            (29820 + 220) / 40400][Stage 2897:==================================>           (30524 + 223) / 40400][Stage 2897:===================================>          (31162 + 215) / 40400][Stage 2897:====================================>         (31956 + 222) / 40400][Stage 2897:=====================================>        (32585 + 210) / 40400][Stage 2897:======================================>       (33414 + 202) / 40400][Stage 2897:======================================>       (34019 + 250) / 40400][Stage 2897:=======================================>      (34839 + 225) / 40400][Stage 2897:========================================>     (35494 + 213) / 40400][Stage 2897:=========================================>    (36309 + 221) / 40400][Stage 2897:==========================================>   (37059 + 205) / 40400][Stage 2897:===========================================>  (37856 + 202) / 40400][Stage 2897:============================================> (38684 + 203) / 40400][Stage 2897:============================================> (39289 + 213) / 40400][Stage 2897:=============================================>(39955 + 218) / 40400][Stage 2897:==============================================>(40378 + 22) / 40400]                                                                                2023-11-30T19:04:38.860 END took 19093 ms: q77 - iteration 3
2023-11-30T19:04:38.860 ================================================================================
2023-11-30T19:04:38.860 ================================================================================
2023-11-30T19:04:38.860 START: q78 - iteration 3
2023-11-30T19:04:38.860 SQL:  with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from web_sales left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from catalog_sales left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from store_sales left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_item_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000 order by ss_item_sk, ss_qty desc, ss_wc desc, ss_sp desc, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio limit 100
23/11/30 19:04:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2899:(1 + 64) / 65][Stage 2900:(1 + 66) / 67][Stage 2901:(0 + 63) / 63][Stage 2899:(1 + 64) / 65][Stage 2900:(1 + 66) / 67][Stage 2901:(1 + 62) / 63][Stage 2899:(8 + 57) / 65][Stage 2900:(1 + 66) / 67][Stage 2901:(1 + 62) / 63]                                                                                23/11/30 19:04:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:41 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:41 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2904:(0 + 114) / 114][Stage 2905:(0 + 57) / 57][Stage 2906:(0 + 29) / 58][Stage 2904:(17 + 97) / 114][Stage 2905:(3 + 54) / 57][Stage 2906:(0 + 49) / 58][Stage 2906:==========================>                          (29 + 29) / 58][Stage 2906:===========================>                         (30 + 28) / 58][Stage 2906:===========================================>         (48 + 10) / 58]                                                                                2023-11-30T19:04:44.446 END took 5585 ms: q78 - iteration 3
2023-11-30T19:04:44.446 ================================================================================
2023-11-30T19:04:44.446 ================================================================================
2023-11-30T19:04:44.446 START: q79 - iteration 3
2023-11-30T19:04:44.446 SQL:  select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number ,ss_customer_sk ,store.s_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > -1) and date_dim.d_dow = 1 and date_dim.d_year in (1999,1999+1,1999+2) and store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:45 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2912:>                                                   (0 + 114) / 114][Stage 2912:=================>                                  (38 + 76) / 114]                                                                                2023-11-30T19:04:46.884 END took 2438 ms: q79 - iteration 3
2023-11-30T19:04:46.884 ================================================================================
2023-11-30T19:04:46.884 ================================================================================
2023-11-30T19:04:46.884 START: q8 - iteration 3
2023-11-30T19:04:46.884 SQL:  select  s_store_name ,sum(ss_net_profit) from store_sales ,date_dim ,store, (select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( '47602','16704','35863','28577','83910','36201', '58412','48162','28055','41419','80332', '38607','77817','24891','16226','18410', '21231','59345','13918','51089','20317', '17167','54585','67881','78366','47770', '18360','51717','73108','14440','21800', '89338','45859','65501','34948','25973', '73219','25333','17291','10374','18829', '60736','82620','41351','52094','19326', '25214','54207','40936','21814','79077', '25178','75742','77454','30621','89193', '27369','41232','48567','83041','71948', '37119','68341','14073','16891','62878', '49130','19833','24286','27700','40979', '50412','81504','94835','84844','71954', '39503','57649','18434','24987','12350', '86379','27413','44529','98569','16515', '27287','24255','21094','16005','56436', '91110','68293','56455','54558','10298', '83647','32754','27052','51766','19444', '13869','45645','94791','57631','20712', '37788','41807','46507','21727','71836', '81070','50632','88086','63991','20244', '31655','51782','29818','63792','68605', '94898','36430','57025','20601','82080', '33869','22728','35834','29086','92645', '98584','98072','11652','78093','57553', '43830','71144','53565','18700','90209', '71256','38353','54364','28571','96560', '57839','56355','50679','45266','84680', '34306','34972','48530','30106','15371', '92380','84247','92292','68852','13338', '34594','82602','70073','98069','85066', '47289','11686','98862','26217','47529', '63294','51793','35926','24227','14196', '24594','32489','99060','49472','43432', '49211','14312','88137','47369','56877', '20534','81755','15794','12318','21060', '73134','41255','63073','81003','73873', '66057','51184','51195','45676','92696', '70450','90669','98338','25264','38919', '59226','58581','60298','17895','19489', '52301','80846','95464','68770','51634', '19988','18367','18421','11618','67975', '25494','41352','95430','15734','62585', '97173','33773','10425','75675','53535', '17879','41967','12197','67998','79658', '59130','72592','14851','43933','68101', '50636','25717','71286','24660','58058', '72991','95042','15543','33122','69280', '11912','59386','27642','65177','17672', '33467','64592','36335','54010','18767', '63193','42361','49254','33113','33159', '36479','59080','11855','81963','31016', '49140','29392','41836','32958','53163', '13844','73146','23952','65148','93498', '14530','46131','58454','13376','13378', '83986','12320','17193','59852','46081', '98533','52389','13086','68843','31013', '13261','60560','13443','45533','83583', '11489','58218','19753','22911','25115', '86709','27156','32669','13123','51933', '39214','41331','66943','14155','69998', '49101','70070','35076','14242','73021', '59494','15782','29752','37914','74686', '83086','34473','15751','81084','49230', '91894','60624','17819','28810','63180', '56224','39459','55233','75752','43639', '55349','86057','62361','50788','31830', '58062','18218','85761','60083','45484', '21204','90229','70041','41162','35390', '16364','39500','68908','26689','52868', '81335','40146','11340','61527','61794', '71997','30415','59004','29450','58117', '69952','33562','83833','27385','61860', '96435','48333','23065','32961','84919', '61997','99132','22815','56600','68730', '48017','95694','32919','88217','27116', '28239','58032','18884','16791','21343', '97462','18569','75660','15475') intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2918:>                                                   (0 + 114) / 114][Stage 2918:=======================>                            (52 + 62) / 114]                                                                                2023-11-30T19:04:49.393 END took 2508 ms: q8 - iteration 3
2023-11-30T19:04:49.393 ================================================================================
2023-11-30T19:04:49.393 ================================================================================
2023-11-30T19:04:49.393 START: q80 - iteration 3
2023-11-30T19:04:49.393 SQL:  with ssr as (select  s_store_id as store_id, sum(ss_ext_sales_price) as sales, sum(coalesce(sr_return_amt, 0)) as returns, sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit from store_sales left outer join store_returns on (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion where ss_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and ss_store_sk = s_store_sk and ss_item_sk = i_item_sk and i_current_price > 50 and ss_promo_sk = p_promo_sk and p_channel_tv = 'N' group by s_store_id) , csr as (select  cp_catalog_page_id as catalog_page_id, sum(cs_ext_sales_price) as sales, sum(coalesce(cr_return_amount, 0)) as returns, sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit from catalog_sales left outer join catalog_returns on (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion where cs_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and cs_catalog_page_sk = cp_catalog_page_sk and cs_item_sk = i_item_sk and i_current_price > 50 and cs_promo_sk = p_promo_sk and p_channel_tv = 'N' group by cp_catalog_page_id) , wsr as (select  web_site_id, sum(ws_ext_sales_price) as sales, sum(coalesce(wr_return_amt, 0)) as returns, sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit from web_sales left outer join web_returns on (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number), date_dim, web_site, item, promotion where ws_sold_date_sk = d_date_sk and d_date between cast('2001-08-19' as date) and (cast('2001-08-19' as date) +  INTERVAL 60 days) and ws_web_site_sk = web_site_sk and ws_item_sk = i_item_sk and i_current_price > 50 and ws_promo_sk = p_promo_sk and p_channel_tv = 'N' group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || store_id as id , sales , returns , profit from   ssr union all select 'catalog channel' as channel , 'catalog_page' || catalog_page_id as id , sales , returns , profit from  csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2923:(1 + 62) / 63][Stage 2925:(1 + 66) / 67][Stage 2926:(1 + 64) / 65][Stage 2923:(35 + 28) / 63][Stage 2925:(1 + 66) / 67][Stage 2926:(1 + 64) / 65]                                                                                23/11/30 19:04:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:52 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:52 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2929:(0 + 57) / 57][Stage 2930:(1 + 57) / 58][Stage 2931:(0 + 86) / 114][Stage 2929:(39 + 18) / 57][Stage 2930:(1 + 57) / 58][Stage 2931:(0 + 114) / 114][Stage 2930:============> (50 + 8) / 58][Stage 2931:======>     (59 + 55) / 114][Stage 2931:======================================>             (85 + 29) / 114][Stage 2931:=======================================>            (86 + 28) / 114]                                                                                2023-11-30T19:04:55.644 END took 6251 ms: q80 - iteration 3
2023-11-30T19:04:55.644 ================================================================================
2023-11-30T19:04:55.644 ================================================================================
2023-11-30T19:04:55.644 START: q81 - iteration 3
2023-11-30T19:04:55.644 SQL:  with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'MO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return limit 100
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:56 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2939:>             (1 + 64) / 65][Stage 2940:>             (1 + 64) / 65][Stage 2939:======>      (31 + 34) / 65][Stage 2940:=========>   (49 + 16) / 65]                                                                                2023-11-30T19:04:58.739 END took 3094 ms: q81 - iteration 3
2023-11-30T19:04:58.739 ================================================================================
2023-11-30T19:04:58.739 ================================================================================
2023-11-30T19:04:58.739 START: q82 - iteration 3
2023-11-30T19:04:58.739 SQL:  select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, store_sales where i_current_price between 68 and 68+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-08' as date) and (cast('2002-05-08' as date) +  INTERVAL 60 days) and i_manufact_id in (562,370,230,182) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100
23/11/30 19:04:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:04:59 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:04:59 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2947:=>              (1 + 8) / 9][Stage 2948:>           (0 + 114) / 114][Stage 2947:===>            (2 + 7) / 9][Stage 2948:===========>(113 + 1) / 114]                                                                                2023-11-30T19:05:01.071 END took 2331 ms: q82 - iteration 3
2023-11-30T19:05:01.071 ================================================================================
2023-11-30T19:05:01.071 ================================================================================
2023-11-30T19:05:01.071 START: q83 - iteration 3
2023-11-30T19:05:01.071 SQL:  with sr_items as (select i_item_id item_id, sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   sr_returned_date_sk   = d_date_sk group by i_item_id), cr_items as (select i_item_id item_id, sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   cr_returned_date_sk   = d_date_sk group by i_item_id), wr_items as (select i_item_id item_id, sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2000-02-20','2000-10-08','2000-11-04'))) and   wr_returned_date_sk   = d_date_sk group by i_item_id) select  sr_items.item_id ,sr_item_qty ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev ,cr_item_qty ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev ,wr_item_qty ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:02 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2955:(0 + 63) / 63][Stage 2956:(1 + 66) / 67][Stage 2957:(0 + 65) / 65][Stage 2955:(1 + 62) / 63][Stage 2956:(1 + 66) / 67][Stage 2957:(1 + 64) / 65][Stage 2955:(29 + 34) / 63][Stage 2956:(1 + 66) / 67][Stage 2957:(1 + 64) / 65][Stage 2956:=============>(65 + 2) / 67][Stage 2957:=============>(64 + 1) / 65]                                                                                2023-11-30T19:05:04.109 END took 3037 ms: q83 - iteration 3
2023-11-30T19:05:04.109 ================================================================================
2023-11-30T19:05:04.109 ================================================================================
2023-11-30T19:05:04.109 START: q84 - iteration 3
2023-11-30T19:05:04.109 SQL:  select  c_customer_id as customer_id , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city	        =  'Buena Vista' and c_current_addr_sk = ca_address_sk and ib_lower_bound   >=  49786 and ib_upper_bound   <=  49786 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100
23/11/30 19:05:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:04 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:04 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2960:>                                                     (1 + 62) / 63][Stage 2960:==================================>                  (41 + 22) / 63]                                                                                23/11/30 19:05:06 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:06 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
2023-11-30T19:05:06.498 END took 2389 ms: q84 - iteration 3
2023-11-30T19:05:06.498 ================================================================================
2023-11-30T19:05:06.498 ================================================================================
2023-11-30T19:05:06.498 START: q85 - iteration 3
2023-11-30T19:05:06.498 SQL:  select  substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '4 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'M' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = '2 yr Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('IA', 'ND', 'FL') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('OH', 'MS', 'VA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('MN', 'LA', 'TX') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) limit 100
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:07 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2968:>                                                     (0 + 66) / 66][Stage 2968:====>                                                 (5 + 61) / 66]                                                                                23/11/30 19:05:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2971:>             (0 + 57) / 57][Stage 2973:>               (0 + 1) / 1][Stage 2971:>                                                     (0 + 57) / 57][Stage 2971:=====================================================>(56 + 1) / 57]                                                                                2023-11-30T19:05:11.057 END took 4558 ms: q85 - iteration 3
2023-11-30T19:05:11.057 ================================================================================
2023-11-30T19:05:11.057 ================================================================================
2023-11-30T19:05:11.057 START: q86 - iteration 3
2023-11-30T19:05:11.057 SQL:  select sum(ws_net_paid) as total_sum ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ws_net_paid) desc) as rank_within_parent from web_sales ,date_dim       d1 ,item where d1.d_month_seq between 1217 and 1217+11 and d1.d_date_sk = ws_sold_date_sk and i_item_sk  = ws_item_sk group by rollup(i_category,i_class) order by lochierarchy desc, case when lochierarchy = 0 then i_category end, rank_within_parent limit 100
23/11/30 19:05:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:11 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:11 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2978:>                                                     (0 + 57) / 57][Stage 2978:============>                                        (13 + 44) / 57]                                                                                2023-11-30T19:05:13.030 END took 1972 ms: q86 - iteration 3
2023-11-30T19:05:13.030 ================================================================================
2023-11-30T19:05:13.030 ================================================================================
2023-11-30T19:05:13.030 START: q87 - iteration 3
2023-11-30T19:05:13.030 SQL:  select count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1224 and 1224+11) ) cool_cust
23/11/30 19:05:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:13 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:13 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 2983:(0 + 57) / 57][Stage 2984:(1 + 57) / 58][Stage 2986:(0 + 86) / 114][Stage 2983:(14 + 43) / 57][Stage 2984:(46 + 12) / 58][Stage 2986:(19 + 95) / 114][Stage 2986:======================================>             (85 + 29) / 114][Stage 2986:=======================================>            (86 + 28) / 114][Stage 2986:========================================>           (88 + 26) / 114]                                                                                2023-11-30T19:05:16.898 END took 3868 ms: q87 - iteration 3
2023-11-30T19:05:16.898 ================================================================================
2023-11-30T19:05:16.899 ================================================================================
2023-11-30T19:05:16.899 START: q88 - iteration 3
2023-11-30T19:05:16.899 SQL:  select  * from (select count(*) h8_30_to_9 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 8 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s1, (select count(*) h9_to_9_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s2, (select count(*) h9_30_to_10 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s3, (select count(*) h10_to_10_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s4, (select count(*) h10_30_to_11 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s5, (select count(*) h11_to_11_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s6, (select count(*) h11_30_to_12 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s7, (select count(*) h12_to_12_30 from store_sales, household_demographics , time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 12 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2)) and store.s_store_name = 'ese') s8
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:19 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3001:(0 + 114) / 114][Stage 3003:(0 + 86) / 114][Stage 3005:(0 + 0) / 114][Stage 3001:(7 + 107) / 114][Stage 3003:(0 + 93) / 114][Stage 3005:(0 + 0) / 114]                                                                                [Stage 3003:(86 + 28) / 114][Stage 3005:(0 + 114) / 114][Stage 3007:(0 + 58) / 114][Stage 3005:(87 + 27) / 114][Stage 3007:(1 + 113) / 114][Stage 3009:(0 + 59) / 114]                                                                                [Stage 3007:(58 + 56) / 114][Stage 3009:(0 + 114) / 114][Stage 3011:(0 + 30) / 114][Stage 3007:(80 + 34) / 114][Stage 3009:(0 + 114) / 114][Stage 3011:(0 + 52) / 114]                                                                                [Stage 3011:===>        (30 + 84) / 114][Stage 3013:>           (0 + 114) / 114][Stage 3011:===========>(109 + 5) / 114][Stage 3013:>           (9 + 105) / 114]                                                                                [Stage 3015:>                                                   (0 + 114) / 114][Stage 3015:=================================================>  (108 + 6) / 114]                                                                                2023-11-30T19:05:25.643 END took 8744 ms: q88 - iteration 3
2023-11-30T19:05:25.643 ================================================================================
2023-11-30T19:05:25.643 ================================================================================
2023-11-30T19:05:25.643 START: q89 - iteration 3
2023-11-30T19:05:25.643 SQL:  select  * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (2001) and ((i_category in ('Children','Home','Women') and i_class in ('toddlers','flatware','fragrances') ) or (i_category in ('Music','Electronics','Shoes') and i_class in ('country','dvd/vcr players','mens') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100
23/11/30 19:05:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:26 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:26 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3020:>                                                   (0 + 114) / 114][Stage 3020:==============>                                     (31 + 83) / 114]                                                                                2023-11-30T19:05:27.995 END took 2351 ms: q89 - iteration 3
2023-11-30T19:05:27.995 ================================================================================
2023-11-30T19:05:27.995 ================================================================================
2023-11-30T19:05:27.995 START: q9 - iteration 3
2023-11-30T19:05:27.995 SQL:  select case when (select count(*) from store_sales where ss_quantity between 1 and 20) > 4502397049 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from store_sales where ss_quantity between 21 and 40) > 4756228269 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from store_sales where ss_quantity between 41 and 60) > 4101835064 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from store_sales where ss_quantity between 61 and 80) > 4583261513 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from store_sales where ss_quantity between 81 and 100) > 4208819283 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from store_sales where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1
[Stage 3023:(0 + 114) / 114][Stage 3025:(0 + 86) / 114][Stage 3027:(0 + 0) / 114][Stage 3025:(81 + 33) / 114][Stage 3027:(0 + 114) / 114][Stage 3029:(0 + 53) / 114]                                                                                [Stage 3025:(86 + 28) / 114][Stage 3027:(0 + 114) / 114][Stage 3029:(0 + 58) / 114][Stage 3025:(110 + 4) / 114][Stage 3027:(26 + 88) / 114][Stage 3029:(0 + 108) / 114]                                                                                [Stage 3029:(58 + 56) / 114][Stage 3031:(0 + 114) / 114][Stage 3033:(0 + 30) / 114][Stage 3029:(60 + 54) / 114][Stage 3031:(0 + 114) / 114][Stage 3033:(0 + 32) / 114]                                                                                [Stage 3033:(30 + 84) / 114][Stage 3035:(0 + 114) / 114][Stage 3037:(0 + 2) / 114][Stage 3033:(102 + 12) / 114][Stage 3035:(1 + 113) / 114][Stage 3037:(0 + 76) / 114]                                                                                [Stage 3037:(5 + 109) / 114][Stage 3039:(0 + 91) / 114][Stage 3041:(0 + 0) / 114][Stage 3037:(113 + 1) / 114][Stage 3039:(13 + 101) / 114][Stage 3041:(0 + 98) / 114]                                                                                [Stage 3039:(88 + 26) / 114][Stage 3041:(0 + 114) / 114][Stage 3043:(0 + 60) / 114][Stage 3041:(33 + 81) / 114][Stage 3043:(0 + 114) / 114][Stage 3045:(0 + 5) / 114]                                                                                [Stage 3043:(60 + 54) / 114][Stage 3045:(0 + 114) / 114][Stage 3047:(0 + 32) / 114][Stage 3043:(72 + 42) / 114][Stage 3045:(0 + 114) / 114][Stage 3047:(0 + 44) / 114]                                                                                [Stage 3047:(32 + 82) / 114][Stage 3049:(0 + 114) / 114][Stage 3051:(0 + 4) / 114][Stage 3047:(100 + 14) / 114][Stage 3049:(0 + 114) / 114][Stage 3051:(0 + 72) / 114]                                                                                [Stage 3051:=======>                                            (16 + 98) / 114][Stage 3051:=================================================>  (109 + 5) / 114]                                                                                2023-11-30T19:05:40.142 END took 12146 ms: q9 - iteration 3
2023-11-30T19:05:40.142 ================================================================================
2023-11-30T19:05:40.142 ================================================================================
2023-11-30T19:05:40.142 START: q90 - iteration 3
2023-11-30T19:05:40.142 SQL:  select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 7 and 7+1 and household_demographics.hd_dep_count = 1 and web_page.wp_char_count between 5000 and 5200) at, ( select count(*) pmc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 20 and 20+1 and household_demographics.hd_dep_count = 1 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio limit 100
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:40 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3058:>                                                     (0 + 57) / 57][Stage 3058:=====================================================>(56 + 1) / 57]                                                                                [Stage 3060:>                                                     (0 + 57) / 57][Stage 3060:====================================>                (39 + 18) / 57]                                                                                2023-11-30T19:05:43.565 END took 3423 ms: q90 - iteration 3
2023-11-30T19:05:43.565 ================================================================================
2023-11-30T19:05:43.566 ================================================================================
2023-11-30T19:05:43.566 START: q91 - iteration 3
2023-11-30T19:05:43.566 SQL:  select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics where cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1998 and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown') or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like 'Unknown%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:44 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3068:>                                                     (1 + 64) / 65][Stage 3068:=========================================>           (51 + 14) / 65]                                                                                2023-11-30T19:05:46.856 END took 3290 ms: q91 - iteration 3
2023-11-30T19:05:46.856 ================================================================================
2023-11-30T19:05:46.856 ================================================================================
2023-11-30T19:05:46.856 START: q92 - iteration 3
2023-11-30T19:05:46.856 SQL:  select sum(ws_ext_discount_amt)  as `Excess Discount Amount` from web_sales ,item ,date_dim where i_manufact_id = 172 and i_item_sk = ws_item_sk and d_date between '1999-01-12' and (cast('1999-01-12' as date) + INTERVAL 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales ,date_dim WHERE ws_item_sk = i_item_sk and d_date between '1999-01-12' and (cast('1999-01-12' as date) + INTERVAL 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) limit 100
23/11/30 19:05:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:47 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:47 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3078:>             (0 + 57) / 57][Stage 3079:>             (0 + 57) / 57][Stage 3078:=======>     (32 + 25) / 57][Stage 3079:=>            (5 + 52) / 57][Stage 3078:=============>(54 + 3) / 57][Stage 3079:============> (51 + 6) / 57]                                                                                2023-11-30T19:05:49.377 END took 2520 ms: q92 - iteration 3
2023-11-30T19:05:49.377 ================================================================================
2023-11-30T19:05:49.377 ================================================================================
2023-11-30T19:05:49.377 START: q93 - iteration 3
2023-11-30T19:05:49.377 SQL:  select  ss_customer_sk ,sum(act_sales) sumsales from (select ss_item_sk ,ss_ticket_number ,ss_customer_sk ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number) ,reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 58') t group by ss_customer_sk order by sumsales, ss_customer_sk limit 100
23/11/30 19:05:49 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:49 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3083:>                                                     (1 + 62) / 63][Stage 3083:=================>                                   (21 + 42) / 63]                                                                                23/11/30 19:05:51 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:51 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3084:>                                                   (0 + 114) / 114][Stage 3084:===============>                                    (33 + 81) / 114]                                                                                2023-11-30T19:05:52.904 END took 3527 ms: q93 - iteration 3
2023-11-30T19:05:52.904 ================================================================================
2023-11-30T19:05:52.904 ================================================================================
2023-11-30T19:05:52.904 START: q94 - iteration 3
2023-11-30T19:05:52.904 SQL:  select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between '2002-3-01' and (cast('2002-3-01' as date) + INTERVAL 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'GA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select * from web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select * from web_returns wr1 where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100
23/11/30 19:05:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:53 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:53 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3088:>                                                     (1 + 66) / 67][Stage 3088:================>                                    (21 + 46) / 67]                                                                                23/11/30 19:05:54 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:54 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3090:>             (0 + 57) / 57][Stage 3091:>             (0 + 57) / 57][Stage 3090:============> (51 + 6) / 57][Stage 3091:=============>(54 + 3) / 57]                                                                                2023-11-30T19:05:56.965 END took 4061 ms: q94 - iteration 3
2023-11-30T19:05:56.965 ================================================================================
2023-11-30T19:05:56.965 ================================================================================
2023-11-30T19:05:56.965 START: q95 - iteration 3
2023-11-30T19:05:56.965 SQL:  with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2 from web_sales ws1,web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between '2001-3-01' and (cast('2001-3-01' as date) + INTERVAL 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'NE' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number from ws_wh) and ws1.ws_order_number in (select wr_order_number from web_returns,ws_wh where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100
23/11/30 19:05:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:57 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:57 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3094:>             (1 + 66) / 67][Stage 3095:>             (0 + 57) / 57][Stage 3094:=======>     (41 + 26) / 67][Stage 3095:======>      (30 + 27) / 57]                                                                                23/11/30 19:05:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:05:58 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:05:58 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3099:(0 + 57) / 57][Stage 3100:(0 + 57) / 57][Stage 3101:(0 + 57) / 57][Stage 3099:(50 + 7) / 57][Stage 3100:(54 + 3) / 57][Stage 3101:(37 + 20) / 57]                                                                                2023-11-30T19:06:00.930 END took 3964 ms: q95 - iteration 3
2023-11-30T19:06:00.930 ================================================================================
2023-11-30T19:06:00.930 ================================================================================
2023-11-30T19:06:00.930 START: q96 - iteration 3
2023-11-30T19:06:00.930 SQL:  select  count(*) from store_sales ,household_demographics ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 16 and time_dim.t_minute >= 30 and household_demographics.hd_dep_count = 0 and store.s_store_name = 'ese' order by count(*) limit 100
23/11/30 19:06:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:06:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:06:01 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:01 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3107:>                                                   (0 + 114) / 114][Stage 3107:===============>                                    (34 + 80) / 114][Stage 3107:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:06:02.862 END took 1931 ms: q96 - iteration 3
2023-11-30T19:06:02.862 ================================================================================
2023-11-30T19:06:02.862 ================================================================================
2023-11-30T19:06:02.862 START: q97 - iteration 3
2023-11-30T19:06:02.862 SQL:  with ssci as ( select ss_customer_sk customer_sk ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219 + 11 group by ss_customer_sk ,ss_item_sk), csci as( select cs_bill_customer_sk customer_sk ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219 + 11 group by cs_bill_customer_sk ,cs_item_sk) select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk and ssci.item_sk = csci.item_sk) limit 100
23/11/30 19:06:03 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:03 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3110:>             (1 + 57) / 58][Stage 3111:>           (0 + 114) / 114][Stage 3110:=>            (5 + 53) / 58][Stage 3111:>           (0 + 114) / 114]                                                                                2023-11-30T19:06:05.058 END took 2196 ms: q97 - iteration 3
2023-11-30T19:06:05.058 ================================================================================
2023-11-30T19:06:05.058 ================================================================================
2023-11-30T19:06:05.058 START: q98 - iteration 3
2023-11-30T19:06:05.058 SQL:  select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ss_ext_sales_price) as itemrevenue ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over (partition by i_class) as revenueratio from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and i_category in ('Books', 'Children', 'Sports') and ss_sold_date_sk = d_date_sk and d_date between cast('2001-03-10' as date) and (cast('2001-03-10' as date) + interval 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio
23/11/30 19:06:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:06:05 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:05 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3116:>                                                   (0 + 114) / 114][Stage 3116:==>                                                 (5 + 109) / 114][Stage 3116:===================================================>(113 + 1) / 114]                                                                                2023-11-30T19:06:07.552 END took 2493 ms: q98 - iteration 3
2023-11-30T19:06:07.552 ================================================================================
2023-11-30T19:06:07.552 ================================================================================
2023-11-30T19:06:07.552 START: q99 - iteration 3
2023-11-30T19:06:07.552 SQL:  select substr(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as `>120 days` from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1205 and 1205 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20) ,sm_type ,cc_name order by substr(w_warehouse_name,1,20) ,sm_type ,cc_name limit 100
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.executor.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.executor.memoryOverhead' instead.
23/11/30 19:06:08 WARN SparkConf: The configuration key 'spark.yarn.driver.memoryOverhead' has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key 'spark.driver.memoryOverhead' instead.
[Stage 3127:>                                                     (1 + 57) / 58][Stage 3127:================================>                    (36 + 22) / 58]                                                                                2023-11-30T19:06:09.937 END took 2384 ms: q99 - iteration 3
2023-11-30T19:06:09.937 ================================================================================
2023-11-30T19:06:09.944 ================================================================================
RESULT:
{
  "benchmarkSpecs" : {
    "benchmarkId" : "20231130-184001-tpcds-1gb-iceberg",
    "benchmarkPath" : "gs://fksdp-mhora-zrwe-0f09-discoverycontentimpression/benchmarking/iceberg-benchmarking",
    "format" : "ICEBERG",
    "iterations" : "3",
    "scaleInGB" : "1"
  },
  "extraMetrics" : {
    "tpcds-result-seconds" : 427.68100000000004
  },
  "queryResults" : [ {
    "durationMs" : 43682,
    "iteration" : 1,
    "name" : "q1"
  }, {
    "durationMs" : 14795,
    "iteration" : 1,
    "name" : "q10"
  }, {
    "durationMs" : 11649,
    "iteration" : 1,
    "name" : "q11"
  }, {
    "durationMs" : 3424,
    "iteration" : 1,
    "name" : "q12"
  }, {
    "durationMs" : 7032,
    "iteration" : 1,
    "name" : "q13"
  }, {
    "durationMs" : 23094,
    "iteration" : 1,
    "name" : "q14a"
  }, {
    "durationMs" : 17734,
    "iteration" : 1,
    "name" : "q14b"
  }, {
    "durationMs" : 4951,
    "iteration" : 1,
    "name" : "q15"
  }, {
    "durationMs" : 5545,
    "iteration" : 1,
    "name" : "q16"
  }, {
    "durationMs" : 6662,
    "iteration" : 1,
    "name" : "q17"
  }, {
    "durationMs" : 4471,
    "iteration" : 1,
    "name" : "q18"
  }, {
    "durationMs" : 2537,
    "iteration" : 1,
    "name" : "q19"
  }, {
    "durationMs" : 3467,
    "iteration" : 1,
    "name" : "q2"
  }, {
    "durationMs" : 2299,
    "iteration" : 1,
    "name" : "q20"
  }, {
    "durationMs" : 3275,
    "iteration" : 1,
    "name" : "q21"
  }, {
    "durationMs" : 2834,
    "iteration" : 1,
    "name" : "q22"
  }, {
    "durationMs" : 10915,
    "iteration" : 1,
    "name" : "q23a"
  }, {
    "durationMs" : 12570,
    "iteration" : 1,
    "name" : "q23b"
  }, {
    "durationMs" : 7446,
    "iteration" : 1,
    "name" : "q24a"
  }, {
    "durationMs" : 6669,
    "iteration" : 1,
    "name" : "q24b"
  }, {
    "durationMs" : 6035,
    "iteration" : 1,
    "name" : "q25"
  }, {
    "durationMs" : 3394,
    "iteration" : 1,
    "name" : "q26"
  }, {
    "durationMs" : 2946,
    "iteration" : 1,
    "name" : "q27"
  }, {
    "durationMs" : 12684,
    "iteration" : 1,
    "name" : "q28"
  }, {
    "durationMs" : 10558,
    "iteration" : 1,
    "name" : "q29"
  }, {
    "durationMs" : 4153,
    "iteration" : 1,
    "name" : "q3"
  }, {
    "durationMs" : 4213,
    "iteration" : 1,
    "name" : "q30"
  }, {
    "durationMs" : 9292,
    "iteration" : 1,
    "name" : "q31"
  }, {
    "durationMs" : 4603,
    "iteration" : 1,
    "name" : "q32"
  }, {
    "durationMs" : 7480,
    "iteration" : 1,
    "name" : "q33"
  }, {
    "durationMs" : 4864,
    "iteration" : 1,
    "name" : "q34"
  }, {
    "durationMs" : 6108,
    "iteration" : 1,
    "name" : "q35"
  }, {
    "durationMs" : 2456,
    "iteration" : 1,
    "name" : "q36"
  }, {
    "durationMs" : 2798,
    "iteration" : 1,
    "name" : "q37"
  }, {
    "durationMs" : 4676,
    "iteration" : 1,
    "name" : "q38"
  }, {
    "durationMs" : 3769,
    "iteration" : 1,
    "name" : "q39a"
  }, {
    "durationMs" : 3085,
    "iteration" : 1,
    "name" : "q39b"
  }, {
    "durationMs" : 11876,
    "iteration" : 1,
    "name" : "q4"
  }, {
    "durationMs" : 9270,
    "iteration" : 1,
    "name" : "q40"
  }, {
    "durationMs" : 553,
    "iteration" : 1,
    "name" : "q41"
  }, {
    "durationMs" : 5733,
    "iteration" : 1,
    "name" : "q42"
  }, {
    "durationMs" : 2512,
    "iteration" : 1,
    "name" : "q43"
  }, {
    "durationMs" : 1631,
    "iteration" : 1,
    "name" : "q44"
  }, {
    "durationMs" : 4982,
    "iteration" : 1,
    "name" : "q45"
  }, {
    "durationMs" : 2723,
    "iteration" : 1,
    "name" : "q46"
  }, {
    "durationMs" : 4759,
    "iteration" : 1,
    "name" : "q47"
  }, {
    "durationMs" : 2758,
    "iteration" : 1,
    "name" : "q48"
  }, {
    "durationMs" : 6573,
    "iteration" : 1,
    "name" : "q49"
  }, {
    "durationMs" : 8253,
    "iteration" : 1,
    "name" : "q5"
  }, {
    "durationMs" : 8351,
    "iteration" : 1,
    "name" : "q50"
  }, {
    "durationMs" : 6976,
    "iteration" : 1,
    "name" : "q51"
  }, {
    "durationMs" : 4016,
    "iteration" : 1,
    "name" : "q52"
  }, {
    "durationMs" : 3206,
    "iteration" : 1,
    "name" : "q53"
  }, {
    "durationMs" : 4707,
    "iteration" : 1,
    "name" : "q54"
  }, {
    "durationMs" : 2099,
    "iteration" : 1,
    "name" : "q55"
  }, {
    "durationMs" : 4719,
    "iteration" : 1,
    "name" : "q56"
  }, {
    "durationMs" : 7836,
    "iteration" : 1,
    "name" : "q57"
  }, {
    "durationMs" : 4461,
    "iteration" : 1,
    "name" : "q58"
  }, {
    "durationMs" : 2824,
    "iteration" : 1,
    "name" : "q59"
  }, {
    "durationMs" : 3417,
    "iteration" : 1,
    "name" : "q6"
  }, {
    "durationMs" : 4158,
    "iteration" : 1,
    "name" : "q60"
  }, {
    "durationMs" : 3907,
    "iteration" : 1,
    "name" : "q61"
  }, {
    "durationMs" : 2682,
    "iteration" : 1,
    "name" : "q62"
  }, {
    "durationMs" : 2315,
    "iteration" : 1,
    "name" : "q63"
  }, {
    "durationMs" : 12279,
    "iteration" : 1,
    "name" : "q64"
  }, {
    "durationMs" : 6956,
    "iteration" : 1,
    "name" : "q65"
  }, {
    "durationMs" : 6007,
    "iteration" : 1,
    "name" : "q66"
  }, {
    "durationMs" : 3143,
    "iteration" : 1,
    "name" : "q67"
  }, {
    "durationMs" : 2403,
    "iteration" : 1,
    "name" : "q68"
  }, {
    "durationMs" : 4687,
    "iteration" : 1,
    "name" : "q69"
  }, {
    "durationMs" : 2941,
    "iteration" : 1,
    "name" : "q7"
  }, {
    "durationMs" : 4348,
    "iteration" : 1,
    "name" : "q70"
  }, {
    "durationMs" : 3836,
    "iteration" : 1,
    "name" : "q71"
  }, {
    "durationMs" : 9916,
    "iteration" : 1,
    "name" : "q72"
  }, {
    "durationMs" : 2661,
    "iteration" : 1,
    "name" : "q73"
  }, {
    "durationMs" : 7254,
    "iteration" : 1,
    "name" : "q74"
  }, {
    "durationMs" : 13523,
    "iteration" : 1,
    "name" : "q75"
  }, {
    "durationMs" : 6056,
    "iteration" : 1,
    "name" : "q76"
  }, {
    "durationMs" : 24484,
    "iteration" : 1,
    "name" : "q77"
  }, {
    "durationMs" : 10369,
    "iteration" : 1,
    "name" : "q78"
  }, {
    "durationMs" : 3185,
    "iteration" : 1,
    "name" : "q79"
  }, {
    "durationMs" : 2977,
    "iteration" : 1,
    "name" : "q8"
  }, {
    "durationMs" : 7472,
    "iteration" : 1,
    "name" : "q80"
  }, {
    "durationMs" : 3750,
    "iteration" : 1,
    "name" : "q81"
  }, {
    "durationMs" : 2841,
    "iteration" : 1,
    "name" : "q82"
  }, {
    "durationMs" : 3457,
    "iteration" : 1,
    "name" : "q83"
  }, {
    "durationMs" : 2541,
    "iteration" : 1,
    "name" : "q84"
  }, {
    "durationMs" : 4731,
    "iteration" : 1,
    "name" : "q85"
  }, {
    "durationMs" : 2299,
    "iteration" : 1,
    "name" : "q86"
  }, {
    "durationMs" : 4199,
    "iteration" : 1,
    "name" : "q87"
  }, {
    "durationMs" : 9025,
    "iteration" : 1,
    "name" : "q88"
  }, {
    "durationMs" : 2447,
    "iteration" : 1,
    "name" : "q89"
  }, {
    "durationMs" : 12148,
    "iteration" : 1,
    "name" : "q9"
  }, {
    "durationMs" : 3521,
    "iteration" : 1,
    "name" : "q90"
  }, {
    "durationMs" : 3423,
    "iteration" : 1,
    "name" : "q91"
  }, {
    "durationMs" : 2382,
    "iteration" : 1,
    "name" : "q92"
  }, {
    "durationMs" : 3915,
    "iteration" : 1,
    "name" : "q93"
  }, {
    "durationMs" : 4219,
    "iteration" : 1,
    "name" : "q94"
  }, {
    "durationMs" : 4645,
    "iteration" : 1,
    "name" : "q95"
  }, {
    "durationMs" : 2010,
    "iteration" : 1,
    "name" : "q96"
  }, {
    "durationMs" : 2543,
    "iteration" : 1,
    "name" : "q97"
  }, {
    "durationMs" : 2494,
    "iteration" : 1,
    "name" : "q98"
  }, {
    "durationMs" : 2393,
    "iteration" : 1,
    "name" : "q99"
  }, {
    "durationMs" : 2498,
    "iteration" : 2,
    "name" : "q1"
  }, {
    "durationMs" : 4798,
    "iteration" : 2,
    "name" : "q10"
  }, {
    "durationMs" : 7163,
    "iteration" : 2,
    "name" : "q11"
  }, {
    "durationMs" : 1954,
    "iteration" : 2,
    "name" : "q12"
  }, {
    "durationMs" : 3193,
    "iteration" : 2,
    "name" : "q13"
  }, {
    "durationMs" : 12959,
    "iteration" : 2,
    "name" : "q14a"
  }, {
    "durationMs" : 10143,
    "iteration" : 2,
    "name" : "q14b"
  }, {
    "durationMs" : 2058,
    "iteration" : 2,
    "name" : "q15"
  }, {
    "durationMs" : 4353,
    "iteration" : 2,
    "name" : "q16"
  }, {
    "durationMs" : 4607,
    "iteration" : 2,
    "name" : "q17"
  }, {
    "durationMs" : 4028,
    "iteration" : 2,
    "name" : "q18"
  }, {
    "durationMs" : 2131,
    "iteration" : 2,
    "name" : "q19"
  }, {
    "durationMs" : 2927,
    "iteration" : 2,
    "name" : "q2"
  }, {
    "durationMs" : 2074,
    "iteration" : 2,
    "name" : "q20"
  }, {
    "durationMs" : 2506,
    "iteration" : 2,
    "name" : "q21"
  }, {
    "durationMs" : 2621,
    "iteration" : 2,
    "name" : "q22"
  }, {
    "durationMs" : 6562,
    "iteration" : 2,
    "name" : "q23a"
  }, {
    "durationMs" : 8942,
    "iteration" : 2,
    "name" : "q23b"
  }, {
    "durationMs" : 6289,
    "iteration" : 2,
    "name" : "q24a"
  }, {
    "durationMs" : 5875,
    "iteration" : 2,
    "name" : "q24b"
  }, {
    "durationMs" : 4396,
    "iteration" : 2,
    "name" : "q25"
  }, {
    "durationMs" : 2826,
    "iteration" : 2,
    "name" : "q26"
  }, {
    "durationMs" : 2427,
    "iteration" : 2,
    "name" : "q27"
  }, {
    "durationMs" : 7182,
    "iteration" : 2,
    "name" : "q28"
  }, {
    "durationMs" : 4148,
    "iteration" : 2,
    "name" : "q29"
  }, {
    "durationMs" : 1947,
    "iteration" : 2,
    "name" : "q3"
  }, {
    "durationMs" : 3398,
    "iteration" : 2,
    "name" : "q30"
  }, {
    "durationMs" : 6495,
    "iteration" : 2,
    "name" : "q31"
  }, {
    "durationMs" : 2119,
    "iteration" : 2,
    "name" : "q32"
  }, {
    "durationMs" : 4076,
    "iteration" : 2,
    "name" : "q33"
  }, {
    "durationMs" : 2573,
    "iteration" : 2,
    "name" : "q34"
  }, {
    "durationMs" : 4822,
    "iteration" : 2,
    "name" : "q35"
  }, {
    "durationMs" : 2237,
    "iteration" : 2,
    "name" : "q36"
  }, {
    "durationMs" : 2278,
    "iteration" : 2,
    "name" : "q37"
  }, {
    "durationMs" : 4139,
    "iteration" : 2,
    "name" : "q38"
  }, {
    "durationMs" : 3498,
    "iteration" : 2,
    "name" : "q39a"
  }, {
    "durationMs" : 2835,
    "iteration" : 2,
    "name" : "q39b"
  }, {
    "durationMs" : 9004,
    "iteration" : 2,
    "name" : "q4"
  }, {
    "durationMs" : 3681,
    "iteration" : 2,
    "name" : "q40"
  }, {
    "durationMs" : 388,
    "iteration" : 2,
    "name" : "q41"
  }, {
    "durationMs" : 1940,
    "iteration" : 2,
    "name" : "q42"
  }, {
    "durationMs" : 2061,
    "iteration" : 2,
    "name" : "q43"
  }, {
    "durationMs" : 1614,
    "iteration" : 2,
    "name" : "q44"
  }, {
    "durationMs" : 2228,
    "iteration" : 2,
    "name" : "q45"
  }, {
    "durationMs" : 2440,
    "iteration" : 2,
    "name" : "q46"
  }, {
    "durationMs" : 3883,
    "iteration" : 2,
    "name" : "q47"
  }, {
    "durationMs" : 2465,
    "iteration" : 2,
    "name" : "q48"
  }, {
    "durationMs" : 5648,
    "iteration" : 2,
    "name" : "q49"
  }, {
    "durationMs" : 6926,
    "iteration" : 2,
    "name" : "q5"
  }, {
    "durationMs" : 3800,
    "iteration" : 2,
    "name" : "q50"
  }, {
    "durationMs" : 3072,
    "iteration" : 2,
    "name" : "q51"
  }, {
    "durationMs" : 1804,
    "iteration" : 2,
    "name" : "q52"
  }, {
    "durationMs" : 2165,
    "iteration" : 2,
    "name" : "q53"
  }, {
    "durationMs" : 4103,
    "iteration" : 2,
    "name" : "q54"
  }, {
    "durationMs" : 1896,
    "iteration" : 2,
    "name" : "q55"
  }, {
    "durationMs" : 4181,
    "iteration" : 2,
    "name" : "q56"
  }, {
    "durationMs" : 3799,
    "iteration" : 2,
    "name" : "q57"
  }, {
    "durationMs" : 3969,
    "iteration" : 2,
    "name" : "q58"
  }, {
    "durationMs" : 2883,
    "iteration" : 2,
    "name" : "q59"
  }, {
    "durationMs" : 3313,
    "iteration" : 2,
    "name" : "q6"
  }, {
    "durationMs" : 3920,
    "iteration" : 2,
    "name" : "q60"
  }, {
    "durationMs" : 3734,
    "iteration" : 2,
    "name" : "q61"
  }, {
    "durationMs" : 2311,
    "iteration" : 2,
    "name" : "q62"
  }, {
    "durationMs" : 2127,
    "iteration" : 2,
    "name" : "q63"
  }, {
    "durationMs" : 10178,
    "iteration" : 2,
    "name" : "q64"
  }, {
    "durationMs" : 3431,
    "iteration" : 2,
    "name" : "q65"
  }, {
    "durationMs" : 3399,
    "iteration" : 2,
    "name" : "q66"
  }, {
    "durationMs" : 3035,
    "iteration" : 2,
    "name" : "q67"
  }, {
    "durationMs" : 2456,
    "iteration" : 2,
    "name" : "q68"
  }, {
    "durationMs" : 4481,
    "iteration" : 2,
    "name" : "q69"
  }, {
    "durationMs" : 2528,
    "iteration" : 2,
    "name" : "q7"
  }, {
    "durationMs" : 4197,
    "iteration" : 2,
    "name" : "q70"
  }, {
    "durationMs" : 3563,
    "iteration" : 2,
    "name" : "q71"
  }, {
    "durationMs" : 7299,
    "iteration" : 2,
    "name" : "q72"
  }, {
    "durationMs" : 2577,
    "iteration" : 2,
    "name" : "q73"
  }, {
    "durationMs" : 4652,
    "iteration" : 2,
    "name" : "q74"
  }, {
    "durationMs" : 8740,
    "iteration" : 2,
    "name" : "q75"
  }, {
    "durationMs" : 2403,
    "iteration" : 2,
    "name" : "q76"
  }, {
    "durationMs" : 19773,
    "iteration" : 2,
    "name" : "q77"
  }, {
    "durationMs" : 5528,
    "iteration" : 2,
    "name" : "q78"
  }, {
    "durationMs" : 2394,
    "iteration" : 2,
    "name" : "q79"
  }, {
    "durationMs" : 2566,
    "iteration" : 2,
    "name" : "q8"
  }, {
    "durationMs" : 6461,
    "iteration" : 2,
    "name" : "q80"
  }, {
    "durationMs" : 3238,
    "iteration" : 2,
    "name" : "q81"
  }, {
    "durationMs" : 2524,
    "iteration" : 2,
    "name" : "q82"
  }, {
    "durationMs" : 3249,
    "iteration" : 2,
    "name" : "q83"
  }, {
    "durationMs" : 2302,
    "iteration" : 2,
    "name" : "q84"
  }, {
    "durationMs" : 4813,
    "iteration" : 2,
    "name" : "q85"
  }, {
    "durationMs" : 2005,
    "iteration" : 2,
    "name" : "q86"
  }, {
    "durationMs" : 4218,
    "iteration" : 2,
    "name" : "q87"
  }, {
    "durationMs" : 8714,
    "iteration" : 2,
    "name" : "q88"
  }, {
    "durationMs" : 2266,
    "iteration" : 2,
    "name" : "q89"
  }, {
    "durationMs" : 12233,
    "iteration" : 2,
    "name" : "q9"
  }, {
    "durationMs" : 3577,
    "iteration" : 2,
    "name" : "q90"
  }, {
    "durationMs" : 3507,
    "iteration" : 2,
    "name" : "q91"
  }, {
    "durationMs" : 2072,
    "iteration" : 2,
    "name" : "q92"
  }, {
    "durationMs" : 3710,
    "iteration" : 2,
    "name" : "q93"
  }, {
    "durationMs" : 3940,
    "iteration" : 2,
    "name" : "q94"
  }, {
    "durationMs" : 4194,
    "iteration" : 2,
    "name" : "q95"
  }, {
    "durationMs" : 1826,
    "iteration" : 2,
    "name" : "q96"
  }, {
    "durationMs" : 2284,
    "iteration" : 2,
    "name" : "q97"
  }, {
    "durationMs" : 2253,
    "iteration" : 2,
    "name" : "q98"
  }, {
    "durationMs" : 2248,
    "iteration" : 2,
    "name" : "q99"
  }, {
    "durationMs" : 2222,
    "iteration" : 3,
    "name" : "q1"
  }, {
    "durationMs" : 4296,
    "iteration" : 3,
    "name" : "q10"
  }, {
    "durationMs" : 6068,
    "iteration" : 3,
    "name" : "q11"
  }, {
    "durationMs" : 1985,
    "iteration" : 3,
    "name" : "q12"
  }, {
    "durationMs" : 2143,
    "iteration" : 3,
    "name" : "q13"
  }, {
    "durationMs" : 12408,
    "iteration" : 3,
    "name" : "q14a"
  }, {
    "durationMs" : 9715,
    "iteration" : 3,
    "name" : "q14b"
  }, {
    "durationMs" : 1977,
    "iteration" : 3,
    "name" : "q15"
  }, {
    "durationMs" : 4020,
    "iteration" : 3,
    "name" : "q16"
  }, {
    "durationMs" : 4636,
    "iteration" : 3,
    "name" : "q17"
  }, {
    "durationMs" : 3797,
    "iteration" : 3,
    "name" : "q18"
  }, {
    "durationMs" : 2232,
    "iteration" : 3,
    "name" : "q19"
  }, {
    "durationMs" : 2748,
    "iteration" : 3,
    "name" : "q2"
  }, {
    "durationMs" : 2082,
    "iteration" : 3,
    "name" : "q20"
  }, {
    "durationMs" : 2464,
    "iteration" : 3,
    "name" : "q21"
  }, {
    "durationMs" : 2534,
    "iteration" : 3,
    "name" : "q22"
  }, {
    "durationMs" : 6567,
    "iteration" : 3,
    "name" : "q23a"
  }, {
    "durationMs" : 8818,
    "iteration" : 3,
    "name" : "q23b"
  }, {
    "durationMs" : 6428,
    "iteration" : 3,
    "name" : "q24a"
  }, {
    "durationMs" : 6054,
    "iteration" : 3,
    "name" : "q24b"
  }, {
    "durationMs" : 4364,
    "iteration" : 3,
    "name" : "q25"
  }, {
    "durationMs" : 2813,
    "iteration" : 3,
    "name" : "q26"
  }, {
    "durationMs" : 2600,
    "iteration" : 3,
    "name" : "q27"
  }, {
    "durationMs" : 6756,
    "iteration" : 3,
    "name" : "q28"
  }, {
    "durationMs" : 4028,
    "iteration" : 3,
    "name" : "q29"
  }, {
    "durationMs" : 1944,
    "iteration" : 3,
    "name" : "q3"
  }, {
    "durationMs" : 3197,
    "iteration" : 3,
    "name" : "q30"
  }, {
    "durationMs" : 6731,
    "iteration" : 3,
    "name" : "q31"
  }, {
    "durationMs" : 2163,
    "iteration" : 3,
    "name" : "q32"
  }, {
    "durationMs" : 4065,
    "iteration" : 3,
    "name" : "q33"
  }, {
    "durationMs" : 2671,
    "iteration" : 3,
    "name" : "q34"
  }, {
    "durationMs" : 5129,
    "iteration" : 3,
    "name" : "q35"
  }, {
    "durationMs" : 2196,
    "iteration" : 3,
    "name" : "q36"
  }, {
    "durationMs" : 2144,
    "iteration" : 3,
    "name" : "q37"
  }, {
    "durationMs" : 3968,
    "iteration" : 3,
    "name" : "q38"
  }, {
    "durationMs" : 3425,
    "iteration" : 3,
    "name" : "q39a"
  }, {
    "durationMs" : 2934,
    "iteration" : 3,
    "name" : "q39b"
  }, {
    "durationMs" : 8754,
    "iteration" : 3,
    "name" : "q4"
  }, {
    "durationMs" : 3554,
    "iteration" : 3,
    "name" : "q40"
  }, {
    "durationMs" : 519,
    "iteration" : 3,
    "name" : "q41"
  }, {
    "durationMs" : 1771,
    "iteration" : 3,
    "name" : "q42"
  }, {
    "durationMs" : 1969,
    "iteration" : 3,
    "name" : "q43"
  }, {
    "durationMs" : 1694,
    "iteration" : 3,
    "name" : "q44"
  }, {
    "durationMs" : 2143,
    "iteration" : 3,
    "name" : "q45"
  }, {
    "durationMs" : 2386,
    "iteration" : 3,
    "name" : "q46"
  }, {
    "durationMs" : 3847,
    "iteration" : 3,
    "name" : "q47"
  }, {
    "durationMs" : 2387,
    "iteration" : 3,
    "name" : "q48"
  }, {
    "durationMs" : 5557,
    "iteration" : 3,
    "name" : "q49"
  }, {
    "durationMs" : 6504,
    "iteration" : 3,
    "name" : "q5"
  }, {
    "durationMs" : 3660,
    "iteration" : 3,
    "name" : "q50"
  }, {
    "durationMs" : 3038,
    "iteration" : 3,
    "name" : "q51"
  }, {
    "durationMs" : 1801,
    "iteration" : 3,
    "name" : "q52"
  }, {
    "durationMs" : 2226,
    "iteration" : 3,
    "name" : "q53"
  }, {
    "durationMs" : 3929,
    "iteration" : 3,
    "name" : "q54"
  }, {
    "durationMs" : 1856,
    "iteration" : 3,
    "name" : "q55"
  }, {
    "durationMs" : 4107,
    "iteration" : 3,
    "name" : "q56"
  }, {
    "durationMs" : 3967,
    "iteration" : 3,
    "name" : "q57"
  }, {
    "durationMs" : 4191,
    "iteration" : 3,
    "name" : "q58"
  }, {
    "durationMs" : 2919,
    "iteration" : 3,
    "name" : "q59"
  }, {
    "durationMs" : 3359,
    "iteration" : 3,
    "name" : "q6"
  }, {
    "durationMs" : 3993,
    "iteration" : 3,
    "name" : "q60"
  }, {
    "durationMs" : 3593,
    "iteration" : 3,
    "name" : "q61"
  }, {
    "durationMs" : 2628,
    "iteration" : 3,
    "name" : "q62"
  }, {
    "durationMs" : 2191,
    "iteration" : 3,
    "name" : "q63"
  }, {
    "durationMs" : 10740,
    "iteration" : 3,
    "name" : "q64"
  }, {
    "durationMs" : 3391,
    "iteration" : 3,
    "name" : "q65"
  }, {
    "durationMs" : 3296,
    "iteration" : 3,
    "name" : "q66"
  }, {
    "durationMs" : 2998,
    "iteration" : 3,
    "name" : "q67"
  }, {
    "durationMs" : 2337,
    "iteration" : 3,
    "name" : "q68"
  }, {
    "durationMs" : 4582,
    "iteration" : 3,
    "name" : "q69"
  }, {
    "durationMs" : 2724,
    "iteration" : 3,
    "name" : "q7"
  }, {
    "durationMs" : 4254,
    "iteration" : 3,
    "name" : "q70"
  }, {
    "durationMs" : 3639,
    "iteration" : 3,
    "name" : "q71"
  }, {
    "durationMs" : 7098,
    "iteration" : 3,
    "name" : "q72"
  }, {
    "durationMs" : 2567,
    "iteration" : 3,
    "name" : "q73"
  }, {
    "durationMs" : 4410,
    "iteration" : 3,
    "name" : "q74"
  }, {
    "durationMs" : 8104,
    "iteration" : 3,
    "name" : "q75"
  }, {
    "durationMs" : 2442,
    "iteration" : 3,
    "name" : "q76"
  }, {
    "durationMs" : 19093,
    "iteration" : 3,
    "name" : "q77"
  }, {
    "durationMs" : 5585,
    "iteration" : 3,
    "name" : "q78"
  }, {
    "durationMs" : 2438,
    "iteration" : 3,
    "name" : "q79"
  }, {
    "durationMs" : 2508,
    "iteration" : 3,
    "name" : "q8"
  }, {
    "durationMs" : 6251,
    "iteration" : 3,
    "name" : "q80"
  }, {
    "durationMs" : 3094,
    "iteration" : 3,
    "name" : "q81"
  }, {
    "durationMs" : 2331,
    "iteration" : 3,
    "name" : "q82"
  }, {
    "durationMs" : 3037,
    "iteration" : 3,
    "name" : "q83"
  }, {
    "durationMs" : 2389,
    "iteration" : 3,
    "name" : "q84"
  }, {
    "durationMs" : 4558,
    "iteration" : 3,
    "name" : "q85"
  }, {
    "durationMs" : 1972,
    "iteration" : 3,
    "name" : "q86"
  }, {
    "durationMs" : 3868,
    "iteration" : 3,
    "name" : "q87"
  }, {
    "durationMs" : 8744,
    "iteration" : 3,
    "name" : "q88"
  }, {
    "durationMs" : 2351,
    "iteration" : 3,
    "name" : "q89"
  }, {
    "durationMs" : 12146,
    "iteration" : 3,
    "name" : "q9"
  }, {
    "durationMs" : 3423,
    "iteration" : 3,
    "name" : "q90"
  }, {
    "durationMs" : 3290,
    "iteration" : 3,
    "name" : "q91"
  }, {
    "durationMs" : 2520,
    "iteration" : 3,
    "name" : "q92"
  }, {
    "durationMs" : 3527,
    "iteration" : 3,
    "name" : "q93"
  }, {
    "durationMs" : 4061,
    "iteration" : 3,
    "name" : "q94"
  }, {
    "durationMs" : 3964,
    "iteration" : 3,
    "name" : "q95"
  }, {
    "durationMs" : 1931,
    "iteration" : 3,
    "name" : "q96"
  }, {
    "durationMs" : 2196,
    "iteration" : 3,
    "name" : "q97"
  }, {
    "durationMs" : 2493,
    "iteration" : 3,
    "name" : "q98"
  }, {
    "durationMs" : 2384,
    "iteration" : 3,
    "name" : "q99"
  } ],
  "sparkEnvInfo" : {
    "classpathEntries" : {
      "//fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar" : "System Classpath",
      "/etc/hadoop/conf/" : "System Classpath",
      "/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/conf/" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/HikariCP-2.5.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/JLargeArrays-1.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/JTransforms-3.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/RoaringBitmap-0.9.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/ST4-4.0.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/accessors-smart-1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/activation-1.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/aircompressor-0.10.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/algebra_2.12-2.0.0-M2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/antlr-runtime-3.5.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/antlr4-runtime-4.8-1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/aopalliance-1.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/aopalliance-repackaged-2.6.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/arpack_combined_all-0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/arrow-format-2.0.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/arrow-memory-core-2.0.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/arrow-memory-netty-2.0.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/arrow-vector-2.0.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/audience-annotations-0.5.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/avro-1.8.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/avro-ipc-1.8.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/avro-mapred-1.8.2-hadoop2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/bcpkix-jdk15on-1.60.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/bcprov-jdk15on-1.60.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/bonecp-0.8.0.RELEASE.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/breeze-macros_2.12-1.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/breeze_2.12-1.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/cats-kernel_2.12-2.0.0-M4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/chill-java-0.9.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/chill_2.12-0.9.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-beanutils-1.9.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-cli-1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-codec-1.10.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-collections-3.2.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-compiler-3.0.16.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-compress-1.20.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-configuration2-2.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-crypto-1.1.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-daemon-1.0.13.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-dbcp-1.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-httpclient-3.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-io-2.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-lang-2.6.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-lang3-3.10.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-logging-1.1.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-math3-3.4.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-net-3.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-pool-1.5.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/commons-text-1.6.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/compress-lzf-1.0.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/core-1.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/curator-client-2.13.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/curator-framework-2.13.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/curator-recipes-2.13.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/datanucleus-api-jdo-4.2.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/datanucleus-core-4.1.17.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/datanucleus-rdbms-4.1.19.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/derby-10.12.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/dnsjava-2.1.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/ehcache-3.3.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/flatbuffers-java-1.9.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/gcs-connector-hadoop3-2.2.7-shaded.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/geronimo-jcache_1.0_spec-1.0-alpha-1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/gson-2.2.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/guava-27.0-jre.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/guice-4.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/guice-servlet-4.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-annotations-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-auth-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-client-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-common-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-hdfs-client-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-mapreduce-client-common-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-mapreduce-client-core-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-mapreduce-client-jobclient-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-yarn-api-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-yarn-client-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-yarn-common-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-yarn-registry-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-yarn-server-common-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hadoop-yarn-server-web-proxy-3.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-beeline-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-cli-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-common-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-exec-2.3.7-core.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-jdbc-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-llap-common-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-metastore-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-serde-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-service-rpc-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-shims-0.23-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-shims-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-shims-common-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-shims-scheduler-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-storage-api-2.7.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hive-vector-code-gen-2.3.7.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hk2-api-2.6.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hk2-locator-2.6.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hk2-utils-2.6.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/htrace-core4-4.1.0-incubating.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/httpclient-4.4.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/httpcore-4.4.12.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/hudi-spark3.1-bundle_2.12-0.13.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/istack-commons-runtime-3.0.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/ivy-2.4.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-annotations-2.10.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-core-2.10.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-core-asl-1.9.13.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-databind-2.10.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-jaxrs-base-2.9.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-jaxrs-json-provider-2.9.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-mapper-asl-1.9.13.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-module-jaxb-annotations-2.10.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-module-paranamer-2.10.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jackson-module-scala_2.12-2.10.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.activation-api-1.2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.annotation-api-1.3.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.inject-2.6.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.servlet-api-4.0.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.validation-api-2.0.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.ws.rs-api-2.1.6.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jakarta.xml.bind-api-2.3.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/janino-3.0.16.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/javassist-3.25.0-GA.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/javax.inject-1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/javax.jdo-3.2.0-m3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/javolution-5.5.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jaxb-api-2.2.11.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jaxb-runtime-2.3.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jcip-annotations-1.0-1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jcl-over-slf4j-1.7.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jdo-api-3.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-client-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-common-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-container-servlet-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-container-servlet-core-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-hk2-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-media-jaxb-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jersey-server-2.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jline-2.14.6.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/joda-time-2.10.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jodd-core-3.5.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jpam-1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/json-1.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/json-smart-2.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/json4s-ast_2.12-3.7.0-M5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/json4s-core_2.12-3.7.0-M5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/json4s-jackson_2.12-3.7.0-M5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/json4s-scalap_2.12-3.7.0-M5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jsp-api-2.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jsr305-3.0.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jta-1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/jul-to-slf4j-1.7.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-admin-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-client-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-common-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-core-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-crypto-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-identity-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-server-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-simplekdc-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerb-util-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerby-asn1-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerby-config-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerby-pkix-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerby-util-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kerby-xdr-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/kryo-shaded-4.0.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/leveldbjni-all-1.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/libfb303-0.9.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/libthrift-0.12.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/log4j-1.2.17.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/lz4-java-1.7.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/machinist_2.12-0.6.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/macro-compat_2.12-1.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/metrics-core-4.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/metrics-graphite-4.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/metrics-jmx-4.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/metrics-json-4.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/metrics-jvm-4.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/minlog-1.3.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/netty-all-4.1.51.Final.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/nimbus-jose-jwt-4.41.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/objenesis-2.6.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/okhttp-2.7.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/okio-1.14.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/opencsv-2.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/orc-core-1.5.12.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/orc-mapreduce-1.5.12.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/orc-shims-1.5.12.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/oro-2.0.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/osgi-resource-locator-1.0.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/paranamer-2.8.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/parquet-column-1.10.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/parquet-common-1.10.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/parquet-encoding-1.10.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/parquet-format-2.4.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/parquet-hadoop-1.10.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/parquet-jackson-1.10.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/protobuf-java-2.5.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/py4j-0.10.9.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/pyrolite-4.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/re2j-1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/scala-collection-compat_2.12-2.1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/scala-compiler-2.12.10.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/scala-library-2.12.10.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/scala-parser-combinators_2.12-1.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/scala-reflect-2.12.10.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/scala-xml_2.12-1.2.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/shapeless_2.12-2.3.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/shims-0.9.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/slf4j-api-1.7.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/slf4j-log4j12-1.7.30.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/snappy-java-1.1.8.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-catalyst_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-core_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-graphx_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-hive-thriftserver_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-hive_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-kvstore_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-launcher_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-mllib-local_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-mllib_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-network-common_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-network-shuffle_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-repl_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-sketch_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-sql_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-streaming_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-tags_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-unsafe_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spark-yarn_2.12-3.1.2.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spire-macros_2.12-0.17.0-M1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spire-platform_2.12-0.17.0-M1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spire-util_2.12-0.17.0-M1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/spire_2.12-0.17.0-M1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/stax-api-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/stax2-api-3.1.4.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/stream-2.9.6.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/super-csv-2.2.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/threeten-extra-1.5.0.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/token-provider-1.0.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/transaction-api-1.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/univocity-parsers-2.9.1.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/velocity-1.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/woodstox-core-5.0.3.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/xbean-asm7-shaded-4.15.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/xz-1.5.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/zookeeper-3.4.14.jar" : "System Classpath",
      "/var/lib/fk-pf-spark3/jars/zstd-jni-1.4.8-1.jar" : "System Classpath",
      "gs" : "System Classpath"
    },
    "hadoopProps" : {
      "adl.feature.ownerandgroup.enableupn" : "false",
      "adl.http.timeout" : "-1",
      "ambari.hive.db.schema.name" : "hive",
      "datanucleus.cache.level2.type" : "none",
      "datanucleus.connectionPool.maxPoolSize" : "10",
      "datanucleus.schema.autoCreateTables" : "true",
      "dfs.blocksize" : "536870912",
      "dfs.bytes-per-checksum" : "512",
      "dfs.client.failover.proxy.provider.pluto" : "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider",
      "dfs.client.failover.random.order" : "true",
      "dfs.client.read.shortcircuit" : "true",
      "dfs.client.read.shortcircuit.streams.cache.size" : "4096",
      "dfs.domain.socket.path" : "/var/lib/hadoop-hdfs/dn_socket",
      "dfs.ha.fencing.ssh.connect-timeout" : "30000",
      "dfs.ha.namenodes.pluto" : "nn1,nn2",
      "dfs.namenode.http-address.pluto.nn1" : "fks-fdp-galaxy-pluto-nn-0001.c.fks-fdp-galaxy.internal:50070",
      "dfs.namenode.http-address.pluto.nn2" : "fks-fdp-galaxy-pluto-nn-0002.c.fks-fdp-galaxy.internal:50070",
      "dfs.namenode.https-address.pluto.nn1" : "fks-fdp-galaxy-pluto-nn-0001.c.fks-fdp-galaxy.internal:50470",
      "dfs.namenode.https-address.pluto.nn2" : "fks-fdp-galaxy-pluto-nn-0002.c.fks-fdp-galaxy.internal:50470",
      "dfs.namenode.rpc-address.pluto.nn1" : "fks-fdp-galaxy-pluto-nn-0001.c.fks-fdp-galaxy.internal:8020",
      "dfs.namenode.rpc-address.pluto.nn2" : "fks-fdp-galaxy-pluto-nn-0002.c.fks-fdp-galaxy.internal:8020",
      "dfs.nameservices" : "pluto",
      "dfs.replication" : "3",
      "fdp.default.tier" : "Regular",
      "fdp.ironbank.url" : "http://console.fdp-ironbank-prod.fkcloud.in/",
      "fdp.orgqueue.cache.expire" : "300",
      "fdp.orgqueue.cache.size" : "100",
      "fdp.orgqueue.defaultQueue" : "adhoc",
      "fdp.orgqueue.gringotts.clientId" : "QAAS",
      "fdp.orgqueue.gringotts.clientSecret" : "*********(redacted)",
      "fdp.orgqueue.gringotts.url" : "http://gringotts.fdp-gringotts-prod.fkcloud.in/billingOrg/user",
      "fdp.orgqueue.queueNotFound.errorMessage" : "Queue mapping not found",
      "fdp.orgqueue.validInitiators" : "BADGER,QAAS,LQE,SUPERBI",
      "fdp.tier.expression" : "Regular",
      "fdp.tier.lqe.lock.wait.time.secs" : "30",
      "fdp.tier.lqe.max.sessions" : "1",
      "file.blocksize" : "67108864",
      "file.bytes-per-checksum" : "512",
      "file.client-write-packet-size" : "65536",
      "file.replication" : "1",
      "file.stream-buffer-size" : "4096",
      "fs.AbstractFileSystem.abfs.impl" : "org.apache.hadoop.fs.azurebfs.Abfs",
      "fs.AbstractFileSystem.abfss.impl" : "org.apache.hadoop.fs.azurebfs.Abfss",
      "fs.AbstractFileSystem.adl.impl" : "org.apache.hadoop.fs.adl.Adl",
      "fs.AbstractFileSystem.file.impl" : "org.apache.hadoop.fs.local.LocalFs",
      "fs.AbstractFileSystem.ftp.impl" : "org.apache.hadoop.fs.ftp.FtpFs",
      "fs.AbstractFileSystem.gs.impl" : "com.google.cloud.hadoop.fs.gcs.GoogleHadoopFS",
      "fs.AbstractFileSystem.har.impl" : "org.apache.hadoop.fs.HarFs",
      "fs.AbstractFileSystem.hdfs.impl" : "org.apache.hadoop.fs.Hdfs",
      "fs.AbstractFileSystem.s3a.impl" : "org.apache.hadoop.fs.s3a.S3A",
      "fs.AbstractFileSystem.swebhdfs.impl" : "org.apache.hadoop.fs.SWebHdfs",
      "fs.AbstractFileSystem.viewfs.impl" : "org.apache.hadoop.fs.viewfs.ViewFs",
      "fs.AbstractFileSystem.wasb.impl" : "org.apache.hadoop.fs.azure.Wasb",
      "fs.AbstractFileSystem.wasbs.impl" : "org.apache.hadoop.fs.azure.Wasbs",
      "fs.AbstractFileSystem.webhdfs.impl" : "org.apache.hadoop.fs.WebHdfs",
      "fs.abfs.impl" : "org.apache.hadoop.fs.azurebfs.AzureBlobFileSystem",
      "fs.abfss.impl" : "org.apache.hadoop.fs.azurebfs.SecureAzureBlobFileSystem",
      "fs.adl.impl" : "org.apache.hadoop.fs.adl.AdlFileSystem",
      "fs.adl.oauth2.access.token.provider.type" : "*********(redacted)",
      "fs.automatic.close" : "true",
      "fs.azure.authorization" : "false",
      "fs.azure.authorization.caching.enable" : "true",
      "fs.azure.local.sas.key.mode" : "false",
      "fs.azure.sas.expiry.period" : "90d",
      "fs.azure.saskey.usecontainersaskeyforallaccess" : "true",
      "fs.azure.secure.mode" : "false",
      "fs.azure.user.agent.prefix" : "unknown",
      "fs.client.resolve.remote.symlinks" : "true",
      "fs.client.resolve.topology.enabled" : "false",
      "fs.defaultFS" : "hdfs://pluto",
      "fs.df.interval" : "60000",
      "fs.du.interval" : "600000",
      "fs.ftp.data.connection.mode" : "ACTIVE_LOCAL_DATA_CONNECTION_MODE",
      "fs.ftp.host" : "0.0.0.0",
      "fs.ftp.host.port" : "21",
      "fs.ftp.impl" : "org.apache.hadoop.fs.ftp.FTPFileSystem",
      "fs.ftp.transfer.mode" : "BLOCK_TRANSFER_MODE",
      "fs.gs.auth.service.account.enable" : "true",
      "fs.gs.batch.threads" : "60",
      "fs.gs.impl" : "com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystem",
      "fs.gs.max.requests.per.batch" : "300",
      "fs.gs.reported.permissions" : "777",
      "fs.har.impl.disable.cache" : "true",
      "fs.permissions.umask-mode" : "022",
      "fs.s3a.assumed.role.credentials.provider" : "org.apache.hadoop.fs.s3a.SimpleAWSCredentialsProvider",
      "fs.s3a.assumed.role.session.duration" : "30m",
      "fs.s3a.assumed.role.sts.endpoint.region" : "us-west-1",
      "fs.s3a.attempts.maximum" : "20",
      "fs.s3a.block.size" : "32M",
      "fs.s3a.buffer.dir" : "${hadoop.tmp.dir}/s3a",
      "fs.s3a.change.detection.mode" : "server",
      "fs.s3a.change.detection.source" : "etag",
      "fs.s3a.change.detection.version.required" : "true",
      "fs.s3a.committer.magic.enabled" : "false",
      "fs.s3a.committer.name" : "file",
      "fs.s3a.committer.staging.abort.pending.uploads" : "true",
      "fs.s3a.committer.staging.conflict-mode" : "fail",
      "fs.s3a.committer.staging.tmp.path" : "tmp/staging",
      "fs.s3a.committer.staging.unique-filenames" : "true",
      "fs.s3a.committer.threads" : "8",
      "fs.s3a.connection.establish.timeout" : "5000",
      "fs.s3a.connection.maximum" : "15",
      "fs.s3a.connection.ssl.enabled" : "true",
      "fs.s3a.connection.timeout" : "200000",
      "fs.s3a.etag.checksum.enabled" : "false",
      "fs.s3a.fast.upload.active.blocks" : "4",
      "fs.s3a.fast.upload.buffer" : "disk",
      "fs.s3a.impl" : "org.apache.hadoop.fs.s3a.S3AFileSystem",
      "fs.s3a.list.version" : "2",
      "fs.s3a.max.total.tasks" : "5",
      "fs.s3a.metadatastore.authoritative" : "false",
      "fs.s3a.metadatastore.impl" : "org.apache.hadoop.fs.s3a.s3guard.NullMetadataStore",
      "fs.s3a.multiobjectdelete.enable" : "true",
      "fs.s3a.multipart.purge" : "false",
      "fs.s3a.multipart.purge.age" : "86400",
      "fs.s3a.multipart.size" : "100M",
      "fs.s3a.multipart.threshold" : "2147483647",
      "fs.s3a.paging.maximum" : "5000",
      "fs.s3a.path.style.access" : "false",
      "fs.s3a.readahead.range" : "64K",
      "fs.s3a.retry.interval" : "500ms",
      "fs.s3a.retry.limit" : "${fs.s3a.attempts.maximum}",
      "fs.s3a.retry.throttle.interval" : "1000ms",
      "fs.s3a.retry.throttle.limit" : "${fs.s3a.attempts.maximum}",
      "fs.s3a.s3guard.cli.prune.age" : "86400000",
      "fs.s3a.s3guard.ddb.background.sleep" : "25ms",
      "fs.s3a.s3guard.ddb.max.retries" : "9",
      "fs.s3a.s3guard.ddb.table.capacity.read" : "500",
      "fs.s3a.s3guard.ddb.table.capacity.write" : "100",
      "fs.s3a.s3guard.ddb.table.create" : "false",
      "fs.s3a.s3guard.ddb.throttle.retry.interval" : "100ms",
      "fs.s3a.socket.recv.buffer" : "8192",
      "fs.s3a.socket.send.buffer" : "8192",
      "fs.s3a.threads.keepalivetime" : "60",
      "fs.s3a.threads.max" : "10",
      "fs.swift.impl" : "org.apache.hadoop.fs.swift.snative.SwiftNativeFileSystem",
      "fs.trash.checkpoint.interval" : "0",
      "fs.trash.interval" : "0",
      "fs.viewfs.rename.strategy" : "SAME_MOUNTPOINT",
      "fs.wasb.impl" : "org.apache.hadoop.fs.azure.NativeAzureFileSystem",
      "fs.wasbs.impl" : "org.apache.hadoop.fs.azure.NativeAzureFileSystem$Secure",
      "ftp.blocksize" : "67108864",
      "ftp.bytes-per-checksum" : "512",
      "ftp.client-write-packet-size" : "65536",
      "ftp.replication" : "3",
      "ftp.stream-buffer-size" : "4096",
      "google.cloud.auth.service.account.enable" : "true",
      "ha.failover-controller.cli-check.rpc-timeout.ms" : "20000",
      "ha.failover-controller.graceful-fence.connection.retries" : "1",
      "ha.failover-controller.graceful-fence.rpc-timeout.ms" : "5000",
      "ha.failover-controller.new-active.rpc-timeout.ms" : "60000",
      "ha.health-monitor.check-interval.ms" : "1000",
      "ha.health-monitor.connect-retry-interval.ms" : "1000",
      "ha.health-monitor.rpc-timeout.ms" : "45000",
      "ha.health-monitor.sleep-after-disconnect.ms" : "1000",
      "ha.zookeeper.acl" : "world:anyone:rwcda",
      "ha.zookeeper.parent-znode" : "/hadoop-ha",
      "ha.zookeeper.session-timeout.ms" : "10000",
      "hadoop.caller.context.enabled" : "false",
      "hadoop.caller.context.max.size" : "128",
      "hadoop.caller.context.signature.max.size" : "40",
      "hadoop.common.configuration.version" : "3.0.0",
      "hadoop.http.authentication.kerberos.keytab" : "${user.home}/hadoop.keytab",
      "hadoop.http.authentication.kerberos.principal" : "HTTP/_HOST@LOCALHOST",
      "hadoop.http.authentication.signature.secret.file" : "*********(redacted)",
      "hadoop.http.authentication.simple.anonymous.allowed" : "true",
      "hadoop.http.authentication.token.validity" : "*********(redacted)",
      "hadoop.http.authentication.type" : "simple",
      "hadoop.http.cross-origin.allowed-headers" : "X-Requested-With,Content-Type,Accept,Origin",
      "hadoop.http.cross-origin.allowed-methods" : "GET,POST,HEAD",
      "hadoop.http.cross-origin.allowed-origins" : "*",
      "hadoop.http.cross-origin.enabled" : "false",
      "hadoop.http.cross-origin.max-age" : "1800",
      "hadoop.http.filter.initializers" : "org.apache.hadoop.http.lib.StaticUserWebFilter",
      "hadoop.http.logs.enabled" : "true",
      "hadoop.http.staticuser.user" : "dr.who",
      "hadoop.jetty.logs.serve.aliases" : "true",
      "hadoop.kerberos.kinit.command" : "kinit",
      "hadoop.kerberos.min.seconds.before.relogin" : "60",
      "hadoop.proxyuser.hive.groups" : "*",
      "hadoop.proxyuser.hive.hosts" : "*",
      "hadoop.registry.jaas.context" : "Client",
      "hadoop.registry.secure" : "false",
      "hadoop.registry.system.acls" : "sasl:yarn@, sasl:mapred@, sasl:hdfs@",
      "hadoop.registry.zk.connection.timeout.ms" : "15000",
      "hadoop.registry.zk.quorum" : "localhost:2181",
      "hadoop.registry.zk.retry.ceiling.ms" : "60000",
      "hadoop.registry.zk.retry.interval.ms" : "1000",
      "hadoop.registry.zk.retry.times" : "5",
      "hadoop.registry.zk.root" : "/registry",
      "hadoop.registry.zk.session.timeout.ms" : "60000",
      "hadoop.rpc.protection" : "authentication",
      "hadoop.rpc.socket.factory.class.default" : "org.apache.hadoop.net.StandardSocketFactory",
      "hadoop.security.auth_to_local" : "DEFAULT",
      "hadoop.security.auth_to_local.mechanism" : "hadoop",
      "hadoop.security.authentication" : "simple",
      "hadoop.security.authorization" : "false",
      "hadoop.security.credential.clear-text-fallback" : "true",
      "hadoop.security.crypto.buffer.size" : "8192",
      "hadoop.security.crypto.cipher.suite" : "AES/CTR/NoPadding",
      "hadoop.security.crypto.codec.classes.aes.ctr.nopadding" : "org.apache.hadoop.crypto.OpensslAesCtrCryptoCodec, org.apache.hadoop.crypto.JceAesCtrCryptoCodec",
      "hadoop.security.dns.log-slow-lookups.enabled" : "false",
      "hadoop.security.dns.log-slow-lookups.threshold.ms" : "1000",
      "hadoop.security.group.mapping" : "org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback",
      "hadoop.security.group.mapping.ldap.connection.timeout.ms" : "60000",
      "hadoop.security.group.mapping.ldap.conversion.rule" : "none",
      "hadoop.security.group.mapping.ldap.directory.search.timeout" : "10000",
      "hadoop.security.group.mapping.ldap.num.attempts" : "3",
      "hadoop.security.group.mapping.ldap.num.attempts.before.failover" : "3",
      "hadoop.security.group.mapping.ldap.posix.attr.gid.name" : "gidNumber",
      "hadoop.security.group.mapping.ldap.posix.attr.uid.name" : "uidNumber",
      "hadoop.security.group.mapping.ldap.read.timeout.ms" : "60000",
      "hadoop.security.group.mapping.ldap.search.attr.group.name" : "cn",
      "hadoop.security.group.mapping.ldap.search.attr.member" : "member",
      "hadoop.security.group.mapping.ldap.search.filter.group" : "(objectClass=group)",
      "hadoop.security.group.mapping.ldap.search.filter.user" : "(&(objectClass=user)(sAMAccountName={0}))",
      "hadoop.security.group.mapping.ldap.search.group.hierarchy.levels" : "0",
      "hadoop.security.group.mapping.ldap.ssl" : "false",
      "hadoop.security.group.mapping.providers.combined" : "true",
      "hadoop.security.groups.cache.background.reload" : "false",
      "hadoop.security.groups.cache.background.reload.threads" : "3",
      "hadoop.security.groups.cache.secs" : "300",
      "hadoop.security.groups.cache.warn.after.ms" : "5000",
      "hadoop.security.groups.negative-cache.secs" : "30",
      "hadoop.security.groups.shell.command.timeout" : "0s",
      "hadoop.security.instrumentation.requires.admin" : "false",
      "hadoop.security.java.secure.random.algorithm" : "SHA1PRNG",
      "hadoop.security.key.default.bitlength" : "128",
      "hadoop.security.key.default.cipher" : "AES/CTR/NoPadding",
      "hadoop.security.kms.client.authentication.retry-count" : "1",
      "hadoop.security.kms.client.encrypted.key.cache.expiry" : "43200000",
      "hadoop.security.kms.client.encrypted.key.cache.low-watermark" : "0.3f",
      "hadoop.security.kms.client.encrypted.key.cache.num.refill.threads" : "2",
      "hadoop.security.kms.client.encrypted.key.cache.size" : "500",
      "hadoop.security.kms.client.failover.sleep.base.millis" : "100",
      "hadoop.security.kms.client.failover.sleep.max.millis" : "2000",
      "hadoop.security.kms.client.timeout" : "60",
      "hadoop.security.random.device.file.path" : "/dev/urandom",
      "hadoop.security.sensitive-config-keys" : "*********(redacted)",
      "hadoop.security.uid.cache.secs" : "14400",
      "hadoop.service.shutdown.timeout" : "30s",
      "hadoop.shell.missing.defaultFs.warning" : "false",
      "hadoop.shell.safely.delete.limit.num.files" : "100",
      "hadoop.ssl.client.conf" : "ssl-client.xml",
      "hadoop.ssl.enabled" : "false",
      "hadoop.ssl.enabled.protocols" : "TLSv1,SSLv2Hello,TLSv1.1,TLSv1.2",
      "hadoop.ssl.hostname.verifier" : "DEFAULT",
      "hadoop.ssl.keystores.factory.class" : "org.apache.hadoop.security.ssl.FileBasedKeyStoresFactory",
      "hadoop.ssl.require.client.cert" : "false",
      "hadoop.ssl.server.conf" : "ssl-server.xml",
      "hadoop.system.tags" : "YARN,HDFS,NAMENODE,DATANODE,REQUIRED,SECURITY,KERBEROS,PERFORMANCE,CLIENT\n      ,SERVER,DEBUG,DEPRECATED,COMMON,OPTIONAL",
      "hadoop.tags.system" : "YARN,HDFS,NAMENODE,DATANODE,REQUIRED,SECURITY,KERBEROS,PERFORMANCE,CLIENT\n      ,SERVER,DEBUG,DEPRECATED,COMMON,OPTIONAL",
      "hadoop.tmp.dir" : "/tmp/hadoop-${user.name}",
      "hadoop.user.group.static.mapping.overrides" : "dr.who=;",
      "hadoop.util.hash.type" : "murmur",
      "hadoop.workaround.non.threadsafe.getpwuid" : "true",
      "hadoop.zk.acl" : "world:anyone:rwcda",
      "hadoop.zk.num-retries" : "1000",
      "hadoop.zk.retry-interval-ms" : "1000",
      "hadoop.zk.timeout-ms" : "10000",
      "hbase.zookeeper.quorum" : "fks-fdp-galaxy-pluto-zkjn-0001.c.fks-fdp-galaxy.internal:2181,fks-fdp-galaxy-pluto-zkjn-0002.c.fks-fdp-galaxy.internal:2181,fks-fdp-galaxy-pluto-zkjn-0003.c.fks-fdp-galaxy.internal:2181",
      "hive.auto.convert.join" : "false",
      "hive.auto.convert.join.noconditionaltask" : "false",
      "hive.auto.convert.join.noconditionaltask.size" : "134217728",
      "hive.auto.convert.sortmerge.join" : "false",
      "hive.auto.convert.sortmerge.join.noconditionaltask" : "false",
      "hive.auto.convert.sortmerge.join.to.mapjoin" : "false",
      "hive.cbo.enable" : "true",
      "hive.cli.print.header" : "false",
      "hive.cluster.delegation.token.store.class" : "*********(redacted)",
      "hive.cluster.delegation.token.store.zookeeper.connectString" : "*********(redacted)",
      "hive.cluster.delegation.token.store.zookeeper.znode" : "*********(redacted)",
      "hive.compactor.abortedtxn.threshold" : "1000",
      "hive.compactor.check.interval" : "300L",
      "hive.compactor.delta.num.threshold" : "10",
      "hive.compactor.delta.pct.threshold" : "0.1f",
      "hive.compactor.initiator.on" : "false",
      "hive.compactor.worker.threads" : "0",
      "hive.compactor.worker.timeout" : "86400L",
      "hive.compute.query.using.stats" : "false",
      "hive.conf.restricted.list" : "hive.security.authenticator.manager,hive.security.authorization.manager,hive.users.in.admin.role",
      "hive.convert.join.bucket.mapjoin.tez" : "true",
      "hive.default.fileformat.managed" : "ORC",
      "hive.driver.parallel.compilation" : "true",
      "hive.enforce.bucketing" : "true",
      "hive.enforce.sorting" : "true",
      "hive.enforce.sortmergebucketmapjoin" : "true",
      "hive.exec.compress.intermediate" : "true",
      "hive.exec.compress.output" : "false",
      "hive.exec.dynamic.partition" : "true",
      "hive.exec.dynamic.partition.mode" : "nonstrict",
      "hive.exec.failure.hooks" : "com.flipkart.fdp.hive.hooks.EnforceSingleQueryPostExecHook",
      "hive.exec.max.created.files" : "100000",
      "hive.exec.max.dynamic.partitions" : "1000000",
      "hive.exec.max.dynamic.partitions.pernode" : "1000000",
      "hive.exec.orc.compression.strategy" : "SPEED",
      "hive.exec.orc.default.compress" : "ZLIB",
      "hive.exec.orc.default.stripe.size" : "67108864",
      "hive.exec.parallel" : "true",
      "hive.exec.parallel.thread.number" : "8",
      "hive.exec.post.hooks" : "org.apache.hadoop.hive.ql.hooks.LineageLogger,com.flipkart.fdp.hive.hooks.EnforceSingleQueryPostExecHook",
      "hive.exec.pre.hooks" : "com.flipkart.fdp.hive.hooks.EnforceSingleQueryPreExecHook",
      "hive.exec.reducers.bytes.per.reducer" : "134217728",
      "hive.exec.reducers.max" : "250",
      "hive.exec.scratchdir" : "gs://stage-hive-metastore-pluto/user/hiveexternaldir",
      "hive.exec.submit.local.task.via.child" : "true",
      "hive.exec.submitviachild" : "false",
      "hive.execution.engine" : "tez",
      "hive.fetch.task.aggr" : "true",
      "hive.fetch.task.conversion" : "more",
      "hive.fetch.task.conversion.threshold" : "1073741824",
      "hive.fileformat.managed" : "ORC",
      "hive.heapsize" : "2048",
      "hive.input.format" : "org.apache.hadoop.hive.ql.io.CombineHiveInputFormat",
      "hive.limit.optimize.enable" : "true",
      "hive.limit.pushdown.memory.usage" : "0.2",
      "hive.map.aggr" : "true",
      "hive.map.aggr.hash.force.flush.memory.threshold" : "0.5",
      "hive.map.aggr.hash.min.reduction" : "0.5",
      "hive.map.aggr.hash.percentmemory" : "0.5",
      "hive.mapjoin.bucket.cache.size" : "1000",
      "hive.mapjoin.localtask.max.memory.usage" : "0.4",
      "hive.mapjoin.optimized.hashtable" : "false",
      "hive.mapred.reduce.tasks.speculative.execution" : "false",
      "hive.merge.mapfiles" : "true",
      "hive.merge.mapredfiles" : "false",
      "hive.merge.orcfile.stripe.level" : "true",
      "hive.merge.rcfile.block.level" : "true",
      "hive.merge.size.per.task" : "256000000",
      "hive.merge.smallfiles.avgsize" : "16000000",
      "hive.merge.tezfiles" : "true",
      "hive.metastore.authorization.storage.checks" : "false",
      "hive.metastore.cache.pinobjtypes" : "Table,Database,Type,FieldSchema,Order",
      "hive.metastore.client.connect.retry.delay" : "5s",
      "hive.metastore.client.scheme.handlers" : "com.flipkart.fdp.hive.metastore.ELBSchemeHandler",
      "hive.metastore.client.socket.timeout" : "1800s",
      "hive.metastore.connect.retries" : "24",
      "hive.metastore.execute.setugi" : "true",
      "hive.metastore.failure.retries" : "24",
      "hive.metastore.fshandler.threads" : "15",
      "hive.metastore.kerberos.keytab.file" : "/etc/security/keytabs/hive.service.keytab",
      "hive.metastore.kerberos.principal" : "hive/_HOST@EXAMPLE.COM",
      "hive.metastore.limit.partition.request" : "-1",
      "hive.metastore.metrics.enabled" : "true",
      "hive.metastore.pre.event.listeners" : "org.apache.hadoop.hive.ql.security.authorization.AuthorizationPreEventListener",
      "hive.metastore.sasl.enabled" : "false",
      "hive.metastore.server.max.threads" : "100000",
      "hive.metastore.uris" : "thrift://10.116.17.2:9083",
      "hive.metastore.warehouse.dir" : "gs://stage-hive-metastore-pluto/apps/hive/warehouse",
      "hive.msck.path.validation" : "ignore",
      "hive.msck.repair.batch.size" : "0",
      "hive.optimize.bucketmapjoin" : "true",
      "hive.optimize.bucketmapjoin.sortedmerge" : "true",
      "hive.optimize.constant.propagation" : "true",
      "hive.optimize.index.filter" : "true",
      "hive.optimize.mapjoin.mapreduce" : "true",
      "hive.optimize.metadataonly" : "true",
      "hive.optimize.null.scan" : "true",
      "hive.optimize.reducededuplication" : "true",
      "hive.optimize.reducededuplication.min.reducer" : "4",
      "hive.optimize.sort.dynamic.partition" : "true",
      "hive.orc.compute.splits.num.threads" : "10",
      "hive.orc.splits.include.file.footer" : "false",
      "hive.prewarm.enabled" : "false",
      "hive.prewarm.numcontainers" : "10",
      "hive.querylog.enable.plan.progress" : "false",
      "hive.security.authenticator.manager" : "org.apache.hadoop.hive.ql.security.ProxyUserAuthenticator",
      "hive.security.authorization.enabled" : "false",
      "hive.security.authorization.manager" : "org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdConfOnlyAuthorizerFactory",
      "hive.security.authorization.sqlstd.confwhitelist.append" : "|initiator.*|job.*|mapred.*|badger.*|azkaban.*|tez.*|dfs.*|mapreduce.*|hive.*|hbase.*|light.*|beeline.*|orc.*|fdp.*|.*impersonation.*|fs.gs.*",
      "hive.security.metastore.authenticator.manager" : "org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator",
      "hive.security.metastore.authorization.auth.reads" : "true",
      "hive.security.metastore.authorization.manager" : "\n            org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider\n        ",
      "hive.server2.allow.user.substitution" : "true",
      "hive.server2.authentication" : "NONE",
      "hive.server2.authentication.spnego.keytab" : "HTTP/_HOST@EXAMPLE.COM",
      "hive.server2.authentication.spnego.principal" : "/etc/security/keytabs/spnego.service.keytab",
      "hive.server2.clear.dangling.scratchdir" : "true",
      "hive.server2.clear.dangling.scratchdir.interval" : "1800",
      "hive.server2.enable.doAs" : "true",
      "hive.server2.enable.impersonation" : "true",
      "hive.server2.idle.operation.timeout" : "1d",
      "hive.server2.idle.session.timeout" : "1d",
      "hive.server2.logging.operation.enabled" : "true",
      "hive.server2.logging.operation.log.location" : "${java.io.tmpdir}/${user.name}/operation_logs",
      "hive.server2.metrics.enabled" : "true",
      "hive.server2.session.check.interval" : "60m",
      "hive.server2.support.dynamic.service.discovery" : "true",
      "hive.server2.table.type.mapping" : "CLASSIC",
      "hive.server2.tez.default.queues" : "default",
      "hive.server2.tez.initialize.default.sessions" : "false",
      "hive.server2.tez.sessions.per.default.queue" : "1",
      "hive.server2.thrift.http.path" : "cliservice",
      "hive.server2.thrift.http.port" : "10001",
      "hive.server2.thrift.max.worker.threads" : "500",
      "hive.server2.thrift.sasl.qop" : "auth",
      "hive.server2.transport.mode" : "http",
      "hive.server2.use.SSL" : "false",
      "hive.server2.zookeeper.namespace" : "fks-fdp-galaxy-hive3-hs2-pluto",
      "hive.session.history.enabled" : "false",
      "hive.smbjoin.cache.rows" : "1000",
      "hive.stats.autogather" : "true",
      "hive.stats.dbclass" : "fs",
      "hive.stats.fetch.column.stats" : "false",
      "hive.stats.fetch.partition.stats" : "false",
      "hive.strict.checks.cartesian.product" : "false",
      "hive.strict.checks.type.safety" : "false",
      "hive.support.concurrency" : "false",
      "hive.support.sql11.reserved.keywords" : "true",
      "hive.tez.auto.reducer.parallelism" : "false",
      "hive.tez.container.size" : "3072",
      "hive.tez.cpu.vcores" : "-1",
      "hive.tez.dynamic.partition.pruning" : "true",
      "hive.tez.dynamic.partition.pruning.max.data.size" : "104857600",
      "hive.tez.dynamic.partition.pruning.max.event.size" : "1048576",
      "hive.tez.input.format" : "org.apache.hadoop.hive.ql.io.HiveInputFormat",
      "hive.tez.log.level" : "INFO",
      "hive.tez.max.partition.factor" : "2.0",
      "hive.tez.min.partition.factor" : "0.25",
      "hive.tez.smb.number.waves" : "0.5",
      "hive.txn.manager" : "org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager",
      "hive.txn.max.open.batch" : "1000",
      "hive.txn.timeout" : "300",
      "hive.user.install.directory" : "gs://stage-hive-metastore-pluto/user/",
      "hive.vectorized.complex.types.enabled" : "false",
      "hive.vectorized.execution.enabled" : "true",
      "hive.vectorized.execution.ptf.enabled" : "false",
      "hive.vectorized.execution.reduce.enabled" : "true",
      "hive.vectorized.groupby.checkinterval" : "4096",
      "hive.vectorized.groupby.complex.types.enabled" : "false",
      "hive.vectorized.groupby.flush.percent" : "0.1",
      "hive.vectorized.groupby.maxentries" : "10000",
      "hive.zookeeper.client.port" : "2181",
      "hive.zookeeper.namespace" : "fks-sco-hive-pluto-zookeeper-namespace",
      "hive.zookeeper.quorum" : "fks-fdp-galaxy-pluto-zkjn-0001.c.fks-fdp-galaxy.internal:2181,fks-fdp-galaxy-pluto-zkjn-0002.c.fks-fdp-galaxy.internal:2181,fks-fdp-galaxy-pluto-zkjn-0003.c.fks-fdp-galaxy.internal:2181",
      "hive.zookeeper.session.timeout" : "120s",
      "io.compression.codec.bzip2.library" : "system-native",
      "io.compression.codec.lzo.class" : "com.hadoop.compression.lzo.LzoCodec",
      "io.compression.codecs" : "org.apache.hadoop.io.compress.SnappyCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.BZip2Codec,com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec,com.hadoop.compression.fourmc.Lz4Codec,com.hadoop.compression.fourmc.Lz4MediumCodec,com.hadoop.compression.fourmc.Lz4HighCodec,com.hadoop.compression.fourmc.Lz4UltraCodec,com.hadoop.compression.fourmc.FourMcCodec,com.hadoop.compression.fourmc.FourMcMediumCodec,com.hadoop.compression.fourmc.FourMcHighCodec,com.hadoop.compression.fourmc.FourMcUltraCodec",
      "io.erasurecode.codec.rs-legacy.rawcoders" : "rs-legacy_java",
      "io.erasurecode.codec.rs.rawcoders" : "rs_native,rs_java",
      "io.erasurecode.codec.xor.rawcoders" : "xor_native,xor_java",
      "io.file.buffer.size" : "65536",
      "io.map.index.interval" : "128",
      "io.map.index.skip" : "0",
      "io.mapfile.bloom.error.rate" : "0.005",
      "io.mapfile.bloom.size" : "1048576",
      "io.seqfile.compress.blocksize" : "1000000",
      "io.seqfile.local.dir" : "${hadoop.tmp.dir}/io/local",
      "io.serializations" : "org.apache.hadoop.io.serializer.WritableSerialization",
      "io.skip.checksum.errors" : "false",
      "ipc.client.bind.wildcard.addr" : "false",
      "ipc.client.connect.max.retries" : "50",
      "ipc.client.connect.max.retries.on.timeouts" : "45",
      "ipc.client.connect.retry.interval" : "1000",
      "ipc.client.connect.timeout" : "20000",
      "ipc.client.connection.maxidletime" : "30000",
      "ipc.client.fallback-to-simple-auth-allowed" : "false",
      "ipc.client.idlethreshold" : "8000",
      "ipc.client.kill.max" : "10",
      "ipc.client.low-latency" : "false",
      "ipc.client.ping" : "true",
      "ipc.client.rpc-timeout.ms" : "0",
      "ipc.client.tcpnodelay" : "true",
      "ipc.maximum.data.length" : "67108864",
      "ipc.maximum.response.length" : "134217728",
      "ipc.ping.interval" : "60000",
      "ipc.server.listen.queue.size" : "128",
      "ipc.server.log.slow.rpc" : "false",
      "ipc.server.max.connections" : "0",
      "javax.jdo.option.ConnectionDriverName" : "com.mysql.jdbc.Driver",
      "javax.jdo.option.ConnectionPassword" : "*********(redacted)",
      "javax.jdo.option.ConnectionURL" : "jdbc:mysql://10.117.192.58/stage_hive_metastore?createDatabaseIfNotExist=true",
      "javax.jdo.option.ConnectionUserName" : "stage_sco_rw",
      "jobname.enricher.class" : "org.apache.hadoop.hive.ql.propertymodifier.NoEnrichment",
      "map.sort.class" : "org.apache.hadoop.util.QuickSort",
      "net.topology.impl" : "org.apache.hadoop.net.NetworkTopology",
      "net.topology.node.switch.mapping.impl" : "org.apache.hadoop.net.ScriptBasedMapping",
      "net.topology.script.file.name" : "/etc/hadoop/conf/topology.py",
      "net.topology.script.number.args" : "100",
      "nfs.exports.allowed.hosts" : "* rw",
      "orc.schema.evolution.case.sensitive" : "false",
      "parser.timeoutSec" : "900",
      "queue.enforcer.class" : "com.flipkart.fdp.hive.orgqueue.OrgQueueEnforcerForInitiator",
      "rpc.metrics.quantile.enable" : "false",
      "seq.io.sort.factor" : "100",
      "seq.io.sort.mb" : "100",
      "tfile.fs.input.buffer.size" : "262144",
      "tfile.fs.output.buffer.size" : "262144",
      "tfile.io.chunk.size" : "1048576",
      "zookeeper.znode.parent" : "/hbase-unsecure"
    },
    "runtimeInfo" : {
      "javaHome" : "/usr/lib/jvm/oracle-java8-jdk-amd64/jre",
      "javaVersion" : "1.8.0_172 (Oracle Corporation)",
      "scalaVersion" : "version 2.12.10"
    },
    "sparkBuildInfo" : {
      "sparkBuildBranch" : "fdp-3.1.2-hadoop-3.2",
      "sparkBuildDate" : "2023-04-05T09:07:25Z",
      "sparkBuildRevision" : "1f03c4907e323e2f782742ceae6feff6c8ddcd12",
      "sparkBuildUser" : "somi.biswas",
      "sparkBuildVersion" : "3.1.2"
    },
    "sparkProps" : {
      "spark.app.id" : "application_1699449121496_0386",
      "spark.app.name" : "Spark shell",
      "spark.app.startTime" : "1701349857803",
      "spark.benchmarkId" : "20231130-184001-tpcds-1gb-iceberg",
      "spark.cleaner.ttl" : "86400",
      "spark.delta.logStore.gs.impl" : "io.delta.storage.GCSLogStore",
      "spark.driver.appUIAddress" : "http://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:4046",
      "spark.driver.cores" : "1",
      "spark.driver.extraClassPath" : "gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar",
      "spark.driver.extraJavaOptions" : "-Denv=prod -Dcom.sun.management.jmxremote.port=0 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=0 -XX:MaxDirectMemorySize=800M -XX:MaxMetaspaceSize=256M -XX:CompressedClassSpaceSize=100M -XX:+UnlockDiagnosticVMOptions -Djob.numOfRePartitions=30",
      "spark.driver.extraLibraryPath" : "/usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu",
      "spark.driver.host" : "fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal",
      "spark.driver.memory" : "5120m",
      "spark.driver.port" : "44775",
      "spark.dynamicAllocation.enabled" : "true",
      "spark.dynamicAllocation.executorIdleTimeout" : "60s",
      "spark.dynamicAllocation.maxExecutors" : "200",
      "spark.eventLog.dir" : "gs://fks-fdp-infra-job-history/pluto/spark-job-history",
      "spark.eventLog.enabled" : "true",
      "spark.executor.cores" : "1",
      "spark.executor.extraClassPath" : "gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar",
      "spark.executor.extraJavaOptions" : "-XX:MaxDirectMemorySize=8096m -Dio.netty.maxDirectMemory=8096m -XX:+UseG1GC -XX:ConcGCThreads=2",
      "spark.executor.extraLibraryPath" : "/usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu",
      "spark.executor.id" : "driver",
      "spark.executor.memory" : "10240m",
      "spark.fdp.orgqueue.cache.expire" : "300",
      "spark.fdp.orgqueue.cache.size" : "100",
      "spark.fdp.orgqueue.defaultQueue" : "adhoc",
      "spark.fdp.orgqueue.gringotts.clientId" : "QAAS",
      "spark.fdp.orgqueue.gringotts.clientSecret" : "*********(redacted)",
      "spark.fdp.orgqueue.gringotts.url" : "http://10.47.6.66/billingOrg/user",
      "spark.fdp.orgqueue.ironbank.url" : "http://10.47.4.16:/queue/",
      "spark.fdp.orgqueue.queueNotFound.errorMessage" : "Queue mapping not found",
      "spark.fdp.orgqueue.validInitiators" : "BADGER,QAAS",
      "spark.hadoop.yarn.timeline-service.enabled" : "false",
      "spark.history.fs.cleaner.interval" : "1d",
      "spark.history.fs.cleaner.maxAge" : "60d",
      "spark.history.fs.logDirectory" : "gs://fks-fdp-infra-job-history/pluto/spark-job-history",
      "spark.history.provider" : "org.apache.spark.deploy.history.FsHistoryProvider",
      "spark.home" : "/var/lib/fk-pf-spark3",
      "spark.jars" : "",
      "spark.master" : "yarn",
      "spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS" : "fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal",
      "spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES" : "http://fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386,http://fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088/proxy/application_1699449121496_0386",
      "spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.RM_HA_URLS" : "fks-fdp-galaxy-pluto-rm-0001.c.fks-fdp-galaxy.internal:8088,fks-fdp-galaxy-pluto-rm-0002.c.fks-fdp-galaxy.internal:8088",
      "spark.queue.enforcer.class" : "com.flipkart.fdp.orgqueue.OrgQueueEnforcerForInitiator",
      "spark.repl.class.outputDir" : "/grid/1/spark3/tmp/spark-54770f5f-78fc-47ed-a01f-1122505d941d/repl-e80e9371-8e44-432e-9c6c-c2bec67290cf",
      "spark.repl.class.uri" : "spark://fdp-stage-azk-scheduled-executor-b5cff3b1-nftj.c.fks-sco-azkaban.internal:44775/classes",
      "spark.repl.local.jars" : "file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar",
      "spark.scheduler.mode" : "FIFO",
      "spark.shuffle.service.enabled" : "true",
      "spark.shuffle.useOldFetchProtocol" : "true",
      "spark.sql.catalog.hive_pluto" : "org.apache.iceberg.spark.SparkCatalog",
      "spark.sql.catalog.hive_pluto.type" : "hive",
      "spark.sql.catalog.hive_pluto.uri" : "thrift://10.116.17.2:9083",
      "spark.sql.catalogImplementation" : "hive",
      "spark.sql.extensions" : "org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions",
      "spark.sql.sources.partitionOverwriteMode" : "dynamic",
      "spark.streaming.concurrentJobs" : "4",
      "spark.submit.deployMode" : "client",
      "spark.submit.pyFiles" : "",
      "spark.ui.filters" : "org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter",
      "spark.ui.showConsoleProgress" : "true",
      "spark.yarn.dist.jars" : "gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/hadoop-lzo-0.6.0.2.4.0.0-169.jar,file:/usr/share/fk-bigfoot-4mc/lib/hadoop-4mc-1.1.0.jar,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,gs://fksdp-mhosy-3nug-2a5d-systemlibs/libraries/hive/jars/dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,file:///var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar",
      "spark.yarn.driver.memoryOverhead" : "4096",
      "spark.yarn.executor.memoryOverhead" : "4096",
      "spark.yarn.historyServer.address" : "http://fks-fdp-galaxy-pluto-hs-0001-m.c.fks-fdp-galaxy.internal:18080",
      "spark.yarn.jars" : "",
      "spark.yarn.queue" : "de_adhoc",
      "spark.yarn.report.interval" : "60s",
      "spark.yarn.secondary.jars" : "hadoop-lzo-0.6.0.2.4.0.0-169.jar,hadoop-4mc-1.1.0.jar,json-serde-1.3-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,dimlookup-hive-udf-1.0-SNAPSHOT-jar-with-dependencies-jackson-shaded.jar,20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,iceberg-hive-runtime-1.2.0.jar,iceberg-spark-runtime-3.1_2.12-1.2.0.jar"
    },
    "systemProps" : {
      "SPARK_SUBMIT" : "true",
      "awt.toolkit" : "sun.awt.X11.XToolkit",
      "com.sun.management.jmxremote.authenticate" : "false",
      "com.sun.management.jmxremote.port" : "0",
      "com.sun.management.jmxremote.ssl" : "false",
      "env" : "prod",
      "file.encoding" : "ANSI_X3.4-1968",
      "file.encoding.pkg" : "sun.io",
      "file.separator" : "/",
      "java.awt.graphicsenv" : "sun.awt.X11GraphicsEnvironment",
      "java.awt.printerjob" : "sun.print.PSPrinterJob",
      "java.class.version" : "52.0",
      "java.endorsed.dirs" : "/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/endorsed",
      "java.ext.dirs" : "/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext",
      "java.home" : "/usr/lib/jvm/oracle-java8-jdk-amd64/jre",
      "java.io.tmpdir" : "/tmp",
      "java.library.path" : "/usr/flipkart/3.2.1-1/hadoop-hdfs/lib:/usr/flipkart/3.2.1-1/hadoop-hdfs/lib/native:/usr/lib/hadoop/lib:/usr/lib/hadoop/lib/native:/usr/lib/hadoop/lib/native/Linux-amd64-64:/usr/lib/x86_64-linux-gnu:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib",
      "java.rmi.server.randomIDs" : "true",
      "java.runtime.name" : "Java(TM) SE Runtime Environment",
      "java.runtime.version" : "1.8.0_172-b11",
      "java.specification.name" : "Java Platform API Specification",
      "java.specification.vendor" : "Oracle Corporation",
      "java.specification.version" : "1.8",
      "java.vendor" : "Oracle Corporation",
      "java.vendor.url" : "http://java.oracle.com/",
      "java.vendor.url.bug" : "http://bugreport.sun.com/bugreport/",
      "java.version" : "1.8.0_172",
      "java.vm.info" : "mixed mode",
      "java.vm.name" : "Java HotSpot(TM) 64-Bit Server VM",
      "java.vm.specification.name" : "Java Virtual Machine Specification",
      "java.vm.specification.vendor" : "Oracle Corporation",
      "java.vm.specification.version" : "1.8",
      "java.vm.vendor" : "Oracle Corporation",
      "java.vm.version" : "25.172-b11",
      "jetty.git.hash" : "b881a572662e1943a14ae12e7e1207989f218b74",
      "job.numOfRePartitions" : "30",
      "line.separator" : "\n",
      "os.arch" : "amd64",
      "os.name" : "Linux",
      "os.version" : "4.19.0-19-cloud-amd64",
      "path.separator" : ":",
      "scala.usejavacp" : "true",
      "sun.arch.data.model" : "64",
      "sun.boot.class.path" : "/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/oracle-java8-jdk-amd64/jre/classes",
      "sun.boot.library.path" : "/usr/lib/jvm/oracle-java8-jdk-amd64/jre/lib/amd64",
      "sun.cpu.endian" : "little",
      "sun.cpu.isalist" : "",
      "sun.io.unicode.encoding" : "UnicodeLittle",
      "sun.java.command" : "org.apache.spark.deploy.SparkSubmit --master yarn --deploy-mode client --conf spark.sql.sources.partitionOverwriteMode=dynamic --conf spark.executor.memory=10240m --conf spark.sql.catalog.hive_pluto=org.apache.iceberg.spark.SparkCatalog --conf spark.driver.memory=5120m --conf spark.sql.catalog.hive_pluto.uri=thrift://10.116.17.2:9083 --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.sql.catalog.hive_pluto.type=hive --conf spark.benchmarkId=20231130-184001-tpcds-1gb-iceberg --conf spark.executor.extraJavaOptions=-XX:MaxDirectMemorySize=8096m -Dio.netty.maxDirectMemory=8096m -XX:+UseG1GC -XX:ConcGCThreads=2 --conf spark.delta.logStore.gs.impl=io.delta.storage.GCSLogStore --class org.apache.spark.repl.Main --name Spark shell --queue de_adhoc --jars /home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-benchmarks.jar,/var/lib/fk-pf-spark3/jars/iceberg-hive-runtime-1.2.0.jar,/var/lib/fk-pf-spark3/jars/iceberg-spark-runtime-3.1_2.12-1.2.0.jar spark-shell -I 20231130-184001-tpcds-1gb-iceberg_shell_init.scala",
      "sun.java.launcher" : "SUN_STANDARD",
      "sun.jnu.encoding" : "ANSI_X3.4-1968",
      "sun.management.compiler" : "HotSpot 64-Bit Tiered Compilers",
      "sun.nio.ch.bugLevel" : "",
      "sun.os.patch.level" : "unknown",
      "user.country" : "US",
      "user.dir" : "/home/vanshika.yadav",
      "user.home" : "/home/vanshika.yadav",
      "user.language" : "en",
      "user.name" : "vanshika.yadav",
      "user.timezone" : "Asia/Kolkata"
    }
  }
}
Copying file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-report.json [Content-Type=application/json]...
/ [0 files][    0.0 B/ 83.8 KiB]                                                / [1 files][ 83.8 KiB/ 83.8 KiB]                                                
Operation completed over 1 objects/83.8 KiB.                                     
FILE UPLOAD: Uploaded /home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-report.json to gs://fksdp-mhora-zrwe-0f09-discoverycontentimpression/benchmarking/iceberg-benchmarking/reports/json/
Copying file:///home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-report.csv [Content-Type=text/csv]...
/ [0 files][    0.0 B/  3.4 KiB]                                                / [1 files][  3.4 KiB/  3.4 KiB]                                                
Operation completed over 1 objects/3.4 KiB.                                      
FILE UPLOAD: Uploaded /home/vanshika.yadav/20231130-184001-tpcds-1gb-iceberg-report.csv to gs://fksdp-mhora-zrwe-0f09-discoverycontentimpression/benchmarking/iceberg-benchmarking/reports/csv/
SUCCESS
